!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).axis3d=e()}}(function(){var define,module,exports;return function e(t,n,r){function o(a,u){if(!n[a]){if(!t[a]){var f="function"==typeof require&&require;if(!u&&f)return f(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var s=n[a]={exports:{}};t[a][0].call(s.exports,function(e){var n=t[a][1][e];return o(n||e)},s,s.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CameraContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),p=e("./inverse-view"),d=e("./info"),y=e("./view"),m=e("./eye");n.CameraContext=function(e){function t(e,n){return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new d.CameraInfoContext(e,n),new y.CameraViewContext(e,n),new p.CameraInverseViewContext(e,n),new m.CameraEyeContext(e,n)))}return i(t,s.Component),f(t,null,[{key:"defaults",value:function(){return u({},l)}}]),t}()},{"../../core":50,"../../utils":116,"../defaults":7,"./eye":2,"./info":4,"./inverse-view":5,"./view":6}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CameraEyeContext=void 0;var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../../utils"),l=e("../../scope"),p=e("../../core"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),y=r(e("eye-vector")),m=r(e("gl-mat4")).default.identity([]);n.CameraEyeContext=function(e){function t(e,n){return o(this,t),(0,s.assignDefaults)(n,t.defaults()),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.ScopedContext(e,{eye:function(e,t){var n=e.view;return(0,y.default)(n||m)}})))}return a(t,p.Component),c(t,null,[{key:"defaults",value:function(){return f({},d)}}]),t}()},{"../../core":50,"../../scope":90,"../../utils":116,"../defaults":7,"eye-vector":131,"gl-mat4":160}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./inverse-view");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./view");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./info");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})});var u=e("./eye");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}})})},{"./context":1,"./eye":2,"./info":4,"./inverse-view":5,"./view":6}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CameraInfoContext=void 0;var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../../utils"),l=e("../../scope"),p=e("../../core"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),y=r(e("gl-mat4")),m=r(e("gl-vec3")),h=y.default.identity([]);n.CameraInfoContext=function(e){function t(e,n){return o(this,t),(0,s.assignDefaults)(n,t.defaults()),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.ScopedContext(e,{transform:function(){return h},matrix:function(){return h},projection:function(e,t){return(0,s.get)("projection",[t,e,n])||h},aspect:function(e,t){return(0,s.get)("viewportWidth",[t,e])/(0,s.get)("viewportHeight",[t,e])},target:function(e,t){var r=(0,s.get)("scale",[e,t,n]),o=(0,s.get)("target",[t,e,n]);return m.default.multiply([],o,r)},up:function(e,t){return(0,s.get)("up",[t,e,n])},viewport:function(e,t){var r=(0,s.get)("viewport",[t,e,n]),o=(0,s.get)("viewportHeight",[t,e,n]),i=(0,s.get)("viewportWidth",[t,e,n]),a=(0,s.get)("viewportLeft",[t,e,n]),u=(0,s.get)("viewportTop",[t,e,n]);return r||[a||0,u||0,i||0,o||0]}})))}return a(t,p.Component),c(t,null,[{key:"defaults",value:function(){return f({},d)}}]),t}()},{"../../core":50,"../../scope":90,"../../utils":116,"../defaults":7,"gl-mat4":160,"gl-vec3":242}],5:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CameraInverseViewContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../scope"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),d=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-mat4")),y=d.default.identity([]);n.CameraInverseViewContext=function(e){function t(e,n){return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{invertedView:function(e){var t=e.view;return t?d.default.invert([],t):y}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../scope":90,"../../utils":116,"../defaults":7,"gl-mat4":160}],6:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CameraViewContext=void 0;var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../../utils"),l=e("../../scope"),p=e("../../core"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),y=r(e("gl-mat4")),m=r(e("gl-quat")),h=m.default.identity([]),b=y.default.identity([]),v=y.default.identity([]);n.CameraViewContext=function(e){function t(e,n){return o(this,t),(0,s.assignDefaults)(n,t.defaults()),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.ScopedContext(e,{view:function(e,t){var n=(0,s.get)("view",[e,t]);if(n)return n;var r=y.default.identity([]),o=(0,s.get)("position",[e,t]),i=(0,s.get)("rotation",[e,t]),a=(0,s.get)("target",[e,t]),u=(0,s.get)("scale",[e,t]),f=(0,s.get)("up",[e,t]);return o&&i&&a&&u?(m.default.normalize(h,i),y.default.fromQuat(b,h),y.default.translate(r,r,o),y.default.lookAt(r,a,o,f),y.default.multiply(r,r,b),y.default.scale(r,r,u),r):v}})))}return a(t,p.Component),c(t,null,[{key:"defaults",value:function(){return f({},d)}}]),t}()},{"../../core":50,"../../scope":90,"../../utils":116,"../defaults":7,"gl-mat4":160,"gl-quat":185}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.up=n.target=n.direction=n.uniformName=void 0;var r=e("../object3d/defaults");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});(function(e){e&&e.__esModule})(e("gl-mat4")),n.uniformName="camera",n.direction=[0,0,-1],n.target=[0,0,0],n.up=[0,1,0]},{"../object3d/defaults":86,"gl-mat4":160}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./orthographic");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./perspective");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./uniforms");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./context");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":3,"./orthographic":16,"./perspective":24,"./uniforms":26}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.lookAt=function(e,t,n,i){var a=[];if(r.default.subtract(a,t,n),r.default.normalize(a,a),a.every(Boolean)){var u=r.default.dot(a,i);Math.abs(u-1)<o?r.default.scale(i,e,-1):Math.abs(u+1)<o&&r.default.copy(i,e),r.default.copy(e,a),r.default.cross(a,e,i),r.default.normalize(a,a),r.default.cross(i,a,e),r.default.normalize(i,i)}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-vec3")),o=1e-9},{"gl-vec3":242}],10:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.OrthographicCameraContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./projection"),s=e("./info"),l=e("./view"),p=e("../../../utils"),d=e("../../../core"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),m=e("../../context");n.OrthographicCameraContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,p.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new m.CameraInfoContext(e,n),new s.OrthographicCameraInfoContext(e,n),new c.OrthographicCameraProjectionContext(e,n),new l.OrthographicCameraViewContext(e,n),new m.CameraInverseViewContext(e,n),new m.CameraEyeContext(e,n)))}return i(t,d.Component),f(t,null,[{key:"defaults",value:function(){return u({},y)}}]),t}()},{"../../../core":50,"../../../utils":116,"../../context":3,"../defaults":15,"./info":12,"./projection":13,"./view":14}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./projection");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./info");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./view");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":10,"./info":12,"./projection":13,"./view":14}],12:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.OrthographicCameraInfoContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../perspective"),s=e("../../../utils"),l=(e("../../../scope"),e("../../../core")),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.OrthographicCameraInfoContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,s.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new c.PerspectiveCameraInfoContext(e,n)))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../../perspective":24,"../defaults":15}],13:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.OrthographicCameraProjectionContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../../utils"),s=e("../../../scope"),l=e("../../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),d=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-mat4"));n.OrthographicCameraProjectionContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{projection:function(){var t=d.default.identity(scratchMatrix),r=(0,c.get)("viewport",[args,e,n]),o=(0,c.get)("near",[args,e,n]),i=(0,c.get)("far",[args,e,n]),a=r[0],u=r[1],f=r[2],s=r[3];return d.default.ortho(t,a,f,u,s,o,i),t}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../defaults":15,"gl-mat4":160}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.OrthographicCameraViewContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../perspective"),s=e("../../../utils"),l=(e("../../../scope"),e("../../../core")),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.OrthographicCameraViewContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,s.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new c.PerspectiveCameraViewContext(e,n)))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../../perspective":24,"../defaults":15}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../defaults");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});n.near=100,n.far=1},{"../defaults":7}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./orthographic");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},{"./context":11,"./orthographic":17}],17:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.OrthographicCamera=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./context"),s=e("../../utils"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),d=e("../../object3d");n.OrthographicCamera=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,s.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new d.Object3D(e,n),new c.OrthographicCameraContext(e,n)))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../object3d":87,"../../utils":116,"./context":11,"./defaults":15}],18:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCameraContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./projection"),s=e("./info"),l=e("./view"),p=e("../../../utils"),d=e("../../../core"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),m=e("../../context");n.PerspectiveCameraContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,p.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new m.CameraInfoContext(e,n),new s.PerspectiveCameraInfoContext(e,n),new l.PerspectiveCameraViewContext(e,n),new c.PerspectiveCameraProjectionContext(e,n),new m.CameraInverseViewContext(e,n),new m.CameraEyeContext(e,n)))}return i(t,d.Component),f(t,null,[{key:"defaults",value:function(){return u({},y)}}]),t}()},{"../../../core":50,"../../../utils":116,"../../context":3,"../defaults":23,"./info":20,"./projection":21,"./view":22}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./projection");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./view");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./info");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":18,"./info":20,"./projection":21,"./view":22}],20:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCameraInfoContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../../utils"),s=e("../../../scope"),l=e("../../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.PerspectiveCameraInfoContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{direction:function(e,t){return(0,c.get)("direction",[t,e])},near:function(e,t){return(0,c.get)("near",[t,e])},far:function(e,t){return(0,c.get)("far",[t,e])},fov:function(e,t){return(0,c.get)("fov",[t,e])},up:function(e,t){return(0,c.get)("up",[t,e])}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../defaults":23}],21:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCameraProjectionContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../../utils"),s=e("../../../scope"),l=e("../../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),d=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-mat4"));n.PerspectiveCameraProjectionContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{projection:function(e,t){var n=d.default.identity([]);if("projection"in t&&t.projection)d.default.copy(n,t.projection);else{var r=(0,c.get)("aspect",[t,e]),o=(0,c.get)("near",[t,e]),i=(0,c.get)("far",[t,e]),a=(0,c.get)("fov",[t,e]);d.default.perspective(n,a,r,o,i)}return n}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../defaults":23,"gl-mat4":160}],22:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCameraViewContext=void 0;var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../../../utils"),l=e("../../../scope"),p=e("../../../core"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),y=e("../../look-at"),m=r(e("gl-mat4")),h=r(e("gl-vec3")),b=r(e("gl-quat")),v=b.default.identity([]),g=m.default.identity([]),_=m.default.identity([]);n.PerspectiveCameraViewContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,t),(0,s.assignDefaults)(n,t.defaults()),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.ScopedContext(e,{view:function(e,t){var n=(0,s.get)("view",[e,t]);if(n)return n;var r=m.default.identity([]),o=[0,0,0],i=(0,s.get)("direction",[e,t]),a=(0,s.get)("position",[e,t]),u=(0,s.get)("rotation",[e,t]),f=(0,s.get)("target",[e,t]),c=(0,s.get)("scale",[e,t]),l=(0,s.get)("up",[e,t]);return a&&u&&f&&c?((0,y.lookAt)(i,f,a,l),h.default.add(o,a,i),b.default.normalize(v,u),m.default.fromQuat(g,v),m.default.lookAt(r,a,o,l),m.default.multiply(r,r,g),m.default.scale(r,r,c),r):_}})))}return a(t,p.Component),c(t,null,[{key:"defaults",value:function(){return f({},d)}}]),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../../look-at":9,"../defaults":23,"gl-mat4":160,"gl-quat":185,"gl-vec3":242}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../defaults");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});n.near=.01,n.far=1e3,n.fov=60*Math.PI/180},{"../defaults":7}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./perspective");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},{"./context":19,"./perspective":25}],25:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCamera=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./context"),s=e("../../utils"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),p=e("../../core"),d=e("../../object3d");n.PerspectiveCamera=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,s.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new d.Object3D(e,n),new c.PerspectiveCameraContext(e,n)))}return i(t,p.Component),f(t,null,[{key:"defaults",value:function(){return u({},l)}}]),t}()},{"../../core":50,"../../object3d":87,"../../utils":116,"./context":19,"./defaults":23}],26:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CameraShaderUniforms=void 0;var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../utils"),l=e("../shader"),p=e("../core"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.CameraShaderUniforms=function(e){function t(e,n){o(this,t),(0,s.assignDefaults)(n,t.defaults());var a=n.uniformName;return i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.ShaderUniforms(e,{prefix:a+"."},{invertedView:function(e){return e.invertedView},projection:function(e){return e.projection},aspect:function(e){return e.aspect},view:function(e){return e.view},eye:function(e){return[].concat(r(e.eye))}})))}return a(t,p.Component),c(t,null,[{key:"defaults",value:function(){return f({},d)}}]),t}()},{"../core":50,"../shader":93,"../utils":116,"./defaults":7}],27:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Compute=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=e("./core");n.Compute=function(e){function t(e,n,i){var a;r(this,t);for(var f=arguments.length,c=Array(f>3?f-3:0),s=3;s<f;s++)c[s-3]=arguments[s];"function"==typeof i&&c.unshift(i),"function"==typeof n&&c.unshift(n),"object"!=(void 0===n?"undefined":u(n))&&(n={}),"object"!=(void 0===i?"undefined":u(i))&&(i=n);var l=e.regl({});return o(this,(a=t.__proto__||Object.getPrototypeOf(t)).call.apply(a,[this,e,function(e,t){l(n.compute),l(t)}].concat(c)))}return i(t,f.Component),t}()},{"./core":50}],28:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=0;n.Command=function(e){function t(e){var n;if(r(this,t),"function"!=typeof e)throw new TypeError("Command constructor expects a function.");var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,t.codegen(function(e){return e.apply(e,Array.prototype.slice.call(arguments,1))}))),a=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return i.apply(void 0,[e].concat(n))};return i.constructor=a.constructor=t,f++,n=Object.assign(a,{this:i}),o(i,n)}return i(t,Function),u(t,null,[{key:"count",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return count})},{key:"codegen",value:function(e){if("function"!=typeof e)throw new TypeError("Expecting a function");return"return ("+String(e)+").apply(this, arguments);"}}]),t}()},{}],29:[function(e,t,n){"use strict";function r(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Component=void 0;var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c="function"==typeof Symbol&&"symbol"==u(Symbol.iterator)?function(e){return void 0===e?"undefined":u(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":u(e)},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e("./command"),p=e("./entity"),d=0;n.Component=function(e){function t(e){for(var n=arguments.length,a=Array(n>2?n-2:0),u=2;u<n;u++)a[u-2]=arguments[u];var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),"function"==typeof s?(a.unshift(s),s={}):Array.isArray(s)&&(a=s,s={}),a=t.compose(a);var l=new p.Entity(e,s);return i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e,t){"function"==typeof e&&(t=e,e={}),e="object"==(void 0===e?"undefined":c(e))&&e?e:{},t="function"==typeof t?t:function(){},e=Array.isArray(e)?e.map(function(e){return f({},s,e)}):f({},s,e),l(e,function(e,n){r(e),a(n,t)})}))}return a(t,l.Command),s(t,null,[{key:"id",value:function(){return++d}},{key:"defaults",value:function(){return{}}},{key:"compose",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.isArray(t[0])&&(t=t[0]),t=Array.isArray(t)?t:[],function(e,n){function r(t){var o=t.shift();"function"==typeof o?t.length?o(e,function(){return r(t)}):n!=o&&o(e,n):r(t)}if("function"==typeof e&&(n=e,e={}),e="object"==(void 0===e?"undefined":c(e))&&e?e:{},n="function"==typeof n?n:function(){},0==t.length)return n(e);r(t.slice())}}}]),t}()},{"./command":28,"./entity":32}],30:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":f(t))&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":f(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Context=void 0;var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s="function"==typeof Symbol&&"symbol"==f(Symbol.iterator)?function(e){return void 0===e?"undefined":f(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":f(e)},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=e("events"),d=r(e("defined")),y=r(e("global/document")),m=r(e("global/window")),h=r(e("dom-events")),b=r(e("regl"));n.Context=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.default;i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(r.setMaxListeners(1/0),r._store=new Map,r._hasFocus=!1,r._reglContext=null,e.regl=(0,d.default)(e.regl,e.gl||{}),e.canvas&&"object"==s(e.canvas)?e.regl.canvas=e.canvas:e.element&&"CANVAS"==e.element.nodeName?e.regl.canvas=e.element:e.element&&e.element.nodeName?e.regl.container=e.element:"string"==typeof e.element&&(e.regl.container=e.element),n(c({},e.regl,{attributes:c({},e.regl.attributes||{}),extensions:["OES_texture_float"].concat(o(e.regl.extensions||[])),optionalExtensions:["ANGLE_instanced_arrays"].concat(o(e.regl.optionalExtensions||[])),onDone:function(e,t){if(e)return r.emit("error",e);r._regl=t,r._isDestroyed=!1,t._gl&&t._gl.canvas?r._domElement=r._regl._gl.canvas:r._domElement=null}})),null!=r._domElement&&"undefind"!=typeof m.default&&"undefind"!=typeof y.default){var u=function(e,t,n){h.default.on(e,t,n),r.once("beforedestroy",function(){return h.default.off(e,t,n)})},f=function(e){e.target==r._domElement?r.focus():r.blur()};u(r._domElement,"blur",function(){r.blur()}),u(r._domElement,"focus",function(){r.focus()}),u(m.default,"blur",function(){r.blur()}),u(y.default,"mousedown",f),u(y.default,"touchstart",f)}return r}return u(t,p.EventEmitter),l(t,[{key:"focus",value:function(){return this._hasFocus=!0,this.emit("focus"),this}},{key:"blur",value:function(){return this._hasFocus=!1,this.emit("blur"),this}},{key:"destroy",value:function(){return this.emit("beforedestroy"),this._regl&&"function"==typeof this._regl.destroy&&this._regl.destroy(),this._domElement&&this._domElement.parentElement&&this._domElement.parentElement.removeChild(this._domElement),delete this._regl,delete this._store,delete this._domElement,delete this._reglContext,this._hasFocus=!1,this.emit("destroy"),this}},{key:"refresh",value:function(){return this._regl&&"function"==typeof this._regl._refresh&&this._regl.refresh(),this}},{key:"get",value:function(e){return this._store?this._store.get(e):null}},{key:"set",value:function(e,t){return this._store?(this._store.set(e,t),t):null}},{key:"reglContext",get:function(){return this._reglContext||null}},{key:"domElement",get:function(){return this._domElement||null}},{key:"hasFocus",get:function(){return Boolean(this._hasFocus)}},{key:"regl",get:function(){return this._regl||null}},{key:"gl",get:function(){return this._regl._gl||null}}]),t}()},{defined:128,"dom-events":129,events:130,"global/document":275,"global/window":276,regl:297}],31:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.DynamicValueCounter=n.DynamicValue=void 0;var a="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":i(e)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=function(e){return e&&e.__esModule?e:{default:e}}(e("defined")),c=(n.DynamicValue=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o(this,e);var u=function(e,t,r){return Object.defineProperty(n,e,{enumerable:!1,get:function(){return t||r}})};u("ctx",t,{}),u("initialState",r,{}),"object"==(void 0===i?"undefined":a(i))&&this.set(i)}return u(e,null,[{key:"createCounter",value:function(){return new c}},{key:"pluck",value:function(t,n,r){var o=void 0;t&&null!=t[n]&&(o=null!=r?t[n][r]:t[n]);for(var i=arguments.length,a=Array(i>3?i-3:0),u=3;u<i;u++)a[u-3]=arguments[u];return e.primitive(f.default.apply(void 0,[o].concat(a)))}},{key:"primitive",value:function(e){var t=e;if(null==e&&(t=void 0),"object"==(void 0===e?"undefined":a(e))){var n="number"==typeof e.length,o="function"==typeof e[Symbol.iterator];t=n?o?[].concat(r(e)):Array(e.length).fill(0).map(function(t,n){return e[n]}):Object.assign({},e)}return t}}]),u(e,[{key:"set",value:function(t,n){var r=this.initialState.prefix,o=void 0===r?"":r;if(t&&"object"==(void 0===t?"undefined":a(t))){var i=Object.getOwnPropertyDescriptors(t);for(var u in i)try{Object.defineProperty(this,""+o+u,i[u])}catch(e){}}else"string"==typeof t&&null!=n&&(this[""+o+t]=e.primitive(n));return this.purge(),this}},{key:"unset",value:function(e){var t=this.initialState.prefix,n=void 0===t?"":t;return"string"==typeof e&&delete this[""+n+e],this}},{key:"purge",value:function(){for(var e in this)null==this[e]&&delete this[e];return this}}]),e}(),n.DynamicValueCounter=function(){function e(){o(this,e),Object.defineProperties(this,{contexts:{enumerable:!1,value:new Set},map:{enumerable:!1,value:new WeakMap}})}return u(e,[{key:"setContext",value:function(e){var t=this.map.get(e)||new Set;return this.map.set(e,t),0==this.contexts.has(e)&&this.contexts.add(e),this}},{key:"getSetForContext",value:function(e){return this.setContext(e),this.map.get(e)}},{key:"addValueForContext",value:function(e,t){var n=this.getSetForContext(e);return 0==n.has(t)&&n.add(t),this}},{key:"sumSetForContext",value:function(e){return this.getSetForContext(e).size()}},{key:"listSetForContext",value:function(e){return[].concat(r(this.getSetForContext(e)))}},{key:"list",value:function(){return[].concat(r(this.contexts))}}]),e}())},{defined:128}],32:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Entity=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./command"),s=0;n.Entity=function(e){function t(e){r(this,t);var n=t.id(),i=e.regl({context:{entityID:function(){return n}}});return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,function(e,t){"function"==typeof e&&(t=e,e={}),e="object"==(void 0===e?"undefined":u(e))&&e?e:{},i(e,t="function"==typeof t?t:function(){})}))}return i(t,c.Command),f(t,null,[{key:"id",value:function(){return++s}}]),t}()},{"./command":28}],33:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.Geometry=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(e("bound-points")),u=r(e("defined")),f=r(e("mesh-reindex")),c=r(e("unindex-mesh")),s=r(e("normals"));n.Geometry=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var n={},r=(0,u.default)(t.flatten,!1);n=t.positions?t:t.complex,Object.defineProperty(this,"_complex",{enumerable:!1,value:{}}),this.flatten=Boolean(r),this.complex=n||null}return i(e,[{key:"computeBoundingBox",value:function(){return(0,a.default)(this.positions)}},{key:"complex",set:function(t){if(t instanceof e&&(t=t.complex),t){if(this.flatten&&t.cells){var n=t.cells.map(function(e){return e.slice()}),r=(0,f.default)((0,c.default)(t.positions,n));try{t.normals=s.default.vertexNormals(r.cells,r.positions)}catch(e){console.warn("Unable to compute vertex normals.")}Object.assign(t,r)}if(null==t.normals&&t.positions&&t.cells)try{t.normals=s.default.vertexNormals(t.cells,t.positions)}catch(e){console.warn("Unable to compute vertex normals.")}}return Object.assign(this._complex,t),t},get:function(){return this._complex||null}},{key:"positions",get:function(){return this.complex?this.complex.positions:null}},{key:"normals",get:function(){return this.complex?this.complex.normals:null}},{key:"uvs",get:function(){return this.complex?this.complex.uvs:null}},{key:"cells",get:function(){return this.complex?this.complex.cells:null}}]),e}()},{"bound-points":120,defined:128,"mesh-reindex":290,normals:292,"unindex-mesh":301}],34:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.WebGLShaderInstancedAttributes=n.WebGLShaderAttributes=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../dynamic"),s=c.DynamicValue.createCounter(),l=n.WebGLShaderAttributes=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2];r(this,t),null==i?(i=n,n={}):null==n&&null==i&&(n={},i={});var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));return s.addValueForContext(e,a),a}return i(t,c.DynamicValue),f(t,null,[{key:"counter",value:function(){return s}},{key:"getTotalUniformCount",value:function(){return t.counter().list().map(function(e){return t.getContextUniformCount(e)}).reduce(function(e,t){return e+t},0)}},{key:"getContextUniformCount",value:function(e){var n=t.counter().listSetForContext(e).reduce(function(e,t){return Object.assign(e,t)},{});return Object.keys(n).length}}]),t}();n.WebGLShaderInstancedAttributes=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2];r(this,t),null==i&&"object"==(void 0===n?"undefined":u(n))?(i=n,n={}):null==n&&null==i&&(n={},i={});for(var a in i)i[a]&&"object"==u(i[a])&&("object"==u(i[a].buffer)?"number"!=typeof i[a].divisor&&(i[a].divisor=1):i[a]={buffer:i[a],divisor:1});return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i))}return i(t,l),t}()},{"../dynamic":31}],35:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./attributes");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./uniforms");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},{"./attributes":34,"./uniforms":36}],36:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.WebGLShaderUniforms=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../dynamic"),s=c.DynamicValue.createCounter();n.WebGLShaderUniforms=function(e){function t(e,n,i){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u({},n),u({},i)));return s.addValueForContext(e,a),a}return i(t,c.DynamicValue),f(t,null,[{key:"counter",value:function(){return s}},{key:"getTotalUniformCount",value:function(){return t.counter().list().map(function(e){return t.getContextUniformCount(e)}).reduce(function(e,t){return e+t},0)}},{key:"getContextUniformCount",value:function(e){var n=t.counter().listSetForContext(e).reduce(function(e,t){return Object.assign(e,t)},{});return Object.keys(n).length}}]),t}()},{"../dynamic":31}],37:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(o={},r(o,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_CAMERA_VARIABLES\n#define GLSL_CAMERA_VARIABLES\n\n#ifndef GLSL_CAMERA_UNIFORM_VARIABLE\n#define GLSL_CAMERA_UNIFORM_VARIABLE camera\n#endif\n\n#endif\n"),r(o,t+"/uniforms",'#define GLSLIFY 1\n#ifndef GLSL_CAMERA_UNIFORMS\n#define GLSL_CAMERA_UNIFORMS\n\n#include "./variables"\n\n#ifdef GLSL_CAMERA\nuniform Camera GLSL_CAMERA_UNIFORM_VARIABLE;\n#endif\n\n#endif\n'),r(o,t+"/camera","#define GLSLIFY 1\n#ifndef GLSL_CAMERA\n#define GLSL_CAMERA\n\nstruct Camera {\n  mat4 projection;\n  mat4 view;\n  vec3 eye;\n};\n\n#endif\n"),o))}).call(this,"/lib/core/glsl/camera")},{glslify:288}],38:[function(e,t,n){(function(t){"use strict";!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t+"/common","#define GLSLIFY 1\n#ifndef GLSL_COMMON\n#define GLSL_COMMON 1\n\n#ifndef M_PI\n#define M_PI 3.141592653589793\n#endif\n\n#ifndef M_E\n#define M_E 2.718281828459045\n#endif\n\n#endif\n"))}).call(this,"/lib/core/glsl/common")},{glslify:288}],39:[function(e,t,n){(function(t){"use strict";!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t+"/main",'#define GLSLIFY 1\n#ifndef GLSL_FRAGMENT_MAIN\n#define GLSL_FRAGMENT_MAIN\n\n#include "../varying/data"\n#include "../varying/read"\n\nvoid InitVarying(inout VaryingData varyingData);\nvoid BeforeMain(inout vec4 fragColor, inout VaryingData varyingData);\nvoid Main(inout vec4 fragColor, inout VaryingData data);\nvoid TransformMain(inout vec4 fragColor, inout VaryingData varyingData);\nvoid AfterMain(inout vec4 fragColor, inout VaryingData varyingData);\n\nvoid main() {\n  VaryingData varyingData = ReadVaryingData();\n  InitVarying(varyingData);\n  BeforeMain(gl_FragColor, varyingData);\n  Main(gl_FragColor, varyingData);\n  TransformMain(gl_FragColor, varyingData);\n  AfterMain(gl_FragColor, varyingData);\n}\n\n#ifdef GLSL_FRAGMENT_MAIN_BEFORE\n  void GLSL_FRAGMENT_MAIN_BEFORE(inout vec4 fragColor,\n                                 inout VaryingData varyingData);\n#endif\n\n#ifdef GLSL_FRAGMENT_MAIN_TRANSFORM\n  void GLSL_FRAGMENT_MAIN_TRANSFORM(inout vec4 fragColor,\n                                    inout VaryingData varyingData);\n#endif\n\n#ifdef GLSL_FRAGMENT_MAIN_AFTER\n  void GLSL_FRAGMENT_MAIN_AFTER(inout vec4 fragColor,\n                                inout VaryingData varyingData);\n#endif\n\nvoid BeforeMain(inout vec4 fragColor,\n                inout VaryingData varyingData) {\n#ifdef GLSL_FRAGMENT_MAIN_BEFORE\n  GLSL_FRAGMENT_MAIN_BEFORE(fragColor, varyingData);\n#endif\n}\n\nvoid TransformMain(inout vec4 fragColor,\n                   inout VaryingData varyingData) {\n#ifdef GLSL_FRAGMENT_MAIN_TRANSFORM\n  GLSL_FRAGMENT_MAIN_TRANSFORM(fragColor, varyingData);\n#endif\n}\n\nvoid AfterMain(inout vec4 fragColor,\n               inout VaryingData varyingData) {\n#ifdef GLSL_FRAGMENT_MAIN_AFTER\n  GLSL_FRAGMENT_MAIN_AFTER(fragColor, varyingData);\n#endif\n}\n\nvoid InitVarying(inout VaryingData varyingData) {\n  varyingData = ReadVaryingData();\n}\n\n#endif\n'))}).call(this,"/lib/core/glsl/fragment")},{glslify:288}],40:[function(e,t,n){(function(t){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.time=n.mesh=n.common=n.camera=n.vertex=n.varying=n.texture=n.fragment=n.material=void 0;var o=r(e("./material")),i=r(e("./fragment")),a=r(e("./texture")),u=r(e("./varying")),f=r(e("./vertex")),c=r(e("./camera")),s=r(e("./common")),l=r(e("./mesh")),p=r(e("./time"));n.material=o,n.fragment=i,n.texture=a,n.varying=u,n.vertex=f,n.camera=c,n.common=s,n.mesh=l,n.time=p;for(var d in n)for(var y in n[d]){var m=y.replace(t+"/"+d,"");n[d][m]=n[d][y],delete n[d][y]}}).call(this,"/lib/core/glsl")},{"./camera":37,"./common":38,"./fragment":39,"./material":41,"./mesh":42,"./texture":43,"./time":44,"./varying":46,"./vertex":49}],41:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(o={},r(o,t+"/fragment/main",'#define GLSLIFY 1\n#ifndef GLSL_MATERIAL_FRAGMENT_MAIN\n#define GLSL_MATERIAL_FRAGMENT_MAIN\n\n#include "../material"\n#include "../uniforms"\n#include "../variables"\n\n#include "../../mesh/fragment"\n#include "../../fragment/main"\n#include "../../varying/read"\n\nvoid Main(inout vec4 fragColor, inout VaryingData data) {\n  fragColor = MeshFragment(\n      GLSL_MATERIAL_UNIFORM_VARIABLE.color,\n      GLSL_MATERIAL_UNIFORM_VARIABLE.opacity);\n}\n\n#endif\n'),r(o,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_MATERIAL_VARIABLES\n#define GLSL_MATERIAL_VARIABLES\n\n#ifndef GLSL_MATERIAL_UNIFORM_VARIABLE\n#define GLSL_MATERIAL_UNIFORM_VARIABLE material\n#endif\n\n#endif\n"),r(o,t+"/material","#define GLSLIFY 1\n#ifndef GLSL_MATERIAL\n#define GLSL_MATERIAL\n\nstruct Material {\n  vec3 color;\n  float opacity;\n};\n\n#endif\n"),r(o,t+"/uniforms",'#define GLSLIFY 1\n#ifndef GLSL_MATERIAL_UNIFORMS\n#define GLSL_MATERIAL_UNIFORMS\n\n#include "./variables"\n#include "./material"\n\nuniform Material GLSL_MATERIAL_UNIFORM_VARIABLE;\n\n#endif\n'),o))}).call(this,"/lib/core/glsl/material")},{glslify:288}],42:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(o={},r(o,t+"/vertex/main",'#define GLSLIFY 1\n#ifndef GLSL_MESH_VERTEX_MAIN\n#define GLSL_MESH_VERTEX_MAIN\n\n#include "../variables"\n#include "../uniforms"\n#include "../vertex"\n#include "../mesh"\n\n#include "../../camera/camera"\n#include "../../camera/uniforms"\n\n#ifdef GLSL_MESH_HAS_POSITION\n#include "../../vertex/attributes/position"\n#include "../../varying/position"\n#endif\n\n#ifdef GLSL_MESH_HAS_NORMAL\n#include "../../vertex/attributes/normal"\n#include "../../varying/normal"\n#endif\n\n#ifdef GLSL_MESH_HAS_UV\n#include "../../vertex/attributes/uv"\n#include "../../varying/uv"\n#endif\n\n#include "../../varying/emit"\n#include "../../vertex/main"\n\nvoid Main(inout vec4 vertexPosition, inout VaryingData data) {\n  vertexPosition = MeshVertex(\n      GLSL_CAMERA_UNIFORM_VARIABLE.projection,\n      GLSL_CAMERA_UNIFORM_VARIABLE.view,\n      GLSL_MESH_UNIFORM_VARIABLE.model,\n      GLSL_VERTEX_ATTRIBUTES_POSITION_VARIABLE);\n}\n\n#endif\n'),r(o,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_MESH_VARIABLES\n#define GLSL_MESH_VARIABLES\n\n#ifndef GLSL_MESH_UNIFORM_VARIABLE\n#define GLSL_MESH_UNIFORM_VARIABLE mesh\n#endif\n\n#endif\n"),r(o,t+"/uniforms",'#define GLSLIFY 1\n#ifndef GLSL_MESH_UNIFORMS\n#define GLSL_MESH_UNIFORMS\n\n#include "./variables"\n#include "./mesh"\n\nuniform Mesh GLSL_MESH_UNIFORM_VARIABLE;\n\n#endif\n'),r(o,t+"/fragment","#define GLSLIFY 1\n#ifndef GLSL_MESH_FRAGMENT\n#define GLSL_MESH_FRAGMENT\n\n#ifndef GLSL_MESH_FRAGMENT_DEFAULT_COLOR\n#define GLSL_MESH_FRAGMENT_DEFAULT_COLOR vec4(0.25882352941176473, 0.5254901960784314, 0.9568627450980393, 1.0)\n#endif\n\nvec4 MeshFragment(void) {\n  return vec4(GLSL_MESH_FRAGMENT_DEFAULT_COLOR);\n}\n\nvec4 MeshFragment(vec4 color) {\n  return color;\n}\n\nvec4 MeshFragment(float r, float g, float b, float a) {\n  return MeshFragment(vec4(r, g, b, a));\n}\n\nvec4 MeshFragment(float r, float g, float b) {\n  return MeshFragment(r, g, b, 1.0);\n}\n\nvec4 MeshFragment(float c) {\n  return MeshFragment(c, c, c, 1.0);\n}\n\nvec4 MeshFragment(vec3 color, float opacity) {\n  return MeshFragment(vec4(color, opacity));\n}\n\nvec4 MeshFragment(vec3 color) {\n  return MeshFragment(color, 1.0);\n}\n\n#endif\n"),r(o,t+"/vertex","#define GLSLIFY 1\n#ifndef GLSL_MESH_VERTEX\n#define GLSL_MESH_VERTEX\n\n#ifndef GLSL_MESH_VERTEX_DEFAULT_POSITION\n#define GLSL_MESH_VERTEX_DEFAULT_POSITION vec4(0.0, 0.0, 0.0, 1.0)\n#endif\n\nvec4 MeshVertex(void) {\n  return vec4(GLSL_MESH_VERTEX_DEFAULT_POSITION);\n}\n\nvec4 MeshVertex(vec4 position) {\n  return position;\n}\n\nvec4 MeshVertex(mat4 transform, vec4 position) {\n  return MeshVertex(transform * position);\n}\n\nvec4 MeshVertex(mat4 transform, vec3 position) {\n  return MeshVertex(transform, vec4(position, 1.0));\n}\n\nvec4 MeshVertex(mat4 transform, mat4 model, vec4 position) {\n  return MeshVertex(transform * model * position);\n}\n\nvec4 MeshVertex(mat4 transform, mat4 model, vec3 position) {\n  return MeshVertex(transform, model, vec4(position, 1.0));\n}\n\nvec4 MeshVertex(mat4 projection, mat4 view, mat4 model, vec4 position) {\n  return MeshVertex(projection * view * model, position);\n}\n\nvec4 MeshVertex(mat4 projection, mat4 view, mat4 model, vec3 position) {\n  return MeshVertex(projection, view, model, vec4(position, 1.0));\n}\n\n#endif\n"),r(o,t+"/mesh","#define GLSLIFY 1\n#ifndef GLSL_MESH\n#define GLSL_MESH\n\nstruct Mesh {\n  vec4 rotation;\n  vec3 scale;\n  vec3 position;\n  mat4 model;\n  mat3 modelNormal;\n};\n\n#endif\n"),o))}).call(this,"/lib/core/glsl/mesh")},{glslify:288}],43:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(o={},r(o,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_TEXTURE_VARIABLES\n#define GLSL_TEXTURE_VARIABLES\n\n#ifndef GLSL_TEXTURE_2D_VARIABLE\n#define GLSL_TEXTURE_2D_VARIABLE tex2d\n#endif\n\n#ifndef GLSL_TEXTURE_CUBE_VARIABLE\n#define GLSL_TEXTURE_CUBE_VARIABLE texCube\n#endif\n\n#endif\n"),r(o,t+"/uniforms",'#define GLSLIFY 1\n#ifndef GLSL_TEXTURE_UNIFORMS\n#define GLSL_TEXTURE_UNIFORMS\n\n#include "./variables"\n\n#ifdef GLSL_TEXTURE_2D\nuniform Texture2D GLSL_TEXTURE_2D_VARIABLE;\n#endif\n\n#ifdef GLSL_TEXTURE_CUBE\nuniform TextureCube GLSL_TEXTURE_CUBE_VARIABLE;\n#endif\n\n#endif\n'),r(o,t+"/cube","#define GLSLIFY 1\n#ifndef GLSL_TEXTURE_CUBE\n#define GLSL_TEXTURE_CUBE\n\nstruct TextureCube {\n  vec2 resolution;\n  samplerCube data;\n};\n\n#endif\n"),r(o,t+"/2d","#define GLSLIFY 1\n#ifndef GLSL_TEXTURE_2D\n#define GLSL_TEXTURE_2D\n\nstruct Texture2D {\n  vec2 resolution;\n  sampler2D data;\n};\n\n#endif\n"),o))}).call(this,"/lib/core/glsl/texture")},{glslify:288}],44:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(o={},r(o,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_TIME_VARIABLES\n#define GLSL_TIME_VARIABLES\n\n#ifndef GLSL_TIME_UNIFORM_VARIABLE\n#define GLSL_TIME_UNIFORM_VARIABLE time\n#endif\n\n#endif\n"),r(o,t+"/time",'#define GLSLIFY 1\n#ifndef GLSL_TIME\n#define GLSL_TIME\n\n#include "./variables"\n\nuniform float GLSL_TIME_UNIFORM_VARIABLE;\n\nfloat GetTime() {\n  return GLSL_TIME_UNIFORM_VARIABLE;\n}\n\n#endif\n'),o))}).call(this,"/lib/core/glsl/time")},{glslify:288}],45:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(o={},r(o,t+"/position",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_EMIT_POSITION\n#define GLSL_VARYING_EMIT_POSITION\n#ifdef GLSL_VARYING_POSITION\n\n#include "../variables"\n\nvoid EmitVaryingLocalPosition(vec3 position) {\n  GLSL_VARYING_LOCAL_POSITION_VARIABLE = position;\n}\n\nvoid EmitVaryingPosition(mat4 model, vec3 position) {\n  vec4 worldPosition = model * vec4(position, 1.0);\n  GLSL_VARYING_POSITION_VARIABLE = worldPosition.xyz;\n}\n\nvoid EmitVaryingPositions(mat4 model, vec3 position) {\n  EmitVaryingPosition(model, position);\n  EmitVaryingLocalPosition(position);\n}\n\n#endif\n#endif\n'),r(o,t+"/normal",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_EMIT_NORMAL\n#define GLSL_VARYING_EMIT_NORMAL\n#ifdef GLSL_VARYING_NORMAL\n\n#include "../variables"\n\nvoid EmitVaryingLocalNormal(vec3 normal) {\n  GLSL_VARYING_LOCAL_NORMAL_VARIABLE = normalize(normal);\n}\n\nvoid EmitVaryingNormal(mat3 modelNormal, vec3 normal) {\n  GLSL_VARYING_NORMAL_VARIABLE = normalize(modelNormal * normal);\n}\n\nvoid EmitVaryingNormals(mat3 modelNormal, vec3 normal) {\n  EmitVaryingNormal(modelNormal, normal);\n  EmitVaryingLocalNormal(normal);\n}\n\n#endif\n#endif\n'),r(o,t+"/color",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_EMIT_COLOR\n#define GLSL_VARYING_EMIT_COLOR\n#ifdef GLSL_VARYING_COLOR\n\n#include "../variables"\n\nvoid EmitVaryingColor(vec4 color) {\n  GLSL_VARYING_COLOR_VARIABLE = color;\n}\n\nvoid EmitVaryingColor(vec3 color) {\n  EmitVaryingColor(vec4(color, 1.0));\n}\n\nvoid EmitVaryingColors(vec4 color) {\n  EmitVaryingColor(color);\n}\n\nvoid EmitVaryingColors(vec3 color) {\n  EmitVaryingColors(vec4(color, 1.0));\n}\n\n#endif\n#endif\n'),r(o,t+"/uv",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_EMIT_UV\n#define GLSL_VARYING_EMIT_UV\n#ifdef GLSL_VARYING_UV\n\n#include "../variables"\n\nvoid EmitVaryingUv(vec2 uv) {\n  GLSL_VARYING_UV_VARIABLE = uv;\n}\n\nvoid EmitVaryingUvs(vec2 uv) {\n  EmitVaryingUv(uv);\n}\n\n#endif\n#endif\n'),o))}).call(this,"/lib/core/glsl/varying/emit")},{glslify:288}],46:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,i({},e("./emit"),e("./read"),(o={},r(o,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_VARYING_VARIABLES\n#define GLSL_VARYING_VARIABLES\n\n#ifndef GLSL_VARYING_COLOR_VARIABLE\n#define GLSL_VARYING_COLOR_VARIABLE vColor\n#endif\n\n#ifndef GLSL_VARYING_POSITION_VARIABLE\n#define GLSL_VARYING_POSITION_VARIABLE vPosition\n#endif\n\n#ifndef GLSL_VARYING_LOCAL_POSITION_VARIABLE\n#define GLSL_VARYING_LOCAL_POSITION_VARIABLE vLocalPosition\n#endif\n\n#ifndef GLSL_VARYING_NORMAL_VARIABLE\n#define GLSL_VARYING_NORMAL_VARIABLE vNormal\n#endif\n\n#ifndef GLSL_VARYING_LOCAL_NORMAL_VARIABLE\n#define GLSL_VARYING_LOCAL_NORMAL_VARIABLE vLocalNormal\n#endif\n\n#ifndef GLSL_VARYING_UV_VARIABLE\n#define GLSL_VARYING_UV_VARIABLE vUv\n#endif\n\n#endif\n"),r(o,t+"/position",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_POSITION\n#define GLSL_VARYING_POSITION\n\n#include "./variables"\n\nvarying vec3 GLSL_VARYING_LOCAL_POSITION_VARIABLE;\nvarying vec3 GLSL_VARYING_POSITION_VARIABLE;\n\n#endif\n'),r(o,t+"/normal",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_NORMAL\n#define GLSL_VARYING_NORMAL\n\n#include "./variables"\n\nvarying vec3 GLSL_VARYING_LOCAL_NORMAL_VARIABLE;\nvarying vec3 GLSL_VARYING_NORMAL_VARIABLE;\n\n#endif\n'),r(o,t+"/color",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_COLOR\n#define GLSL_VARYING_COLOR\n\n#include "./variables"\n\nvarying vec4 GLSL_VARYING_COLOR_VARIABLE;\n\n#endif\n'),r(o,t+"/data","#define GLSLIFY 1\n#ifndef GLSL_VARYING_DATA\n#define GLSL_VARYING_DATA\n\nstruct VaryingData {\n  // exported\n  vec3 localPosition;\n  vec3 localNormal;\n  vec3 position;\n  vec3 normal;\n  vec4 color;\n  vec2 uv;\n\n  // private\n  mat3 modelNormal;\n  mat4 model;\n};\n\nVaryingData CreateVaryingData() {\n  VaryingData data;\n  data.localPosition = vec3(0.0);\n  data.localNormal = vec3(0.0);\n  data.position = vec3(0.0);\n  data.normal = vec3(0.0);\n  data.color = vec4(0.0);\n  data.uv = vec2(0.0);\n\n  data.modelNormal = mat3(1.0);\n  data.model = mat4(1.0);\n  return data;\n}\n\n#endif\n"),r(o,t+"/emit",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_EMIT\n#define GLSL_VARYING_EMIT\n\n#include "./emit/position"\n#include "./emit/normal"\n#include "./emit/color"\n#include "./emit/uv"\n#include "./data"\n\nvoid EmitVaryingData(const in VaryingData data) {\n#if defined(GLSL_VARYING_POSITION) && defined(GLSL_VARYING_EMIT_POSITION)\n  EmitVaryingPositions(data.model, data.position);\n#endif\n\n#if defined(GLSL_VARYING_NORMAL) && defined(GLSL_VARYING_EMIT_NORMAL)\n  EmitVaryingNormals(data.modelNormal, data.normal);\n#endif\n\n#if defined(GLSL_VARYING_COLOR) && defined(GLSL_VARYING_EMIT_COLOR)\n  EmitVaryingColors(data.color);\n#endif\n\n#if defined(GLSL_VARYING_UV) && defined(GLSL_VARYING_EMIT_UV)\n  EmitVaryingUvs(data.uv);\n#endif\n}\n\n#endif\n'),r(o,t+"/read",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_READ\n#define GLSL_VARYING_READ\n\n#include "./read/position"\n#include "./read/normal"\n#include "./read/color"\n#include "./read/uv"\n#include "./data"\n\nVaryingData ReadVaryingData() {\n  VaryingData data = CreateVaryingData();\n#if defined(GLSL_VARYING_POSITION) && defined(GLSL_VARYING_READ_POSITION)\n  data.localPosition = ReadVaryingLocalPosition();\n  data.position = ReadVaryingPosition();\n#endif\n\n#if defined(GLSL_VARYING_NORMAL) && defined(GLSL_VARYING_READ_NORMAL)\n  data.localNormal = ReadVaryingLocalNormal();\n  data.normal = ReadVaryingNormal();\n#endif\n\n#if defined(GLSL_VARYING_COLOR) && defined(GLSL_VARYING_READ_COLOR)\n  data.color = ReadVaryingColor();\n#endif\n\n#if defined(GLSL_VARYING_UV) && defined(GLSL_VARYING_READ_UV)\n  data.uv = ReadVaryingUv();\n#endif\n  return data;\n}\n\n#endif\n'),r(o,t+"/uv",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_UV\n#define GLSL_VARYING_UV\n\n#include "./variables"\n\nvarying vec2 GLSL_VARYING_UV_VARIABLE;\n\n#endif\n'),o)))}).call(this,"/lib/core/glsl/varying")},{"./emit":45,"./read":47,glslify:288}],47:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(o={},r(o,t+"/position",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_READ_POSITION\n#define GLSL_VARYING_READ_POSITION\n#ifdef GLSL_VARYING_POSITION\n\n#include "../variables"\n\nvec3 ReadVaryingLocalPosition() {\n  return vec3(GLSL_VARYING_LOCAL_POSITION_VARIABLE);\n}\n\nvec3 ReadVaryingPosition() {\n  return vec3(GLSL_VARYING_POSITION_VARIABLE);\n}\n\n#endif\n#endif\n'),r(o,t+"/normal",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_READ_NORMAL\n#define GLSL_VARYING_READ_NORMAL\n#ifdef GLSL_VARYING_NORMAL\n\n#include "../variables"\n\nvec3 ReadVaryingLocalNormal() {\n  return vec3(GLSL_VARYING_LOCAL_NORMAL_VARIABLE);\n}\n\nvec3 ReadVaryingNormal() {\n  return vec3(GLSL_VARYING_NORMAL_VARIABLE);\n}\n\n#endif\n#endif\n'),r(o,t+"/color",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_READ_COLOR\n#define GLSL_VARYING_READ_COLOR\n#ifdef GLSL_VARYING_COLOR\n\n#include "../variables"\n\nvec4 ReadVaryingColor() {\n  return vec4(GLSL_VARYING_COLOR_VARIABLE);\n}\n\n#endif\n#endif\n'),r(o,t+"/uv",'#define GLSLIFY 1\n#ifndef GLSL_VARYING_READ_UV\n#define GLSL_VARYING_READ_UV\n#ifdef GLSL_VARYING_UV\n\n#include "../variables"\n\nvec2 ReadVaryingUv() {\n  return vec2(GLSL_VARYING_UV_VARIABLE);\n}\n\n#endif\n#endif\n'),o))}).call(this,"/lib/core/glsl/varying/read")},{glslify:288}],48:[function(e,t,n){(function(t){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o;!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,(o={},r(o,t+"/variables","#define GLSLIFY 1\n#ifndef GLSL_VERTEX_ATTRIBUTES_VARIABLES\n#define GLSL_VERTEX_ATTRIBUTES_VARIABLES\n\n#ifndef GLSL_VERTEX_ATTRIBUTES_POSITION_VARIABLE\n#define GLSL_VERTEX_ATTRIBUTES_POSITION_VARIABLE position\n#endif\n\n#ifndef GLSL_VERTEX_ATTRIBUTES_NORMAL_VARIABLE\n#define GLSL_VERTEX_ATTRIBUTES_NORMAL_VARIABLE normal\n#endif\n\n#ifndef GLSL_VERTEX_ATTRIBUTES_COLOR_VARIABLE\n#define GLSL_VERTEX_ATTRIBUTES_COLOR_VARIABLE color\n#endif\n\n#ifndef GLSL_VERTEX_ATTRIBUTES_UV_VARIABLE\n#define GLSL_VERTEX_ATTRIBUTES_UV_VARIABLE uv\n#endif\n\n#endif\n"),r(o,t+"/position",'#define GLSLIFY 1\n#ifndef GLSL_VERTEX_ATTRIBUTES_POSITION\n#define GLSL_VERTEX_ATTRIBUTES_POSITION\n\n#include "./variables"\n\nattribute vec3 GLSL_VERTEX_ATTRIBUTES_POSITION_VARIABLE;\n\n#endif\n'),r(o,t+"/normal",'#define GLSLIFY 1\n#ifndef GLSL_VERTEX_ATTRIBUTES_NORMAL\n#define GLSL_VERTEX_ATTRIBUTES_NORMAL\n\n#include "./variables"\n\nattribute vec3 GLSL_VERTEX_ATTRIBUTES_NORMAL_VARIABLE;\n\n#endif\n'),r(o,t+"/color",'#define GLSLIFY 1\n#ifndef GLSL_VERTEX_ATTRIBUTES_COLOR\n#define GLSL_VERTEX_ATTRIBUTES_COLOR\n\n#include "./variables"\n\nattribute vec4 GLSL_VERTEX_ATTRIBUTES_COLOR_VARIABLE;\n\n#endif\n'),r(o,t+"/uv",'#define GLSLIFY 1\n#ifndef GLSL_VERTEX_ATTRIBUTES_UV\n#define GLSL_VERTEX_ATTRIBUTES_UV\n\n#include "./variables"\n\nattribute vec2 GLSL_VERTEX_ATTRIBUTES_UV_VARIABLE;\n\n#endif\n'),o))}).call(this,"/lib/core/glsl/vertex/attributes")},{glslify:288}],49:[function(e,t,n){(function(t){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};!function(e){e&&e.__esModule}(e("glslify"));Object.assign(n,r({},e("./attributes"),function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t+"/main",'#define GLSLIFY 1\n#ifndef GLSL_VERTEX_MAIN\n#define GLSL_VERTEX_MAIN\n\n#include "../varying/data"\n\nvoid InitVarying(inout VaryingData varyingData);\nvoid BeforeMain(inout vec4 vertexPosition, inout VaryingData varyingData);\nvoid Main(inout vec4 vertexPosition, inout VaryingData data);\nvoid TransformMain(inout vec4 vertexPosition, inout VaryingData varyingData);\nvoid AfterMain(inout vec4 vertexPosition, inout VaryingData varyingData);\n\nvoid main() {\n  VaryingData varyingData = CreateVaryingData();\n  InitVarying(varyingData);\n  gl_Position = vec4(vec3(0.0), 1.0);\n  BeforeMain(gl_Position, varyingData);\n  Main(gl_Position, varyingData);\n  TransformMain(gl_Position, varyingData);\n#ifdef GLSL_VARYING_EMIT\n  EmitVaryingData(varyingData);\n#endif\n  AfterMain(gl_Position, varyingData);\n}\n\n#ifdef GLSL_VERTEX_MAIN_BEFORE\n  void GLSL_VERTEX_MAIN_BEFORE(inout vec4 vertexPosition,\n                               inout VaryingData varyingData);\n#endif\n\n#ifdef GLSL_VERTEX_MAIN_TRANSFORM\n  void GLSL_VERTEX_MAIN_TRANSFORM(inout vec4 vertexPosition,\n                                  inout VaryingData varyingData);\n#endif\n\n#ifdef GLSL_VERTEX_MAIN_AFTER\n  void GLSL_VERTEX_MAIN_AFTER(inout vec4 vertexPosition,\n                              inout VaryingData varyingData);\n#endif\n\nvoid BeforeMain(inout vec4 vertexPosition,\n                inout VaryingData varyingData) {\n#ifdef GLSL_VERTEX_MAIN_BEFORE\n  GLSL_VERTEX_MAIN_BEFORE(vertexPosition, varyingData);\n#endif\n}\n\nvoid TransformMain(inout vec4 vertexPosition,\n                   inout VaryingData varyingData) {\n#ifdef GLSL_VERTEX_MAIN_TRANSFORM\n  GLSL_VERTEX_MAIN_TRANSFORM(vertexPosition, varyingData);\n#endif\n}\n\nvoid AfterMain(inout vec4 vertexPosition,\n               inout VaryingData varyingData) {\n#ifdef GLSL_VERTEX_MAIN_AFTER\n  GLSL_VERTEX_MAIN_AFTER(vertexPosition, varyingData);\n#endif\n}\n\nvoid InitVarying(inout VaryingData varyingData) {\n  #ifdef GLSL_VERTEX_ATTRIBUTES_POSITION\n    varyingData.position = position;\n  #endif\n\n  #ifdef GLSL_VERTEX_ATTRIBUTES_NORMAL\n    varyingData.normal = normal;\n  #endif\n\n  #ifdef GLSL_VERTEX_ATTRIBUTES_COLOR\n    varyingData.color = color;\n  #endif\n\n  #ifdef GLSL_VERTEX_ATTRIBUTES_UV\n    varyingData.uv = uv;\n  #endif\n\n  #if defined(GLSL_MESH) && defined(GLSL_MESH_UNIFORMS)\n    varyingData.modelNormal = mesh.modelNormal;\n    varyingData.model = mesh.model;\n  #endif\n}\n\n#endif\n')))}).call(this,"/lib/core/glsl/vertex")},{"./attributes":48,glslify:288}],50:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.libglsl=void 0;var r=e("./component");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./shaderlib");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./geometry");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./command");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})});var u=e("./dynamic");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}})});var f=e("./context");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return f[e]}})});var c=e("./entity");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return c[e]}})});var s=e("./gl");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return s[e]}})});var l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./glsl"));n.libglsl=l},{"./command":28,"./component":29,"./context":30,"./dynamic":31,"./entity":32,"./geometry":33,"./gl":35,"./glsl":40,"./shaderlib":51}],51:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.ShaderLibPreprocessor=n.ShaderLibPlugin=n.ShaderLib=void 0;var f=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c="function"==typeof Symbol&&"symbol"==u(Symbol.iterator)?function(e){return void 0===e?"undefined":u(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":u(e)},s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=e("./dynamic"),d=e("./component"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./glsl")),m=e("path"),h=(r(e("glsl-token-defines")),r(e("glsl-token-string"))),b=r(e("glsl-inject-defines")),v=r(e("glsl-tokenizer")),g=r(e("prepr")),_=r(e("defined")),w="preprocessor",O="block-comment",x="line-comment",S="mediump float",j="100",E=(n.ShaderLib=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.preprocessor,r=void 0===n?void 0:n,o=t.middleware,i=void 0===o?[]:o,u=t.precision,f=void 0===u?S:u,c=t.version,l=void 0===c?j:c,d=t.defines,m=void 0===d?{}:d,h=t.glsl;a(this,e),this.cache=new p.DynamicValue(this),this.store=new p.DynamicValue(this),this.version=(0,_.default)(l||j),this.precision=(0,_.default)(f,S),this.middleware=(0,_.default)(i,[]),this.preprocessor=(0,_.default)(r,new E(this)),this.preprocessor.define(m),this.add(s({},y,h))}return l(e,null,[{key:"defaults",value:function(){return{precision:S,shaderName:"<anonymous>",version:j,defines:{},name:"<anonymous>"}}}]),l(e,[{key:"define",value:function(e,t){return this.preprocessor.define(e,t)}},{key:"injectShaderNameDefine",value:function(e,t){var n=/\s?#ifndef SHADER_NAME\s?\n#define SHADER_NAME\s?.*\n#endif\n?$/g;return String(t).replace(n,"")}},{key:"injectShaderPrecision",value:function(e){var t=this.precision,n="precision "+(void 0===t?S:t)+";",r=/[\s|\t]?precision\s+([a-z]+)\s+([a-z|A-Z]+)[\s+]?;[\s|\t|\r]?/g;return e=e.replace(n,"").replace(r,""),n+"\n"+e}},{key:"add",value:function(e,t){var n=this;return"string"==typeof e&&"string"==typeof t?(e=e.replace(/[\/]+/g,"/"),this.store.set(e,t)):e&&"object"==(void 0===e?"undefined":c(e))&&function e(t,r){for(var o in r)t.push(o),"object"==c(r[o])?e(t,r[o]):n.add(t.join("/"),r[o]),t.pop()}([],e),this}},{key:"get",value:function(e){return"string"==typeof e&&"string"==typeof this.store[e]?this.compile(e,this.store[e]):null}},{key:"resolve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"./";return t=(0,m.resolve)("/",t),e=e.replace((0,m.extname)(e),""),e=(0,m.resolve)(t,e).slice(1)}},{key:"hash",value:function(e){return"string"!=typeof e?null:String(e).split("").map(function(e){return e.charCodeAt(0)}).reduce(function(e,t){return e+t},0).toString("16")}},{key:"isCached",value:function(e){return"string"==typeof this.cache[this.hash(e)||""]}},{key:"preprocess",value:function(e){var t=this.defines;return e=(0,g.default)(e,t),e=e.split("\n").filter(function(e){return 0==/^\s*$/.test(e)}).join("\n")}},{key:"compile",value:function(e,t){if(!t&&e&&(t=e,e=null),e||(e="<anonymous>"),!t)return null;var n=this.hash(t);return this.cache[n]?this.cache[n]:(t=this.injectShaderNameDefine(e,t),t=this.preprocessor.process(e,t),t=this.injectShaderPrecision(t),t=t.split("\n").filter(function(e){return e.length}).map(function(e){return 1==e.length?e+"\n":e}).join("\n"),this.cache.set(n,t),t+"\n")}},{key:"use",value:function(e){return"function"==typeof e&&this.middleware.push(e),this}},{key:"defines",get:function(){var e=(this.preprocessor||{}).defines;return void 0===e?null:e}}]),e}(),n.ShaderLibPlugin=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,d.Component),t}(),n.ShaderLibPreprocessor=function(){function e(t){a(this,e),this.defines=new p.DynamicValue(this),this.shaderLib=t,this.middleware=[]}return l(e,[{key:"define",value:function(e,t){var n=this;return"object"==(void 0===e?"undefined":c(e))?Object.keys(e).map(function(t){return n.define(t,e[t])}).some(function(e){return!0===e}):"string"==typeof e&&(!0===t?t=1:!1===t&&(t=0),null!=t)&&(t=String(t))!=this.defines[e]&&(this.defines.set(e,t),!0)}},{key:"undefine",value:function(e){return this.defines.unset(e),this}},{key:"process",value:function(e,t){function n(e,t,r){var o=(0,v.default)(e,{version:l}),a=!0,u=!1,c=void 0;try{for(var s,d=o[Symbol.iterator]();!(a=(s=d.next()).done);a=!0)!function(){var e=s.value,o=function(){return t.push(e)};switch(e.type){case O:case x:break;case w:var a=RegExp(/[\s|\t]?#include[\s]+([<|"]?.*[>|"]?)$/);switch(e.data.match(/(#[a-z]+)\s?/)[0].trim()){case"#define":var u=e.data.match(/#define[\s]+(.*)/);u&&(u[1].match(/.*[\s]+(.*)/)||(e.data=e.data+" 1")),o();break;case"#include":var c=e.data.match(a)||[],l=f(c,2),d=(l[0],l[1]),y=d.replace(/^["|<](.*)["|>]/,"$1").trim(),m=d[0].trim(),h=d[d.trim().length-1].trim(),b=function(e,t){return new e((t||"")+"\n\tat (glsl) "+p.join("\n\tat (glsl) "))};if(-1==["<",'"'].indexOf(m)){var v="Unexpected token '"+m+"'. Expecting '<' or '\"'.";throw b(SyntaxError,v)}if(-1==[">",'"'].indexOf(h)){var g="Unexpected token '"+h+"'. Expecting "+("<"==m?"'>'":"'\"'")+".";throw b(SyntaxError,g)}if("<"==m&&">"!=h){var _="Unexpected token '"+h+"'. Expecting '>'.";throw b(SyntaxError,_)}if('"'==m&&'"'!=h){var S="Unexpected token '"+h+"'. Expecting '\"'.";throw b(SyntaxError,S)}var j="<"==m&&">"==h?"/":r,E="."!=y[0]?"./":"",A=i.resolve(""+E+y,j),M=i.get(A);if(!M)throw b(ReferenceError,"glsl lib "+d+" not found.");p.push(y+":"+e.line),n(M+"\n",t,j),p.pop();break;default:o()}break;default:o()}}()}catch(e){u=!0,c=e}finally{try{!a&&d.return&&d.return()}finally{if(u)throw c}}}var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.shaderLib,a=this.defines,u=i.middleware,l=i.version,p=[],d=[];return o=o&&"object"==(void 0===o?"undefined":c(o))?o:{},"string"==typeof t&&(t=(0,b.default)(t,s({},a,o.defines))),n("\n"+t+"\n",d,"<anonymous>"!=e?(0,m.dirname)(e):"/"),t=(0,h.default)(d),u.filter(function(e){return"function"==typeof e}).reduce(function(e,t){return(0,_.default)(t(i,r,e,o),e)},t).replace("#define GLSLIFY 1\n","")}}]),e}())},{"./component":29,"./dynamic":31,"./glsl":40,defined:128,"glsl-inject-defines":277,"glsl-token-defines":278,"glsl-token-string":280,"glsl-tokenizer":287,path:294,prepr:295}],52:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.FrameContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../utils"),s=e("../scope"),l=e("../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.FrameContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{regl:function(){return e?e.regl:null},gl:function(){return e?e.gl:null},cancel:function(e){var t=e.frame,n=e.frames;return function(){t&&(t.cancel(),n.splice(n.indexOf(t),1))}},clear:function(e,t){return function(r){e.regl.clear(u({},r||(0,c.get)("clear",[t,n])))}},cancelAll:function(e){var t=e.frames,n=(e.frame,e.loop);return function(){if(t){var e=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(e=(i=a.next()).done);e=!0)i.value.cancel()}catch(e){r=!0,o=e}finally{try{!e&&a.return&&a.return()}finally{if(r)throw o}}t.splice(0,t.length)}n&&(n.cancel(),n=null)}}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../core":50,"../scope":90,"../utils":116,"./defaults":53}],53:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.autoClear=!0,n.blending={equation:"add",enable:!1,color:[0,0,0,1],func:{src:"src alpha",dst:"one minus src alpha"}},n.culling={enable:!0,face:"back"},n.depth={enable:!0,range:[0,1],func:"less",mask:!0},n.clear={color:[17/255,17/255,17/255,1],depth:1}},{}],54:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Frame=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../utils"),s=e("../scope"),l=e("../core"),p=e("./uniforms"),d=e("./context"),y=e("./state"),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.Frame=function(e){function t(e){function n(t,n){var r=null,o=null;return o={cancel:function(){r=!0},onframe:function(){if(r)g.splice(g.indexOf(o,1));else try{n(function(){return f(t)})}catch(t){e.emit("error",t),a()}}}}function i(){w=e.regl.frame(function(){try{!0===u.autoClear&&v();var t=!0,n=!1,r=void 0;try{for(var o,i=g[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var f=o.value;f.onframe.apply(f,arguments)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}catch(t){try{var c=!0,s=!1,l=void 0;try{for(var p,d=g[Symbol.iterator]();!(c=(p=d.next()).done);c=!0)p.value.cancel()}catch(e){s=!0,l=e}finally{try{!c&&d.return&&d.return()}finally{if(s)throw l}}}catch(t){e.emit("error",t)}a()}})}function a(){try{var t=!0,n=!1,r=void 0;try{for(var o,i=g[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)o.value.cancel()}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}catch(t){e.emit("error",t)}g.splice(0,g.length)}var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,c.assignDefaults)(u,t.defaults());var f=e.regl({}),m=new p.FrameShaderUniforms(e,u),h=new d.FrameContext(e,u),b=new y.FrameState(e,u),v=l.Component.compose(h,function(){return f(function(e){return(0,e.clear)()})}),g=[],_=l.Component.compose(b,h,m),w=null;return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u,function(t,r){null==w&&i();var o=new s.ScopedContext(e,{frame:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return a}),frames:g,loop:w}),a=n(r,l.Component.compose(o,_));g.push(a)}))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},m)}}]),t}()},{"../core":50,"../scope":90,"../utils":116,"./context":52,"./defaults":53,"./state":56,"./uniforms":57}],55:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./uniforms");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./frame");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./state");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":52,"./frame":54,"./state":56,"./uniforms":57}],56:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.FrameState=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../utils"),s=(e("../material"),e("../core")),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.FrameState=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.regl({depth:u({},n.depth),blend:u({},n.blending),cull:u({},n.culling)})))}return i(t,s.Component),f(t,null,[{key:"defaults",value:function(){return u({},l)}}]),t}()},{"../core":50,"../material":61,"../utils":116,"./defaults":53}],57:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.FrameShaderUniforms=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../utils"),s=e("../shader"),l=e("../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.FrameShaderUniforms=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ShaderUniforms(e,{time:function(e){return e.time},tick:function(e){return e.tick}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../core":50,"../shader":93,"../utils":116,"./defaults":53}],58:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./camera");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./compute");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./core");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./frame");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})});var u=e("./material");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}})});var f=e("./mesh");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return f[e]}})});var c=e("./object3d");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return c[e]}})});var s=e("./scissor");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return s[e]}})});var l=e("./scope");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return l[e]}})});var p=e("./shader");Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return p[e]}})});var d=e("./texture");Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return d[e]}})});var y=e("./viewport");Object.keys(y).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return y[e]}})})},{"./camera":8,"./compute":27,"./core":50,"./frame":55,"./material":61,"./mesh":73,"./object3d":87,"./scissor":89,"./scope":90,"./shader":93,"./texture":114,"./viewport":117}],59:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MaterialContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../utils"),s=e("../scope"),l=e("../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.MaterialContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{lineWidth:function(e,t){return(0,c.get)("lineWidth",[t,e])},wireframe:function(e,t){return(0,c.get)("wireframe",[t,e])},opacity:function(e,t){return(0,c.get)("opacity",[t,e])},color:function(e,t){return(0,c.ensureRGB)((0,c.get)("color",[t,e]))}})))}return i(t,l.Component),f(t,null,[{key:"defualts",value:function(){return u({},p)}}]),t}()},{"../core":50,"../scope":90,"../utils":116,"./defaults":60}],60:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.uniformName="material",n.opacity=1,n.color=[100/255,110/255,1],n.wireframePrimitive="line strip",n.primitive="triangles",n.lineWidth=1,n.blending={equation:"add",enable:!0,color:[0,0,0,1],func:{src:"src alpha",dst:"one minus src alpha"}},n.culling={enable:!1,face:"back"},n.depth={enable:!0,range:[0,1],func:"less",mask:!0}},{}],61:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./material");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./shader");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./state");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":59,"./material":62,"./shader":63,"./state":66}],62:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Material=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./shader"),s=e("./context"),l=e("../utils"),p=e("./state"),d=e("../core"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.Material=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,l.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new p.MaterialState(e,n),new s.MaterialContext(e,n),new c.MaterialShaderUniforms(e,n),new c.MaterialShader(e,n)))}return i(t,d.Component),f(t,null,[{key:"defaults",value:function(){return u({},y)}}]),t}()},{"../core":50,"../utils":116,"./context":59,"./defaults":60,"./shader":63,"./state":66}],63:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./uniforms");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./shader");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},{"./shader":64,"./uniforms":65}],64:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MaterialShader=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../core"),l=e("../../shader"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.MaterialShader=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,c.assignDefaults)(n,t.defaults());var i=n.uniformName;return n.fragmentShader,o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.Shader(e,{fragmentShader:function(e){return e.fragmentShader||"\n          #define GLSL_MATERIAL_UNIFORM_VARIABLE "+i+"\n          #include <material/fragment/main>\n          "}})))}return i(t,s.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../shader":93,"../../utils":116,"../defaults":60}],65:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MaterialShaderUniforms=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../shader"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.MaterialShaderUniforms=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,c.assignDefaults)(n,t.defaults());var i=n.uniformName;return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ShaderUniforms(e,{prefix:i+"."},{opacity:function(e,t){return(0,c.get)("opacity",[t,e,n])},color:function(e,t){return(0,c.ensureRGB)((0,c.get)("color",[t,e,n]))}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../shader":93,"../../utils":116,"../defaults":60}],66:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MaterialState=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../utils"),s=e("../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.MaterialState=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,e.regl({blend:{equation:function(e,t){return(0,c.get)("equation",[t.blending,e.blending,n.blending])},color:function(e,t){return(0,c.ensureRGBA)((0,c.get)("color",[t.blending,e.blending,n.blending]))},enable:function(e,t){return(0,c.get)("enable",[t.blending,e.blending,n.blending])},func:function(e,t){return(0,c.get)("func",[t.blending,e.blending,n.blending])}},cull:{enable:function(e,t){return Boolean((0,c.get)("enable",[t.culling,e.culling,n.culling]))},face:function(e,t){return String((0,c.get)("face",[t.culling,e.culling,n.culling]))}},depth:{enable:function(e,t){return Boolean((0,c.get)("enable",[t.depth,e.depth,n.depth]))},range:function(e,t){return(0,c.get)("range",[t.depth,e.depth,n.depth])},func:function(e,t){return(0,c.get)("func",[t.depth,e.depth,n.depth])},mask:function(e,t){return(0,c.get)("mask",[t.depth,e.depth,n.depth])}}})))}return i(t,s.Component),f(t,null,[{key:"defaults",value:function(){return u({},l)}}]),t}()},{"../core":50,"../utils":116,"./defaults":60}],67:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MeshBoundingBoxContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../scope"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.MeshBoundingBoxContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,c.assignDefaults)(n,t.defaults());var i=new WeakMap;return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{boundingBox:function(e){var t=e.geometry;if(t){if(i.has(t))return i.get(t);if("function"==typeof t.computeBoundingBox){var n=t.computeBoundingBox();return i.set(t,n),n}return null}return null}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../scope":90,"../../utils":116,"../defaults":72}],68:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MeshContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./bounding-box"),s=e("./geometry"),l=e("./size"),p=e("../../utils"),d=e("../../core"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.MeshContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,p.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.MeshGeometryContext(e,n),new c.MeshBoundingBoxContext(e,n),new l.MeshSizeContext(e,n)))}return i(t,d.Component),f(t,null,[{key:"defaults",value:function(){return u({},y)}}]),t}()},{"../../core":50,"../../utils":116,"../defaults":72,"./bounding-box":67,"./geometry":69,"./size":71}],69:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MeshGeometryContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../scope"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.MeshGeometryContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,c.assignDefaults)(n,t.defaults());var i=n.geometry;return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{geometry:function(){return i}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../scope":90,"../../utils":116,"../defaults":72}],70:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./bounding-box");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./geometry");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./context");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./size");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./bounding-box":67,"./context":68,"./geometry":69,"./size":71}],71:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MeshSizeContext=void 0;var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../../utils"),l=e("../../scope"),p=e("../../core"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),y=r(e("gl-vec2")),m=r(e("gl-vec3"));n.MeshSizeContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),(0,s.assignDefaults)(n,t.defaults());var r=new WeakMap;return i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.ScopedContext(e,{size:function(e){var t=e.boundingBox,n=e.scale;if(!t)return[0,0];if(r.has(t))return r.get(t);n||(n=[1,1,1]);var o=t&&t[0].length,i=t[0],a=t[1],u=[];switch(o){case 3:m.default.subtract(u,a,i),m.default.multiply(u,u,n);break;case 2:y.default.subtract(u,a,i),y.default.multiply(u,u,n)}return r.set(t,u),u}})))}return a(t,p.Component),c(t,null,[{key:"defaults",value:function(){return f({},d)}}]),t}()},{"../../core":50,"../../scope":90,"../../utils":116,"../defaults":72,"gl-vec2":212,"gl-vec3":242}],72:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.uniformName="mesh",n.wireframePrimitive="line strip",n.primitive="triangles",n.lineWidth=1},{}],73:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./context");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./shader");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./state");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./mesh");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":70,"./mesh":74,"./shader":77,"./state":80}],74:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Mesh=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../camera"),s=e("../utils"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),p=e("../core"),d=e("../object3d"),y=e("./context"),m=e("./state"),h=e("./shader");n.Mesh=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,s.assignDefaults)(n,t.defaults()),null==n.geometry.complex&&(n.geometry=new p.Geometry({complex:n.geometry}));var i=e.regl({}),a=e.regl(u({},n.regl));return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new d.Object3D(e,n),new y.MeshContext(e,n),new m.MeshState(e,n),new h.MeshShaderDefines(e,n),new h.MeshShaderAttributes(e,n),new h.MeshShaderUniforms(e,n),new h.MeshShader(e,n),new c.CameraShaderUniforms(e,u({},n.camera)),function(e,t){a(e),i(t)}))}return i(t,p.Component),f(t,null,[{key:"defaults",value:function(){return u({},l)}}]),t}()},{"../camera":8,"../core":50,"../object3d":87,"../utils":116,"./context":70,"./defaults":72,"./shader":77,"./state":80}],75:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MeshShaderAttributes=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../shader"),s=e("../../utils"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.MeshShaderAttributes=function(e){function t(e,n){r(this,t),(0,s.assignDefaults)(n,t.defaults());var i=n.geometry,a={};return i&&(a.position=i.positions||null,a.normal=i.normals||null,a.uv=i.uvs||null),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new c.ShaderAttributes(e,a)))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../shader":93,"../../utils":116,"../defaults":72}],76:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MeshShaderDefines=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../shader"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.MeshShaderDefines=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ShaderDefines(e,{GLSL_MESH_HAS_POSITION:function(e){return!!e.geometry.positions||null},GLSL_MESH_HAS_NORMAL:function(e){return!!e.geometry.normals||null},GLSL_MESH_HAS_UV:function(e){return!!e.geometry.uvs||null}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../shader":93,"../../utils":116,"../defaults":72}],77:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./attributes");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./uniforms");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./defines");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./shader");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./attributes":75,"./defines":76,"./shader":78,"./uniforms":79}],78:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MeshShader=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),p=e("../../shader");n.MeshShader=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,new p.Shader(e,u({vertexShader:function(e){var r=e.vertexShader,o=n.uniformName;return"string"==typeof r?r:t.createVertexShader({uniformName:o})}},n))))}return i(t,s.Component),f(t,null,[{key:"defaults",value:function(){return u({},l)}},{key:"createVertexShader",value:function(){return"\n    #define GLSL_MESH_UNIFORM_VARIABLE "+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).uniformName+"\n    #include <mesh/vertex/main>\n    "}}]),t}()},{"../../core":50,"../../shader":93,"../../utils":116,"../defaults":72}],79:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MeshShaderUniforms=void 0;var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../../utils"),l=e("../../shader"),p=e("../../core"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),y=r(e("gl-mat4")),m=r(e("gl-mat3")),h=y.default.identity([]),b=m.default.identity([]);n.MeshShaderUniforms=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),(0,s.assignDefaults)(n,t.defaults());var r=n.uniformName;return n.prefix=r+".",i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.ShaderUniforms(e,n,{position:function(e,t){return(0,s.get)("position",[e,t,n])},rotation:function(e,t){return(0,s.get)("rotation",[e,t,n])},scale:function(e,t){return(0,s.get)("scale",[e,t,n])},modelNormal:function(e){var t=e.transform;return(0,s.isArrayLike)(t)?m.default.normalFromMat4([],t)||b:b},model:function(e){var t=e.transform;return(0,s.isArrayLike)(t)?t:h}})))}return a(t,p.Component),c(t,null,[{key:"defaults",value:function(){return f({},d)}}]),t}()},{"../../core":50,"../../shader":93,"../../utils":116,"../defaults":72,"gl-mat3":142,"gl-mat4":160}],80:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.MeshState=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../utils"),s=e("../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),p=function(e){return e&&e.__esModule?e:{default:e}}(e("defined"));n.MeshState=function(e){function t(e,n){r(this,t),(0,c.assignDefaults)(n,t.defaults());var i=n.geometry,a={primitive:function(e,t){return(0,c.get)("wireframe",[t,e])?(0,c.get)("wireframePrimitive",[t,e]):(0,c.get)("primitive",[t,e])},lineWidth:function(e,t){return Math.max(1,(0,c.get)("lineWidth",[t,e]))}};return i&&i.cells?a.elements=function(e,t){var n=i.cells,r=(0,c.get)("count",[t,e]);return n&&"number"==typeof r?n.slice(0,(0,p.default)(Math.floor(r),0,n.length)):n}:i&&(a.count=function(e,t){return(0,c.get)("count",[t,e])||i.positions.length}),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,e.regl(a)))}return i(t,s.Component),f(t,null,[{key:"defaults",value:function(){return u({},l)}}]),t}()},{"../core":50,"../utils":116,"./defaults":72,defined:128}],81:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Object3DContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./transform"),s=e("./matrix"),l=e("./trs"),p=e("../../utils"),d=e("../../core"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.Object3DContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,p.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.Object3DTRSContext(e,n),new s.Object3DMatrixContext(e,n),new c.Object3DTransformContext(e,n)))}return i(t,d.Component),f(t,null,[{key:"defaults",value:function(){return u({},y)}}]),t}()},{"../../core":50,"../../utils":116,"../defaults":86,"./matrix":83,"./transform":84,"./trs":85}],82:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./transform");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./matrix");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./trs");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":81,"./matrix":83,"./transform":84,"./trs":85}],83:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Object3DMatrixContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../scope"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),d=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-mat4"));n.Object3DMatrixContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{matrix:function(e,t){var r=d.default.identity([]),o=(0,c.get)("position",[e,t]),i=(0,c.get)("rotation",[e,t]),a=(0,c.get)("scale",[e,t,n]);return d.default.fromRotationTranslation(r,i,o),d.default.scale(r,r,a),r}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../scope":90,"../../utils":116,"../defaults":86,"gl-mat4":160}],84:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Object3DTransformContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../scope"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),d=function(e){return e&&e.__esModule?e:{default:e}}(e("gl-mat4"));n.Object3DTransformContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{transform:function(e,t){var n=e.matrix,r=e.transform,o=d.default.identity([]),i=(t||{}).transform;return r&&d.default.multiply(o,r,n),i&&d.default.multiply(o,i,o),o}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../scope":90,"../../utils":116,"../defaults":86,"gl-mat4":160}],85:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Object3DTRSContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../scope"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.Object3DTRSContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{scale:function(e,t){var r=(0,c.get)("scale",[t,n,e]);return"number"==typeof r?[r,r,r]:r},position:function(e,t){return(0,c.get)("position",[t,n,e])},rotation:function(e,t){return(0,c.get)("rotation",[t,n,e])}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../scope":90,"../../utils":116,"../defaults":86}],86:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.rotation=[0,0,0,1],n.position=[0,0,0],n.scale=[1,1,1]},{}],87:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./object3d");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},{"./context":82,"./object3d":88}],88:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Object3D=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./context"),s=e("../utils"),l=e("../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.Object3D=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,s.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new c.Object3DContext(e,n)))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../core":50,"../utils":116,"./context":82,"./defaults":86}],89:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Scissor=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=e("./core");n.Scissor=function(e){function t(e,n,i){var a;r(this,t);for(var f=arguments.length,c=Array(f>3?f-3:0),s=3;s<f;s++)c[s-3]=arguments[s];"function"==typeof i&&c.unshift(i),"function"==typeof n&&c.unshift(n),"object"!=(void 0===n?"undefined":u(n))&&(n={}),"object"!=(void 0===i?"undefined":u(i))&&(i=n);var l=e.regl({scissor:{enable:!0,box:n.scissor}});return o(this,(a=t.__proto__||Object.getPrototypeOf(t)).call.apply(a,[this,e,l].concat(c)))}return i(t,f.Component),t}()},{"./core":50}],90:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.ScopedContext=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=e("./core");n.ScopedContext=function(e){function t(e,n,i){var a;r(this,t);for(var c=arguments.length,s=Array(c>3?c-3:0),l=3;l<c;l++)s[l-3]=arguments[l];"function"==typeof i&&s.unshift(i),"function"==typeof n&&s.unshift(n),"object"!=(void 0===n?"undefined":u(n))&&(n={}),"object"!=(void 0===i?"undefined":u(i))&&(i=n);var p=e.regl({context:new f.DynamicValue(e,{},i)});return o(this,(a=t.__proto__||Object.getPrototypeOf(t)).call.apply(a,[this,e,p].concat(s)))}return i(t,f.Component),t}()},{"./core":50}],91:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.ShaderInstancedAttributes=n.ShaderAttributes=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=e("../core");n.ShaderAttributes=function(e){function t(e,n,i){var a;r(this,t);for(var c=arguments.length,s=Array(c>3?c-3:0),l=3;l<c;l++)s[l-3]=arguments[l];"function"==typeof i&&s.unshift(i),"function"==typeof n&&s.unshift(n),"object"!=(void 0===n?"undefined":u(n))&&(n={}),"object"!=(void 0===i?"undefined":u(i))&&(i=n);var p=e.regl({attributes:new f.WebGLShaderAttributes(e,n,i)});return o(this,(a=t.__proto__||Object.getPrototypeOf(t)).call.apply(a,[this,e,{},p].concat(s)))}return i(t,f.Component),t}(),n.ShaderInstancedAttributes=function(e){function t(e,n,i){var a;r(this,t);for(var c=arguments.length,s=Array(c>3?c-3:0),l=3;l<c;l++)s[l-3]=arguments[l];"function"==typeof i&&s.unshift(i),"function"==typeof n&&s.unshift(n),"object"!=(void 0===n?"undefined":u(n))&&(n={}),"object"!=(void 0===i?"undefined":u(i))&&(i=n);var p=e.regl({attributes:new f.WebGLShaderInstancedAttributes(e,n,i)});return o(this,(a=t.__proto__||Object.getPrototypeOf(t)).call.apply(a,[this,e,{},p].concat(s)))}return i(t,f.Component),t}()},{"../core":50}],92:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.ShaderDefines=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=e("../scope"),c=e("../core");n.ShaderDefines=function(e){function t(e,n,i){r(this,t);for(var a=arguments.length,c=Array(a>3?a-3:0),s=3;s<a;s++)c[s-3]=arguments[s];return"function"==typeof i&&c.unshift(i),"function"==typeof n&&c.unshift(n),"object"!=(void 0===n?"undefined":u(n))&&(n={}),"object"!=(void 0===i?"undefined":u(i))&&(i=n),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new f.ScopedContext(e,n,{defines:function(){var e={};for(var t in i){var n=i[t];e[t]="function"==typeof n?n.apply(void 0,arguments):n,null==e[t]&&delete e[t]}return e}})))}return i(t,c.Component),t}()},{"../core":50,"../scope":90}],93:[function(e,t,n){arguments[4][77][0].apply(n,arguments)},{"./attributes":91,"./defines":92,"./shader":94,"./uniforms":95,dup:77}],94:[function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0}),r.Shader=void 0;"function"==typeof Symbol&&u(Symbol.iterator);var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../core");r.Shader=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),Object.assign(r,t.defaults(),r);var a=r.defines;r.shaderName,new s.ShaderLib(f({},r,{defines:a})),e.regl({});return i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n))}return a(t,s.Component),c(t,null,[{key:"defaults",value:function(){return f({},s.ShaderLib.defaults(),{defines:{}})}}]),t}()},{"../core":50}],95:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.ShaderUniforms=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=e("../core");n.ShaderUniforms=function(e){function t(e,n,i){var a;r(this,t);for(var c=arguments.length,s=Array(c>3?c-3:0),l=3;l<c;l++)s[l-3]=arguments[l];"function"==typeof i&&s.unshift(i),"function"==typeof n&&s.unshift(n),"object"!=(void 0===n?"undefined":u(n))&&(n={}),"object"!=(void 0===i?"undefined":u(i))&&(i=n);var p=e.regl({uniforms:new f.WebGLShaderUniforms(e,n,i)});return o(this,(a=t.__proto__||Object.getPrototypeOf(t)).call.apply(a,[this,e,p].concat(s)))}return i(t,f.Component),t}()},{"../core":50}],96:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.TextureContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../../utils"),s=e("../../../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),p=e("./pointer"),d=e("./data"),y=e("./info");n.TextureContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),n.uniformName,o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new d.TextureDataContext(e,n),new p.TexturePointerContext(e,n),new y.TextureInfoContext(e,n)))}return i(t,s.Component),f(t,null,[{key:"defaults",value:function(){return u({},l)}}]),t}()},{"../../../core":50,"../../../utils":116,"../defaults":101,"./data":97,"./info":99,"./pointer":100}],97:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.TextureDataContext=void 0;var u=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("../../utils"),l=e("../../../utils"),p=e("../../../scope"),d=e("../../../core"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.TextureDataContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,l.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new p.ScopedContext(e,{textureData:function(e,t){var n=(0,l.get)("data",[t,e]);if(n&&(0,s.isTextureDataReady)(n)){var r=(0,s.getTextureDataResolution)(n),o=u(r,2),i=o[0],a=o[1];if(i&&a)return n}return null}})))}return i(t,d.Component),c(t,null,[{key:"defaults",value:function(){return f({},y)}}]),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../../utils":115,"../defaults":101}],98:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./context");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./pointer");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./data");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./info");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./context":96,"./data":97,"./info":99,"./pointer":100}],99:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.TextureInfoContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../../utils"),l=e("../../../scope"),p=e("../../../core"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.TextureInfoContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,s.assignDefaults)(n,t.defaults());var i=n.uniformName;return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.ScopedContext(e,{textureUniformName:function(){return i},textureResolution:function(e){var t=e.textureData;return(0,c.getTextureDataResolution)(t)}})))}return i(t,p.Component),f(t,null,[{key:"defaults",value:function(){return u({},d)}}]),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../../utils":115,"../defaults":101}],100:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.TexturePointerContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../../utils"),s=e("../../../scope"),l=e("../../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),d=e("../../utils");n.TexturePointerContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,c.assignDefaults)(n,t.defaults());var i=e.regl.texture(u({},n.texture)),a=null;return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{texturePointer:function(e){var t=e.textureData;return t&&((0,d.isImage)(t)?t!=a&&(i(u({},n.texture,{data:t})),a=t):(0,d.isVideo)(t)&&(0,d.isTextureDataReady)(t)&&(i(u({},n.texture,{data:t})),a=t)),i}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../../utils":115,"../defaults":101}],101:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.uniformName="tex2d",n.texture={min:"linear",mag:"linear"}},{}],102:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./uniforms");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./context");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./texture");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},{"./context":98,"./texture":103,"./uniforms":104}],103:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Texture=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./uniforms"),s=e("./context"),l=e("../../utils"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),d=e("../../core");n.Texture=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,l.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.TextureContext(e,n),new c.TextureShaderUniforms(e,n)))}return i(t,d.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../utils":116,"./context":98,"./defaults":101,"./uniforms":104}],104:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.TextureShaderUniforms=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../shader"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.TextureShaderUniforms=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,c.assignDefaults)(n,t.defaults());var i=n.uniformName;return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ShaderUniforms(e,{prefix:i+"."},{resolution:function(e){return e.textureResolution},data:function(e){return e.texturePointer}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../shader":93,"../../utils":116,"./defaults":101}],105:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTextureContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../../utils"),s=e("../../../core"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults")),p=e("./pointer"),d=e("./data"),y=e("./info");n.CubeTextureContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,c.assignDefaults)(n,t.defaults()),n.uniformName,o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new d.CubeTextureDataContext(e,n),new p.CubeTexturePointerContext(e,n),new y.CubeTextureInfoContext(e,n)))}return i(t,s.Component),f(t,null,[{key:"defaults",value:function(){return u({},l)}}]),t}()},{"../../../core":50,"../../../utils":116,"../defaults":110,"./data":106,"./info":108,"./pointer":109}],106:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTextureDataContext=void 0;var f=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=e("../../../utils"),s=e("../../../scope"),l=e("../../../core"),p=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(e("../defaults")),e("../../utils"));n.CubeTextureDataContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,t),(0,c.assignDefaults)(n,CubeTexture.defaults()),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{cubeTextureData:function(e,t){var o=(0,c.get)("data",[t,e,n]);if(o&&Array.isArray(o)&&o.some(p.isCubeTextureDataReady)){var i=(0,p.getCubeTextureDataResolution)(o),a=f(i,2),u=a[0],s=a[1];if(u&&s)return[].concat(r(o))}return null}})))}return a(t,l.Component),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../../utils":115,"../defaults":110}],107:[function(e,t,n){arguments[4][98][0].apply(n,arguments)},{"./context":105,"./data":106,"./info":108,"./pointer":109,dup:98}],108:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTextureInfoContext=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../../utils"),l=e("../../../scope"),p=e("../../../core"),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../defaults"));n.CubeTextureInfoContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,s.assignDefaults)(n,CubeTextureContext.defaults());var i=n.uniformName;return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new l.ScopedContext(e,{cubeTextureUniformName:function(){return i},cubeTextureResolution:function(e){var t=e.cubeTextureData;return(0,c.getCubeTextureDataResolution)(t)}})))}return i(t,p.Component),f(t,null,[{key:"defaults",value:function(){return u({},d)}}]),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../../utils":115,"../defaults":110}],109:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":u(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":u(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTexturePointerContext=void 0;var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=e("../../../utils"),s=e("../../../scope"),l=e("../../../core"),p=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(e("../defaults")),e("../../utils"));n.CubeTexturePointerContext=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),(0,c.assignDefaults)(n,CubeTexture.defaults());var a=e.regl.cube(f({},n.texture)),u=Array(6).fill(null);return i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ScopedContext(e,{cubeTexturePointer:function(e){var t=e.cubeTextureData,n=!1;if(Array.isArray(t))for(var o=0;o<u.length;++o)u[o]!=t[o]&&(0,p.isCubeTextureDataReady)(t[[o]])&&(u[o]=t[o],n=!0);for(var i=(0,p.getCubeTextureDataResolution)(u),f=0;f<u.length;++f)null!=u[f]&&(0,p.isCubeTextureDataReady)(u[f])||(u[f]={shape:i});return n&&a.apply(void 0,r(u)),a}})))}return a(t,l.Component),t}()},{"../../../core":50,"../../../scope":90,"../../../utils":116,"../../utils":115,"../defaults":110}],110:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.uniformName="texCube",n.texture={min:"linear",mag:"linear"}},{}],111:[function(e,t,n){arguments[4][102][0].apply(n,arguments)},{"./context":107,"./texture":112,"./uniforms":113,dup:102}],112:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTexture=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("./uniforms"),s=e("./context"),l=e("../../utils"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults")),d=e("../../core");n.CubeTexture=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(this,t),(0,l.assignDefaults)(n,t.defaults()),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.CubeTextureContext(e,n),new c.CubeTextureShaderUniforms(e,n)))}return i(t,d.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../utils":116,"./context":107,"./defaults":110,"./uniforms":113}],113:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.CubeTextureShaderUniforms=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=e("../../utils"),s=e("../../shader"),l=e("../../core"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./defaults"));n.CubeTextureShaderUniforms=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),(0,c.assignDefaults)(n,CubeTextureUniforms.defaults());var i=n.uniformName;return o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,new s.ShaderUniforms(e,{prefix:i+"."},{resolution:function(e){return e.cubeTextureResolution},data:function(e){return e.cubeTexturePointer}})))}return i(t,l.Component),f(t,null,[{key:"defaults",value:function(){return u({},p)}}]),t}()},{"../../core":50,"../../shader":93,"../../utils":116,"./defaults":110}],114:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./cube");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=e("./2d");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},{"./2d":102,"./cube":111}],115:[function(e,t,n){"use strict";function r(e){return y(e)||p(e)?[e.width,e.height]:d(e)?[e.videoWidth||0,e.videoHeight||0]:e&&e.shape?e.shape:[0,0]}function o(e){return Array.isArray(e)?(e=e.filter(function(e){return e}).filter(function(e){return y(e)||d(e)||e.shape.every(Boolean)})[0],o(e)):y(e)||p(e)?[e.width,e.height]:d(e)?[e.videoWidth||0,e.videoHeight||0]:e&&e.shape?e.shape:[0,0]}Object.defineProperty(n,"__esModule",{value:!0}),n.isImage=n.isVideo=n.isCanvas=void 0,n.isTextureDataReady=function(e){var t=r(e);return!!(t[0]&&t[1]&&(d(e)&&e.readyState>=l||(y(e)||p(e))&&e.width&&e.height))},n.getTextureDataResolution=r,n.isCubeTextureDataReady=function(e){return!!(d(e)&&e.readyState>=l)||!(!y(e)&&!p(e)||!e.width||!e.height)},n.getCubeTextureDataResolution=o;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("global/window")),a=i.default.HTMLVideoElement,u=i.default.HTMLCanvasElement,f=i.default.HTMLImageElement,c=a||{},s=c.HAVE_ENOUGH_DATA,l=void 0===s?4:s,p=n.isCanvas=function(e){return e instanceof u},d=n.isVideo=function(e){return e instanceof a},y=n.isImage=function(e){return e instanceof f}},{"global/window":276}],116:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.isArrayLike=n.ensureRGB=n.ensureRGBA=n.clampToMaxSize=n.scaleWithCanvas=n.makePowerOfTwo=n.getScreenOrientation=n.createCanvas=n.nearestPowerOfTwo=n.get=n.assignDefaults=n.lerp=n.radians=n.debug=void 0;var a="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":i(e)},u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=r(e("debug")),c=r(e("global/document")),s=r(e("global/window")),l=r(e("clamp")),p=(r(e("clone")),Object.getPrototypeOf(Float32Array.prototype).constructor),d=s.default.HTMLImageElement,y=s.default.HTMLCanvasElement,m=(n.debug=(0,f.default)("[axis@0.2.1]"),n.radians=function(e){return e==e?e*Math.PI/180:0},n.lerp=function(e,t,n){return e*(1-n)+t*n},n.assignDefaults=function(e,t){return Object.assign(e,u({},t,e))},n.get=function(e,t){return(t.filter(function(e){return e}).find(function(t){return null!=t[e]})||{})[e]},n.nearestPowerOfTwo=function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}),h=n.createCanvas=function(){return c.default.createElementNS("http://www.w3.org/1999/xhtml","canvas")},b=(n.getScreenOrientation=function(){var e=null;switch("object"==a(s.default.screen)&&("object"==a(s.default.screen.orientation)?e=s.default.screen.orientation.type:"string"==typeof s.default.screen.orientation?e=s.default.screen.orientation:"object"==a(s.default.screen.mozOrientation)?e=s.default.screen.mozOrientation.type:"string"==typeof s.default.screen.mozOrientation&&(e=s.default.screen.mozOrientation)),e){case"landscape-primary":return 90;case"landscape-secondary":return-90;case"portrait-secondary":return 180;case"portrait-primary":return 0;default:return s.default.orientation||s.default.mozOrientation||0}},n.makePowerOfTwo=function(e){if(e instanceof d||e instanceof y){var t=h(),n=t.getContext("2d");return t.width=m(e.width),t.height=m(e.height),n.drawImage(e,0,0,t.width,t.height),t}return e}),v=n.scaleWithCanvas=function(e,t,n){var r=h(),o=r.getContext("2d"),i=e.width,a=e.height;return n&&(i=m(i),a=m(a)),r.width=Math.floor(e.width*t),r.height=Math.floor(e.height*t),o.drawImage(e,0,0,i,a,0,0,r.width,r.height),r},g=(n.clampToMaxSize=function(e,t,n){if(e.width>t||e.height>t){var r=t/Math.max(e.width,e.height);return v(e,r,n)}return n?b(e):e},n.ensureRGBA=function(e){e=[].concat(o(e||[]));for(var t=0;t<3;++t)"number"!=typeof e[t]?e[t]=0:e[t]=(0,l.default)(e[t],0,1);return"number"!=typeof e[3]?e[3]=1:e[3]=(0,l.default)(e[3],0,1),[].concat(o(e)).slice(0,4)});n.ensureRGB=function(e){return g(e).slice(0,3)},n.isArrayLike=function(e){return Boolean(e&&(Array.isArray(e)||e instanceof p||"number"==e.length||"function"==typeof e[Symbol.iterator]))}},{clamp:124,clone:125,debug:126,"global/document":275,"global/window":276}],117:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=(void 0===t?"undefined":a(t))&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.Viewport=void 0;var u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":a(e)},f=e("./core");n.Viewport=function(e){function t(e,n,i){var a;r(this,t);for(var f=arguments.length,c=Array(f>3?f-3:0),s=3;s<f;s++)c[s-3]=arguments[s];"function"==typeof i&&c.unshift(i),"function"==typeof n&&c.unshift(n),"object"!=(void 0===n?"undefined":u(n))&&(n={}),"object"!=(void 0===i?"undefined":u(i))&&(i=n);var l=e.regl({viewport:n.viewport});return o(this,(a=t.__proto__||Object.getPrototypeOf(t)).call.apply(a,[this,e,l].concat(c)))}return i(t,f.Component),t}()},{"./core":50}],118:[function(e,t,n){"use strict";function r(e,t,n){var r=o(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function o(e,t,n){var r,o,i,a,u,f=n.indexOf(e),c=n.indexOf(t,f+1),s=f;if(f>=0&&c>0){for(r=[],i=n.length;s<n.length&&s>=0&&!u;)s==f?(r.push(s),f=n.indexOf(e,s+1)):1==r.length?u=[r.pop(),c]:((o=r.pop())<i&&(i=o,a=c),c=n.indexOf(t,s+1)),s=f<c&&f>=0?f:c;r.length&&(u=[i,a])}return u}t.exports=r,r.range=o},{}],119:[function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function o(e){return a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e]}function i(e,t,n){for(var r,i=[],a=t;a<n;a+=3)r=(e[a]<<16)+(e[a+1]<<8)+e[a+2],i.push(o(r));return i.join("")}n.byteLength=function(e){return 3*e.length/4-r(e)},n.toByteArray=function(e){var t,n,o,i,a,c=e.length;i=r(e),a=new f(3*c/4-i),n=i>0?c-4:c;var s=0;for(t=0;t<n;t+=4)o=u[e.charCodeAt(t)]<<18|u[e.charCodeAt(t+1)]<<12|u[e.charCodeAt(t+2)]<<6|u[e.charCodeAt(t+3)],a[s++]=o>>16&255,a[s++]=o>>8&255,a[s++]=255&o;return 2===i?(o=u[e.charCodeAt(t)]<<2|u[e.charCodeAt(t+1)]>>4,a[s++]=255&o):1===i&&(o=u[e.charCodeAt(t)]<<10|u[e.charCodeAt(t+1)]<<4|u[e.charCodeAt(t+2)]>>2,a[s++]=o>>8&255,a[s++]=255&o),a},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o="",u=[],f=0,c=n-r;f<c;f+=16383)u.push(i(e,f,f+16383>c?c:f+16383));return 1===r?(t=e[n-1],o+=a[t>>2],o+=a[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=a[t>>10],o+=a[t>>4&63],o+=a[t<<2&63],o+="="),u.push(o),u.join("")};for(var a=[],u=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=c.length;s<l;++s)a[s]=c[s],u[c.charCodeAt(s)]=s;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},{}],120:[function(e,t,n){"use strict";t.exports=function(e){var t=e.length;if(0===t)return[[],[]];for(var n=e[0].length,r=e[0].slice(),o=e[0].slice(),i=1;i<t;++i)for(var a=e[i],u=0;u<n;++u){var f=a[u];r[u]=Math.min(r[u],f),o[u]=Math.max(o[u],f)}return[r,o]}},{}],121:[function(e,t,n){"use strict"},{}],122:[function(e,t,n){(function(t){"use strict";function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=i.prototype:(null===e&&(e=new i(t)),e.length=t),e}function i(e,t,n){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return a(this,e,t,n)}function a(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?p(e,t,n,r):"string"==typeof t?s(e,t,n):d(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t,n,r){return u(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}function c(e,t){if(u(t),e=o(e,t<0?0:0|y(t)),!i.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function s(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!i.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|m(t,n),a=(e=o(e,r)).write(t,n);return a!==r&&(e=e.slice(0,a)),e}function l(e,t){var n=t.length<0?0:0|y(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),i.TYPED_ARRAY_SUPPORT?(e=t).__proto__=i.prototype:e=l(e,t),e}function d(e,t){if(i.isBuffer(t)){var n=0|y(t.length);return 0===(e=o(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||W(t.length)?o(e,0):l(e,t);if("Buffer"===t.type&&Q(t.data))return l(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function m(e,t){if(i.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(e).length;default:if(r)return Y(e).length;t=(""+t).toLowerCase(),r=!0}}function h(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,n);case"utf8":case"utf-8":return A(this,t,n);case"ascii":return L(this,t,n);case"latin1":case"binary":return P(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function b(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=i.from(t,r)),i.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,o);if("number"==typeof t)return t&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,o){function i(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,u=e.length,f=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,u/=2,f/=2,n/=2}var c;if(o){var s=-1;for(c=n;c<u;c++)if(i(e,c)===i(t,-1===s?0:c-s)){if(-1===s&&(s=c),c-s+1===f)return s*a}else-1!==s&&(c-=c-s),s=-1}else for(n+f>u&&(n=u-f),c=n;c>=0;c--){for(var l=!0,p=0;p<f;p++)if(i(e,c+p)!==i(t,p)){l=!1;break}if(l)return c}return-1}function _(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var u=parseInt(t.substr(2*a,2),16);if(isNaN(u))return a;e[n+a]=u}return a}function w(e,t,n,r){return H(Y(t,e.length-n),e,n,r)}function O(e,t,n,r){return H(z(t),e,n,r)}function x(e,t,n,r){return O(e,t,n,r)}function S(e,t,n,r){return H(q(t),e,n,r)}function j(e,t,n,r){return H(X(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?K.fromByteArray(e):K.fromByteArray(e.slice(t,n))}function A(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i=e[o],a=null,u=i>239?4:i>223?3:i>191?2:1;if(o+u<=n){var f,c,s,l;switch(u){case 1:i<128&&(a=i);break;case 2:128==(192&(f=e[o+1]))&&(l=(31&i)<<6|63&f)>127&&(a=l);break;case 3:f=e[o+1],c=e[o+2],128==(192&f)&&128==(192&c)&&(l=(15&i)<<12|(63&f)<<6|63&c)>2047&&(l<55296||l>57343)&&(a=l);break;case 4:f=e[o+1],c=e[o+2],s=e[o+3],128==(192&f)&&128==(192&c)&&128==(192&s)&&(l=(15&i)<<18|(63&f)<<12|(63&c)<<6|63&s)>65535&&l<1114112&&(a=l)}}null===a?(a=65533,u=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),o+=u}return M(r)}function M(e){var t=e.length;if(t<=Z)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Z));return n}function L(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function T(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=U(e[i]);return o}function R(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function C(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,n,r,o,a){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function I(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function V(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function G(e,t,n,r,o){return o||V(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),$.write(e,t,n,r,23,4),n+4}function N(e,t,n,r,o){return o||V(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),$.write(e,t,n,r,52,8),n+8}function F(e){if((e=B(e).replace(J,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function B(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function Y(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function z(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function X(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}function q(e){return K.toByteArray(F(e))}function H(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function W(e){return e!==e}var K=e("base64-js"),$=e("ieee754"),Q=e("isarray");n.Buffer=i,n.SlowBuffer=function(e){return+e!=e&&(e=0),i.alloc(+e)},n.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),n.kMaxLength=r(),i.poolSize=8192,i._augment=function(e){return e.__proto__=i.prototype,e},i.from=function(e,t,n){return a(null,e,t,n)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(e,t,n){return f(null,e,t,n)},i.allocUnsafe=function(e){return c(null,e)},i.allocUnsafeSlow=function(e){return c(null,e)},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.compare=function(e,t){if(!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,a=Math.min(n,r);o<a;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return i.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=i.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!i.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},i.byteLength=m,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},i.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},i.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},i.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?A(this,0,e):h.apply(this,arguments)},i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===i.compare(this,e)},i.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},i.prototype.compare=function(e,t,n,r,o){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var a=o-r,u=n-t,f=Math.min(a,u),c=this.slice(r,o),s=e.slice(t,n),l=0;l<f;++l)if(c[l]!==s[l]){a=c[l],u=s[l];break}return a<u?-1:u<a?1:0},i.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},i.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},i.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},i.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return O(this,e,t,n);case"latin1":case"binary":return x(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;i.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(i.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=i.prototype;else{var o=t-e;r=new i(o,void 0);for(var a=0;a<o;++a)r[a]=this[a+e]}return r},i.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},i.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},i.prototype.readUInt8=function(e,t){return t||C(e,1,this.length),this[e]},i.prototype.readUInt16LE=function(e,t){return t||C(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUInt16BE=function(e,t){return t||C(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUInt32LE=function(e,t){return t||C(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUInt32BE=function(e,t){return t||C(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},i.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||C(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},i.prototype.readInt8=function(e,t){return t||C(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){t||C(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(e,t){t||C(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(e,t){return t||C(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return t||C(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readFloatLE=function(e,t){return t||C(e,4,this.length),$.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return t||C(e,4,this.length),$.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return t||C(e,8,this.length),$.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return t||C(e,8,this.length),$.read(this,e,!1,52,8)},i.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||k(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},i.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||k(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},i.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,255,0),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},i.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},i.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},i.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},i.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},i.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);k(this,e,t,n,o-1,-o)}var i=0,a=1,u=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+n},i.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);k(this,e,t,n,o-1,-o)}var i=n-1,a=1,u=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+n},i.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,127,-128),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},i.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},i.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},i.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},i.prototype.writeFloatLE=function(e,t,n){return G(this,e,t,!0,n)},i.prototype.writeFloatBE=function(e,t,n){return G(this,e,t,!1,n)},i.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},i.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},i.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,a=r-n;if(this===e&&n<t&&t<r)for(o=a-1;o>=0;--o)e[o+t]=this[o+n];else if(a<1e3||!i.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},i.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var a;if("number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var u=i.isBuffer(e)?e:Y(new i(e,r).toString()),f=u.length;for(a=0;a<n-t;++a)this[a+t]=u[a%f]}return this};var J=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":119,ieee754:289,isarray:123}],123:[function(e,t,n){"use strict";var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],124:[function(e,t,n){"use strict";t.exports=function(e,t,n){return t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e}},{}],125:[function(e,t,n){(function(e){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function t(e,t){return null!=t&&e instanceof t}function r(o,c,s,l,p){function d(o,s){if(null===o)return null;if(0===s)return o;var b,v;if("object"!=(void 0===o?"undefined":n(o)))return o;if(t(o,a))b=new a;else if(t(o,u))b=new u;else if(t(o,f))b=new f(function(e,t){o.then(function(t){e(d(t,s-1))},function(e){t(d(e,s-1))})});else if(r.__isArray(o))b=[];else if(r.__isRegExp(o))b=new RegExp(o.source,i(o)),o.lastIndex&&(b.lastIndex=o.lastIndex);else if(r.__isDate(o))b=new Date(o.getTime());else{if(h&&e.isBuffer(o))return b=new e(o.length),o.copy(b),b;t(o,Error)?b=Object.create(o):void 0===l?(v=Object.getPrototypeOf(o),b=Object.create(v)):(b=Object.create(l),v=l)}if(c){var g=y.indexOf(o);if(-1!=g)return m[g];y.push(o),m.push(b)}t(o,a)&&o.forEach(function(e,t){var n=d(t,s-1),r=d(e,s-1);b.set(n,r)}),t(o,u)&&o.forEach(function(e){var t=d(e,s-1);b.add(t)});for(var _ in o){var w;v&&(w=Object.getOwnPropertyDescriptor(v,_)),w&&null==w.set||(b[_]=d(o[_],s-1))}if(Object.getOwnPropertySymbols)for(var O=Object.getOwnPropertySymbols(o),_=0;_<O.length;_++){var x=O[_];(!(E=Object.getOwnPropertyDescriptor(o,x))||E.enumerable||p)&&(b[x]=d(o[x],s-1),E.enumerable||Object.defineProperty(b,x,{enumerable:!1}))}if(p)for(var S=Object.getOwnPropertyNames(o),_=0;_<S.length;_++){var j=S[_],E=Object.getOwnPropertyDescriptor(o,j);E&&E.enumerable||(b[j]=d(o[j],s-1),Object.defineProperty(b,j,{enumerable:!1}))}return b}"object"===(void 0===c?"undefined":n(c))&&(s=c.depth,l=c.prototype,p=c.includeNonEnumerable,c=c.circular);var y=[],m=[],h=void 0!==e;return void 0===c&&(c=!0),void 0===s&&(s=1/0),d(o,s)}function o(e){return Object.prototype.toString.call(e)}function i(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}var a;try{a=Map}catch(e){a=function(){}}var u;try{u=Set}catch(e){u=function(){}}var f;try{f=Promise}catch(e){f=function(){}}return r.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},r.__objToStr=o,r.__isDate=function(e){return"object"===(void 0===e?"undefined":n(e))&&"[object Date]"===o(e)},r.__isArray=function(e){return"object"===(void 0===e?"undefined":n(e))&&"[object Array]"===o(e)},r.__isRegExp=function(e){return"object"===(void 0===e?"undefined":n(e))&&"[object RegExp]"===o(e)},r.__getRegExpFlags=i,r}();"object"===(void 0===t?"undefined":n(t))&&t.exports&&(t.exports=r)}).call(this,e("buffer").Buffer)},{buffer:122}],126:[function(e,t,n){(function(r){"use strict";function o(){var e;try{e=n.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(n=t.exports=e("./debug")).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),t){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)}},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(e){}},n.load=o,n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},n.enable(o())}).call(this,e("_process"))},{"./debug":127,_process:296}],127:[function(e,t,n){"use strict";function r(e){var t,r=0;for(t in e)r=(r<<5)-r+e.charCodeAt(t),r|=0;return n.colors[Math.abs(r)%n.colors.length]}function o(e){function t(){if(t.enabled){var e=t,r=+new Date,o=r-(i||r);e.diff=o,e.prev=i,e.curr=r,i=r;for(var a=new Array(arguments.length),u=0;u<a.length;u++)a[u]=arguments[u];a[0]=n.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var f=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(t,r){if("%%"===t)return t;f++;var o=n.formatters[r];if("function"==typeof o){var i=a[f];t=o.call(e,i),a.splice(f,1),f--}return t}),n.formatArgs.call(e,a),(t.log||n.log||console.log.bind(console)).apply(e,a)}}return t.namespace=e,t.enabled=n.enabled(e),t.useColors=n.useColors(),t.color=r(e),"function"==typeof n.init&&n.init(t),t}(n=t.exports=o.debug=o.default=o).coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){n.save(e),n.names=[],n.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),r=t.length,o=0;o<r;o++)t[o]&&("-"===(e=t[o].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))},n.enabled=function(e){var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var i},{ms:291}],128:[function(e,t,n){"use strict";t.exports=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]}},{}],129:[function(e,t,n){"use strict";var r=e("synthetic-dom-events"),o=function(e,t,n,r){return e.addEventListener(t,n,r||!1)},i=function(e,t,n,r){return e.removeEventListener(t,n,r||!1)},a=function(e,t,n){var o=r(t,n);e.dispatchEvent(o)};document.addEventListener||(o=function(e,t,n){return e.attachEvent("on"+t,n)}),document.removeEventListener||(i=function(e,t,n){return e.detachEvent("on"+t,n)}),document.dispatchEvent||(a=function(e,t,n){var o=r(t,n);return e.fireEvent("on"+o.type,o)}),t.exports={on:o,off:i,once:function(e,t,n,r){function a(o){i(e,t,a,r),n(o)}o(e,t,a,r)},emit:a}},{"synthetic-dom-events":298}],130:[function(e,t,n){"use strict";function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function i(e){return"number"==typeof e}function a(e){return"object"===(void 0===e?"undefined":f(e))&&null!==e}function u(e){return void 0===e}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,f,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var s=new Error('Uncaught, unspecified "error" event. ('+t+")");throw s.context=t,s}if(n=this._events[e],u(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(a(n))for(i=Array.prototype.slice.call(arguments,1),r=(c=n.slice()).length,f=0;f<r;f++)c[f].apply(this,i);return!0},r.prototype.addListener=function(e,t){var n;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(n=u(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,i,u;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,r=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(u=i;u-- >0;)if(n[u]===t||n[u].listener&&n[u].listener===t){r=u;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],131:[function(e,t,n){"use strict";var r=e("gl-mat4/invert"),o=new Float32Array(16);t.exports=function(e,t){return t||(t=[]),r(o,e),t[0]=o[12],t[1]=o[13],t[2]=o[14],t}},{"gl-mat4/invert":161}],132:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],f=t[6],c=t[7],s=t[8];return e[0]=a*s-u*c,e[1]=o*c-r*s,e[2]=r*u-o*a,e[3]=u*f-i*s,e[4]=n*s-o*f,e[5]=o*i-n*u,e[6]=i*c-a*f,e[7]=r*f-n*c,e[8]=n*a-r*i,e}},{}],133:[function(e,t,n){"use strict";t.exports=function(e){var t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}},{}],134:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}},{}],135:[function(e,t,n){"use strict";t.exports=function(){var e=new Float32Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}},{}],136:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2],o=e[3],i=e[4],a=e[5],u=e[6],f=e[7],c=e[8];return t*(c*i-a*f)+n*(a*u-c*o)+r*(f*o-i*u)}},{}],137:[function(e,t,n){"use strict";t.exports=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8])}},{}],138:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}},{}],139:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}},{}],140:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=n+n,u=r+r,f=o+o,c=n*a,s=r*a,l=r*u,p=o*a,d=o*u,y=o*f,m=i*a,h=i*u,b=i*f;return e[0]=1-l-y,e[3]=s-b,e[6]=p+h,e[1]=s+b,e[4]=1-c-y,e[7]=d-m,e[2]=p-h,e[5]=d+m,e[8]=1-c-l,e}},{}],141:[function(e,t,n){"use strict";t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}},{}],142:[function(e,t,n){"use strict";t.exports={adjoint:e("./adjoint"),clone:e("./clone"),copy:e("./copy"),create:e("./create"),determinant:e("./determinant"),frob:e("./frob"),fromMat2:e("./from-mat2"),fromMat4:e("./from-mat4"),fromQuat:e("./from-quat"),identity:e("./identity"),invert:e("./invert"),multiply:e("./multiply"),normalFromMat4:e("./normal-from-mat4"),rotate:e("./rotate"),scale:e("./scale"),str:e("./str"),translate:e("./translate"),transpose:e("./transpose")}},{"./adjoint":132,"./clone":133,"./copy":134,"./create":135,"./determinant":136,"./frob":137,"./from-mat2":138,"./from-mat4":139,"./from-quat":140,"./identity":141,"./invert":143,"./multiply":144,"./normal-from-mat4":145,"./rotate":146,"./scale":147,"./str":148,"./translate":149,"./transpose":150}],143:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],f=t[6],c=t[7],s=t[8],l=s*a-u*c,p=-s*i+u*f,d=c*i-a*f,y=n*l+r*p+o*d;return y?(y=1/y,e[0]=l*y,e[1]=(-s*r+o*c)*y,e[2]=(u*r-o*a)*y,e[3]=p*y,e[4]=(s*n-o*f)*y,e[5]=(-u*n+o*i)*y,e[6]=d*y,e[7]=(-c*n+r*f)*y,e[8]=(a*n-r*i)*y,e):null}},{}],144:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],p=n[0],d=n[1],y=n[2],m=n[3],h=n[4],b=n[5],v=n[6],g=n[7],_=n[8];return e[0]=p*r+d*a+y*c,e[1]=p*o+d*u+y*s,e[2]=p*i+d*f+y*l,e[3]=m*r+h*a+b*c,e[4]=m*o+h*u+b*s,e[5]=m*i+h*f+b*l,e[6]=v*r+g*a+_*c,e[7]=v*o+g*u+_*s,e[8]=v*i+g*f+_*l,e}},{}],145:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],f=t[6],c=t[7],s=t[8],l=t[9],p=t[10],d=t[11],y=t[12],m=t[13],h=t[14],b=t[15],v=n*u-r*a,g=n*f-o*a,_=n*c-i*a,w=r*f-o*u,O=r*c-i*u,x=o*c-i*f,S=s*m-l*y,j=s*h-p*y,E=s*b-d*y,A=l*h-p*m,M=l*b-d*m,L=p*b-d*h,P=v*L-g*M+_*A+w*E-O*j+x*S;return P?(P=1/P,e[0]=(u*L-f*M+c*A)*P,e[1]=(f*E-a*L-c*j)*P,e[2]=(a*M-u*E+c*S)*P,e[3]=(o*M-r*L-i*A)*P,e[4]=(n*L-o*E+i*j)*P,e[5]=(r*E-n*M-i*S)*P,e[6]=(m*x-h*O+b*w)*P,e[7]=(h*_-y*x-b*g)*P,e[8]=(y*O-m*_+b*v)*P,e):null}},{}],146:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],p=Math.sin(n),d=Math.cos(n);return e[0]=d*r+p*a,e[1]=d*o+p*u,e[2]=d*i+p*f,e[3]=d*a-p*r,e[4]=d*u-p*o,e[5]=d*f-p*i,e[6]=c,e[7]=s,e[8]=l,e}},{}],147:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=n[0],o=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=o*t[3],e[4]=o*t[4],e[5]=o*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}},{}],148:[function(e,t,n){"use strict";t.exports=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}},{}],149:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],p=n[0],d=n[1];return e[0]=r,e[1]=o,e[2]=i,e[3]=a,e[4]=u,e[5]=f,e[6]=p*r+d*a+c,e[7]=p*o+d*u+s,e[8]=p*i+d*f+l,e}},{}],150:[function(e,t,n){"use strict";t.exports=function(e,t){if(e===t){var n=t[1],r=t[2],o=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=o}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}},{}],151:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],f=t[6],c=t[7],s=t[8],l=t[9],p=t[10],d=t[11],y=t[12],m=t[13],h=t[14],b=t[15];return e[0]=u*(p*b-d*h)-l*(f*b-c*h)+m*(f*d-c*p),e[1]=-(r*(p*b-d*h)-l*(o*b-i*h)+m*(o*d-i*p)),e[2]=r*(f*b-c*h)-u*(o*b-i*h)+m*(o*c-i*f),e[3]=-(r*(f*d-c*p)-u*(o*d-i*p)+l*(o*c-i*f)),e[4]=-(a*(p*b-d*h)-s*(f*b-c*h)+y*(f*d-c*p)),e[5]=n*(p*b-d*h)-s*(o*b-i*h)+y*(o*d-i*p),e[6]=-(n*(f*b-c*h)-a*(o*b-i*h)+y*(o*c-i*f)),e[7]=n*(f*d-c*p)-a*(o*d-i*p)+s*(o*c-i*f),e[8]=a*(l*b-d*m)-s*(u*b-c*m)+y*(u*d-c*l),e[9]=-(n*(l*b-d*m)-s*(r*b-i*m)+y*(r*d-i*l)),e[10]=n*(u*b-c*m)-a*(r*b-i*m)+y*(r*c-i*u),e[11]=-(n*(u*d-c*l)-a*(r*d-i*l)+s*(r*c-i*u)),e[12]=-(a*(l*h-p*m)-s*(u*h-f*m)+y*(u*p-f*l)),e[13]=n*(l*h-p*m)-s*(r*h-o*m)+y*(r*p-o*l),e[14]=-(n*(u*h-f*m)-a*(r*h-o*m)+y*(r*f-o*u)),e[15]=n*(u*p-f*l)-a*(r*p-o*l)+s*(r*f-o*u),e}},{}],152:[function(e,t,n){"use strict";t.exports=function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},{}],153:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],154:[function(e,t,n){"use strict";t.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],155:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2],o=e[3],i=e[4],a=e[5],u=e[6],f=e[7],c=e[8],s=e[9],l=e[10],p=e[11],d=e[12],y=e[13],m=e[14],h=e[15];return(t*a-n*i)*(l*h-p*m)-(t*u-r*i)*(s*h-p*y)+(t*f-o*i)*(s*m-l*y)+(n*u-r*a)*(c*h-p*d)-(n*f-o*a)*(c*m-l*d)+(r*f-o*u)*(c*y-s*d)}},{}],156:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=n+n,u=r+r,f=o+o,c=n*a,s=r*a,l=r*u,p=o*a,d=o*u,y=o*f,m=i*a,h=i*u,b=i*f;return e[0]=1-l-y,e[1]=s+b,e[2]=p-h,e[3]=0,e[4]=s-b,e[5]=1-c-y,e[6]=d+m,e[7]=0,e[8]=p+h,e[9]=d-m,e[10]=1-c-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],157:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=r+r,f=o+o,c=i+i,s=r*u,l=r*f,p=r*c,d=o*f,y=o*c,m=i*c,h=a*u,b=a*f,v=a*c;return e[0]=1-(d+m),e[1]=l+v,e[2]=p-b,e[3]=0,e[4]=l-v,e[5]=1-(s+m),e[6]=y+h,e[7]=0,e[8]=p+b,e[9]=y-h,e[10]=1-(s+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}},{}],158:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,o,i,a){var u=1/(n-t),f=1/(o-r),c=1/(i-a);return e[0]=2*i*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*f,e[6]=0,e[7]=0,e[8]=(n+t)*u,e[9]=(o+r)*f,e[10]=(a+i)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*i*2*c,e[15]=0,e}},{}],159:[function(e,t,n){"use strict";t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],160:[function(e,t,n){"use strict";t.exports={create:e("./create"),clone:e("./clone"),copy:e("./copy"),identity:e("./identity"),transpose:e("./transpose"),invert:e("./invert"),adjoint:e("./adjoint"),determinant:e("./determinant"),multiply:e("./multiply"),translate:e("./translate"),scale:e("./scale"),rotate:e("./rotate"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),fromRotationTranslation:e("./fromRotationTranslation"),fromQuat:e("./fromQuat"),frustum:e("./frustum"),perspective:e("./perspective"),perspectiveFromFieldOfView:e("./perspectiveFromFieldOfView"),ortho:e("./ortho"),lookAt:e("./lookAt"),str:e("./str")}},{"./adjoint":151,"./clone":152,"./copy":153,"./create":154,"./determinant":155,"./fromQuat":156,"./fromRotationTranslation":157,"./frustum":158,"./identity":159,"./invert":161,"./lookAt":162,"./multiply":163,"./ortho":164,"./perspective":165,"./perspectiveFromFieldOfView":166,"./rotate":167,"./rotateX":168,"./rotateY":169,"./rotateZ":170,"./scale":171,"./str":172,"./translate":173,"./transpose":174}],161:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],f=t[6],c=t[7],s=t[8],l=t[9],p=t[10],d=t[11],y=t[12],m=t[13],h=t[14],b=t[15],v=n*u-r*a,g=n*f-o*a,_=n*c-i*a,w=r*f-o*u,O=r*c-i*u,x=o*c-i*f,S=s*m-l*y,j=s*h-p*y,E=s*b-d*y,A=l*h-p*m,M=l*b-d*m,L=p*b-d*h,P=v*L-g*M+_*A+w*E-O*j+x*S;return P?(P=1/P,e[0]=(u*L-f*M+c*A)*P,e[1]=(o*M-r*L-i*A)*P,e[2]=(m*x-h*O+b*w)*P,e[3]=(p*O-l*x-d*w)*P,e[4]=(f*E-a*L-c*j)*P,e[5]=(n*L-o*E+i*j)*P,e[6]=(h*_-y*x-b*g)*P,e[7]=(s*x-p*_+d*g)*P,e[8]=(a*M-u*E+c*S)*P,e[9]=(r*E-n*M-i*S)*P,e[10]=(y*O-m*_+b*v)*P,e[11]=(l*_-s*O-d*v)*P,e[12]=(u*j-a*A-f*S)*P,e[13]=(n*A-r*j+o*S)*P,e[14]=(m*g-y*w-h*v)*P,e[15]=(s*w-l*g+p*v)*P,e):null}},{}],162:[function(e,t,n){"use strict";var r=e("./identity");t.exports=function(e,t,n,o){var i,a,u,f,c,s,l,p,d,y,m=t[0],h=t[1],b=t[2],v=o[0],g=o[1],_=o[2],w=n[0],O=n[1],x=n[2];return Math.abs(m-w)<1e-6&&Math.abs(h-O)<1e-6&&Math.abs(b-x)<1e-6?r(e):(l=m-w,p=h-O,d=b-x,y=1/Math.sqrt(l*l+p*p+d*d),l*=y,p*=y,d*=y,i=g*d-_*p,a=_*l-v*d,u=v*p-g*l,(y=Math.sqrt(i*i+a*a+u*u))?(i*=y=1/y,a*=y,u*=y):(i=0,a=0,u=0),f=p*u-d*a,c=d*i-l*u,s=l*a-p*i,(y=Math.sqrt(f*f+c*c+s*s))?(f*=y=1/y,c*=y,s*=y):(f=0,c=0,s=0),e[0]=i,e[1]=f,e[2]=l,e[3]=0,e[4]=a,e[5]=c,e[6]=p,e[7]=0,e[8]=u,e[9]=s,e[10]=d,e[11]=0,e[12]=-(i*m+a*h+u*b),e[13]=-(f*m+c*h+s*b),e[14]=-(l*m+p*h+d*b),e[15]=1,e)}},{"./identity":159}],163:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],p=t[9],d=t[10],y=t[11],m=t[12],h=t[13],b=t[14],v=t[15],g=n[0],_=n[1],w=n[2],O=n[3];return e[0]=g*r+_*u+w*l+O*m,e[1]=g*o+_*f+w*p+O*h,e[2]=g*i+_*c+w*d+O*b,e[3]=g*a+_*s+w*y+O*v,g=n[4],_=n[5],w=n[6],O=n[7],e[4]=g*r+_*u+w*l+O*m,e[5]=g*o+_*f+w*p+O*h,e[6]=g*i+_*c+w*d+O*b,e[7]=g*a+_*s+w*y+O*v,g=n[8],_=n[9],w=n[10],O=n[11],e[8]=g*r+_*u+w*l+O*m,e[9]=g*o+_*f+w*p+O*h,e[10]=g*i+_*c+w*d+O*b,e[11]=g*a+_*s+w*y+O*v,g=n[12],_=n[13],w=n[14],O=n[15],e[12]=g*r+_*u+w*l+O*m,e[13]=g*o+_*f+w*p+O*h,e[14]=g*i+_*c+w*d+O*b,e[15]=g*a+_*s+w*y+O*v,e}},{}],164:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,o,i,a){var u=1/(t-n),f=1/(r-o),c=1/(i-a);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*u,e[13]=(o+r)*f,e[14]=(a+i)*c,e[15]=1,e}},{}],165:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,o){var i=1/Math.tan(t/2),a=1/(r-o);return e[0]=i/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(o+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*o*r*a,e[15]=0,e}},{}],166:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),f=2/(a+u),c=2/(o+i);return e[0]=f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-u)*f*.5,e[9]=(o-i)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}},{}],167:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o,i,a,u,f,c,s,l,p,d,y,m,h,b,v,g,_,w,O,x,S,j,E,A,M=r[0],L=r[1],P=r[2],T=Math.sqrt(M*M+L*L+P*P);return Math.abs(T)<1e-6?null:(T=1/T,M*=T,L*=T,P*=T,o=Math.sin(n),i=Math.cos(n),a=1-i,u=t[0],f=t[1],c=t[2],s=t[3],l=t[4],p=t[5],d=t[6],y=t[7],m=t[8],h=t[9],b=t[10],v=t[11],g=M*M*a+i,_=L*M*a+P*o,w=P*M*a-L*o,O=M*L*a-P*o,x=L*L*a+i,S=P*L*a+M*o,j=M*P*a+L*o,E=L*P*a-M*o,A=P*P*a+i,e[0]=u*g+l*_+m*w,e[1]=f*g+p*_+h*w,e[2]=c*g+d*_+b*w,e[3]=s*g+y*_+v*w,e[4]=u*O+l*x+m*S,e[5]=f*O+p*x+h*S,e[6]=c*O+d*x+b*S,e[7]=s*O+y*x+v*S,e[8]=u*j+l*E+m*A,e[9]=f*j+p*E+h*A,e[10]=c*j+d*E+b*A,e[11]=s*j+y*E+v*A,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}},{}],168:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=Math.sin(n),o=Math.cos(n),i=t[4],a=t[5],u=t[6],f=t[7],c=t[8],s=t[9],l=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*o+c*r,e[5]=a*o+s*r,e[6]=u*o+l*r,e[7]=f*o+p*r,e[8]=c*o-i*r,e[9]=s*o-a*r,e[10]=l*o-u*r,e[11]=p*o-f*r,e}},{}],169:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=Math.sin(n),o=Math.cos(n),i=t[0],a=t[1],u=t[2],f=t[3],c=t[8],s=t[9],l=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o-c*r,e[1]=a*o-s*r,e[2]=u*o-l*r,e[3]=f*o-p*r,e[8]=i*r+c*o,e[9]=a*r+s*o,e[10]=u*r+l*o,e[11]=f*r+p*o,e}},{}],170:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=Math.sin(n),o=Math.cos(n),i=t[0],a=t[1],u=t[2],f=t[3],c=t[4],s=t[5],l=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o+c*r,e[1]=a*o+s*r,e[2]=u*o+l*r,e[3]=f*o+p*r,e[4]=c*o-i*r,e[5]=s*o-a*r,e[6]=l*o-u*r,e[7]=p*o-f*r,e}},{}],171:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=n[0],o=n[1],i=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],172:[function(e,t,n){"use strict";t.exports=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}},{}],173:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r,o,i,a,u,f,c,s,l,p,d,y,m=n[0],h=n[1],b=n[2];return t===e?(e[12]=t[0]*m+t[4]*h+t[8]*b+t[12],e[13]=t[1]*m+t[5]*h+t[9]*b+t[13],e[14]=t[2]*m+t[6]*h+t[10]*b+t[14],e[15]=t[3]*m+t[7]*h+t[11]*b+t[15]):(r=t[0],o=t[1],i=t[2],a=t[3],u=t[4],f=t[5],c=t[6],s=t[7],l=t[8],p=t[9],d=t[10],y=t[11],e[0]=r,e[1]=o,e[2]=i,e[3]=a,e[4]=u,e[5]=f,e[6]=c,e[7]=s,e[8]=l,e[9]=p,e[10]=d,e[11]=y,e[12]=r*m+u*h+l*b+t[12],e[13]=o*m+f*h+p*b+t[13],e[14]=i*m+c*h+d*b+t[14],e[15]=a*m+s*h+y*b+t[15]),e}},{}],174:[function(e,t,n){"use strict";t.exports=function(e,t){if(e===t){var n=t[1],r=t[2],o=t[3],i=t[6],a=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=i,e[11]=t[14],e[12]=o,e[13]=a,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}},{}],175:[function(e,t,n){"use strict";t.exports=e("gl-vec4/add")},{"gl-vec4/add":264}],176:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2];return e[0]=n,e[1]=r,e[2]=o,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o)),e}},{}],177:[function(e,t,n){"use strict";t.exports=e("gl-vec4/clone")},{"gl-vec4/clone":265}],178:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}},{}],179:[function(e,t,n){"use strict";t.exports=e("gl-vec4/copy")},{"gl-vec4/copy":266}],180:[function(e,t,n){"use strict";t.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}},{}],181:[function(e,t,n){"use strict";t.exports=e("gl-vec4/dot")},{"gl-vec4/dot":267}],182:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var o=0;t[4]>t[0]&&(o=1),t[8]>t[3*o+o]&&(o=2);var i=(o+1)%3,a=(o+2)%3;n=Math.sqrt(t[3*o+o]-t[3*i+i]-t[3*a+a]+1),e[o]=.5*n,n=.5/n,e[3]=(t[3*i+a]-t[3*a+i])*n,e[i]=(t[3*i+o]+t[3*o+i])*n,e[a]=(t[3*a+o]+t[3*o+a])*n}return e}},{}],183:[function(e,t,n){"use strict";t.exports=e("gl-vec4/fromValues")},{"gl-vec4/fromValues":268}],184:[function(e,t,n){"use strict";t.exports=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}},{}],185:[function(e,t,n){"use strict";t.exports={add:e("./add"),calculateW:e("./calculateW"),clone:e("./clone"),conjugate:e("./conjugate"),copy:e("./copy"),create:e("./create"),dot:e("./dot"),fromMat3:e("./fromMat3"),fromValues:e("./fromValues"),identity:e("./identity"),invert:e("./invert"),length:e("./length"),lerp:e("./lerp"),multiply:e("./multiply"),normalize:e("./normalize"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),rotationTo:e("./rotationTo"),scale:e("./scale"),set:e("./set"),setAxes:e("./setAxes"),setAxisAngle:e("./setAxisAngle"),slerp:e("./slerp"),sqlerp:e("./sqlerp"),squaredLength:e("./squaredLength")}},{"./add":175,"./calculateW":176,"./clone":177,"./conjugate":178,"./copy":179,"./create":180,"./dot":181,"./fromMat3":182,"./fromValues":183,"./identity":184,"./invert":186,"./length":187,"./lerp":188,"./multiply":189,"./normalize":190,"./rotateX":191,"./rotateY":192,"./rotateZ":193,"./rotationTo":194,"./scale":195,"./set":196,"./setAxes":197,"./setAxisAngle":198,"./slerp":199,"./sqlerp":200,"./squaredLength":201}],186:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=n*n+r*r+o*o+i*i,u=a?1/a:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-o*u,e[3]=i*u,e}},{}],187:[function(e,t,n){"use strict";t.exports=e("gl-vec4/length")},{"gl-vec4/length":269}],188:[function(e,t,n){"use strict";t.exports=e("gl-vec4/lerp")},{"gl-vec4/lerp":270}],189:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=t[3],u=n[0],f=n[1],c=n[2],s=n[3];return e[0]=r*s+a*u+o*c-i*f,e[1]=o*s+a*f+i*u-r*c,e[2]=i*s+a*c+r*f-o*u,e[3]=a*s-r*u-o*f-i*c,e}},{}],190:[function(e,t,n){"use strict";t.exports=e("gl-vec4/normalize")},{"gl-vec4/normalize":271}],191:[function(e,t,n){"use strict";t.exports=function(e,t,n){n*=.5;var r=t[0],o=t[1],i=t[2],a=t[3],u=Math.sin(n),f=Math.cos(n);return e[0]=r*f+a*u,e[1]=o*f+i*u,e[2]=i*f-o*u,e[3]=a*f-r*u,e}},{}],192:[function(e,t,n){"use strict";t.exports=function(e,t,n){n*=.5;var r=t[0],o=t[1],i=t[2],a=t[3],u=Math.sin(n),f=Math.cos(n);return e[0]=r*f-i*u,e[1]=o*f+a*u,e[2]=i*f+r*u,e[3]=a*f-o*u,e}},{}],193:[function(e,t,n){"use strict";t.exports=function(e,t,n){n*=.5;var r=t[0],o=t[1],i=t[2],a=t[3],u=Math.sin(n),f=Math.cos(n);return e[0]=r*f+o*u,e[1]=o*f-r*u,e[2]=i*f+a*u,e[3]=a*f-i*u,e}},{}],194:[function(e,t,n){"use strict";var r=e("gl-vec3/dot"),o=e("gl-vec3/cross"),i=e("gl-vec3/length"),a=e("gl-vec3/normalize"),u=e("./normalize"),f=e("./setAxisAngle");t.exports=function(e,t,n){var p=r(t,n);return p<-.999999?(o(c,s,t),i(c)<1e-6&&o(c,l,t),a(c,c),f(e,c,Math.PI),e):p>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(o(c,t,n),e[0]=c[0],e[1]=c[1],e[2]=c[2],e[3]=1+p,u(e,e))};var c=[0,0,0],s=[1,0,0],l=[0,1,0]},{"./normalize":190,"./setAxisAngle":198,"gl-vec3/cross":236,"gl-vec3/dot":239,"gl-vec3/length":244,"gl-vec3/normalize":250}],195:[function(e,t,n){"use strict";t.exports=e("gl-vec4/scale")},{"gl-vec4/scale":272}],196:[function(e,t,n){"use strict";t.exports=e("gl-vec4/set")},{"gl-vec4/set":273}],197:[function(e,t,n){"use strict";var r=e("gl-mat3/create"),o=e("./fromMat3"),i=e("./normalize");t.exports=function(e,t,n,r){return a[0]=n[0],a[3]=n[1],a[6]=n[2],a[1]=r[0],a[4]=r[1],a[7]=r[2],a[2]=-t[0],a[5]=-t[1],a[8]=-t[2],i(e,o(e,a))};var a=r()},{"./fromMat3":182,"./normalize":190,"gl-mat3/create":135}],198:[function(e,t,n){"use strict";t.exports=function(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}},{}],199:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o,i,a,u,f,c=t[0],s=t[1],l=t[2],p=t[3],d=n[0],y=n[1],m=n[2],h=n[3];return(i=c*d+s*y+l*m+p*h)<0&&(i=-i,d=-d,y=-y,m=-m,h=-h),1-i>1e-6?(o=Math.acos(i),a=Math.sin(o),u=Math.sin((1-r)*o)/a,f=Math.sin(r*o)/a):(u=1-r,f=r),e[0]=u*c+f*d,e[1]=u*s+f*y,e[2]=u*l+f*m,e[3]=u*p+f*h,e}},{}],200:[function(e,t,n){"use strict";var r=e("./slerp");t.exports=function(e,t,n,a,u,f){return r(o,t,u,f),r(i,n,a,f),r(e,o,i,2*f*(1-f)),e};var o=[0,0,0,1],i=[0,0,0,1]},{"./slerp":199}],201:[function(e,t,n){"use strict";t.exports=e("gl-vec4/squaredLength")},{"gl-vec4/squaredLength":274}],202:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}},{}],203:[function(e,t,n){"use strict";t.exports=function(e){var t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t}},{}],204:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e}},{}],205:[function(e,t,n){"use strict";t.exports=function(){var e=new Float32Array(2);return e[0]=0,e[1]=0,e}},{}],206:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}},{}],207:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}},{}],208:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}},{}],209:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]}},{}],210:[function(e,t,n){"use strict";t.exports=function(e,t,n,o,i,a){var u,f;for(t||(t=2),n||(n=0),f=o?Math.min(o*t+n,e.length):e.length,u=n;u<f;u+=t)r[0]=e[u],r[1]=e[u+1],i(r,r,a),e[u]=r[0],e[u+1]=r[1];return e};var r=e("./create")()},{"./create":205}],211:[function(e,t,n){"use strict";t.exports=function(e,t){var n=new Float32Array(2);return n[0]=e,n[1]=t,n}},{}],212:[function(e,t,n){"use strict";t.exports={create:e("./create"),clone:e("./clone"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat2:e("./transformMat2"),transformMat2d:e("./transformMat2d"),transformMat3:e("./transformMat3"),transformMat4:e("./transformMat4"),forEach:e("./forEach")}},{"./add":202,"./clone":203,"./copy":204,"./create":205,"./cross":206,"./distance":207,"./divide":208,"./dot":209,"./forEach":210,"./fromValues":211,"./length":213,"./lerp":214,"./max":215,"./min":216,"./multiply":217,"./negate":218,"./normalize":219,"./random":220,"./scale":221,"./scaleAndAdd":222,"./set":223,"./squaredDistance":224,"./squaredLength":225,"./subtract":226,"./transformMat2":227,"./transformMat2d":228,"./transformMat3":229,"./transformMat4":230}],213:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)}},{}],214:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o=t[0],i=t[1];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e}},{}],215:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}},{}],216:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}},{}],217:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}},{}],218:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e}},{}],219:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=n*n+r*r;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o),e}},{}],220:[function(e,t,n){"use strict";t.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}},{}],221:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}},{}],222:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}},{}],223:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t,e[1]=n,e}},{}],224:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}},{}],225:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1];return t*t+n*n}},{}],226:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}},{}],227:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[2]*o,e[1]=n[1]*r+n[3]*o,e}},{}],228:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[2]*o+n[4],e[1]=n[1]*r+n[3]*o+n[5],e}},{}],229:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[3]*o+n[6],e[1]=n[1]*r+n[4]*o+n[7],e}},{}],230:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1];return e[0]=n[0]*r+n[4]*o+n[12],e[1]=n[1]*r+n[5]*o+n[13],e}},{}],231:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},{}],232:[function(e,t,n){"use strict";t.exports=function(e,t){var n=r(e[0],e[1],e[2]),a=r(t[0],t[1],t[2]);o(n,n),o(a,a);var u=i(n,a);return u>1?0:Math.acos(u)};var r=e("./fromValues"),o=e("./normalize"),i=e("./dot")},{"./dot":239,"./fromValues":241,"./normalize":250}],233:[function(e,t,n){"use strict";t.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},{}],234:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{}],235:[function(e,t,n){"use strict";t.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],236:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=n[0],u=n[1],f=n[2];return e[0]=o*f-i*u,e[1]=i*a-r*f,e[2]=r*u-o*a,e}},{}],237:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(n*n+r*r+o*o)}},{}],238:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}},{}],239:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],240:[function(e,t,n){"use strict";t.exports=function(e,t,n,o,i,a){var u,f;for(t||(t=3),n||(n=0),f=o?Math.min(o*t+n,e.length):e.length,u=n;u<f;u+=t)r[0]=e[u],r[1]=e[u+1],r[2]=e[u+2],i(r,r,a),e[u]=r[0],e[u+1]=r[1],e[u+2]=r[2];return e};var r=e("./create")()},{"./create":235}],241:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}},{}],242:[function(e,t,n){"use strict";t.exports={create:e("./create"),clone:e("./clone"),angle:e("./angle"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformMat3:e("./transformMat3"),transformQuat:e("./transformQuat"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),forEach:e("./forEach")}},{"./add":231,"./angle":232,"./clone":233,"./copy":234,"./create":235,"./cross":236,"./distance":237,"./divide":238,"./dot":239,"./forEach":240,"./fromValues":241,"./inverse":243,"./length":244,"./lerp":245,"./max":246,"./min":247,"./multiply":248,"./negate":249,"./normalize":250,"./random":251,"./rotateX":252,"./rotateY":253,"./rotateZ":254,"./scale":255,"./scaleAndAdd":256,"./set":257,"./squaredDistance":258,"./squaredLength":259,"./subtract":260,"./transformMat3":261,"./transformMat4":262,"./transformQuat":263}],243:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},{}],244:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}},{}],245:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o=t[0],i=t[1],a=t[2];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e[2]=a+r*(n[2]-a),e}},{}],246:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}},{}],247:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}},{}],248:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}},{}],249:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},{}],250:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=n*n+r*r+o*o;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i),e}},{}],251:[function(e,t,n){"use strict";t.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,o=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=r*t,e}},{}],252:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o=[],i=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[0],i[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),i[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}},{}],253:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o=[],i=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),i[1]=o[1],i[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}},{}],254:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o=[],i=[];return o[0]=t[0]-n[0],o[1]=t[1]-n[1],o[2]=t[2]-n[2],i[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),i[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),i[2]=o[2],e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}},{}],255:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}},{}],256:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}},{}],257:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}},{}],258:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return n*n+r*r+o*o}},{}],259:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}},{}],260:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}},{}],261:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2];return e[0]=r*n[0]+o*n[3]+i*n[6],e[1]=r*n[1]+o*n[4]+i*n[7],e[2]=r*n[2]+o*n[5]+i*n[8],e}},{}],262:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=n[3]*r+n[7]*o+n[11]*i+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/a,e[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/a,e[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/a,e}},{}],263:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=t[0],o=t[1],i=t[2],a=n[0],u=n[1],f=n[2],c=n[3],s=c*r+u*i-f*o,l=c*o+f*r-a*i,p=c*i+a*o-u*r,d=-a*r-u*o-f*i;return e[0]=s*c+d*-a+l*-f-p*-u,e[1]=l*c+d*-u+p*-a-s*-f,e[2]=p*c+d*-f+s*-u-l*-a,e}},{}],264:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}},{}],265:[function(e,t,n){"use strict";t.exports=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}},{}],266:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}},{}],267:[function(e,t,n){"use strict";t.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{}],268:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o=new Float32Array(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=r,o}},{}],269:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2],o=e[3];return Math.sqrt(t*t+n*n+r*r+o*o)}},{}],270:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o=t[0],i=t[1],a=t[2],u=t[3];return e[0]=o+r*(n[0]-o),e[1]=i+r*(n[1]-i),e[2]=a+r*(n[2]-a),e[3]=u+r*(n[3]-u),e}},{}],271:[function(e,t,n){"use strict";t.exports=function(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=n*n+r*r+o*o+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=n*a,e[1]=r*a,e[2]=o*a,e[3]=i*a),e}},{}],272:[function(e,t,n){"use strict";t.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}},{}],273:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,o){return e[0]=t,e[1]=n,e[2]=r,e[3]=o,e}},{}],274:[function(e,t,n){"use strict";t.exports=function(e){var t=e[0],n=e[1],r=e[2],o=e[3];return t*t+n*n+r*r+o*o}},{}],275:[function(e,t,n){(function(n){"use strict";var r,o=void 0!==n?n:"undefined"!=typeof window?window:{},i=e("min-document");"undefined"!=typeof document?r=document:(r=o["__GLOBAL_DOCUMENT_CACHE@4"])||(r=o["__GLOBAL_DOCUMENT_CACHE@4"]=i),t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":121}],276:[function(e,t,n){(function(e){"use strict";var n;n="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],277:[function(e,t,n){"use strict";var r=e("glsl-tokenizer"),o=e("glsl-token-string"),i=e("glsl-token-inject-block");t.exports=function(e,t){if(!t)return e;var n=Object.keys(t);if(0===n.length)return e;for(var a=r(e),u=n.length-1;u>=0;u--){var f=n[u],c=String(t[f]);c&&(c=" "+c),i(a,{type:"preprocessor",data:"#define "+f+c})}return o(a)}},{"glsl-token-inject-block":279,"glsl-token-string":280,"glsl-tokenizer":287}],278:[function(e,t,n){"use strict";t.exports=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];if("preprocessor"===r.type){var o=r.data.trim();if(!o.indexOf("#define")){var i=o.match(/#define\s+([^\s]+)(.+)?$/i);if(i){var a=(i[1]||"").trim(),u=(i[2]||"").trim();t[a]=u}}}}return t}},{}],279:[function(e,t,n){"use strict";function r(e){for(var t=-1,n=0;n<e.length;n++){var r=e[n];if("preprocessor"===r.type)/^#(extension|version)/.test(r.data)&&(t=Math.max(t,n));else if("keyword"===r.type&&"precision"===r.data){var i=o(e,n);if(-1===i)throw new Error("precision statement not followed by any semicolons!");t=Math.max(t,i)}}return t+1}function o(e,t){for(var n=t;n<e.length;n++)if("operator"===e[n].type&&";"===e[n].data)return n;return-1}t.exports=function(e,t){Array.isArray(t)||(t=[t]);var n=r(e),o=n>0?e[n-1]:null;o&&a.test(o.data)&&e.splice(n++,0,i),e.splice.apply(e,[n,0].concat(t));var u=n+t.length;return e[u]&&/[^\r\n]$/.test(e[u].data)&&e.splice(u,0,i),e};var i={data:"\n",type:"whitespace"},a=/[^\r\n]$/},{}],280:[function(e,t,n){"use strict";t.exports=function(e){for(var t=[],n=0;n<e.length;n++)"eof"!==e[n].type&&t.push(e[n].data);return t.join("")}},{}],281:[function(e,t,n){"use strict";t.exports=function(e){function t(e){e.length&&U.push({type:O[F],data:e,position:X,line:Y,column:z})}function n(e){G=0,V=(W+=e).length;for(var t;I=W[G],G<V;){switch(t=G,F){case s:G=M();break;case l:G=A();break;case p:G=E();break;case d:G=L();break;case y:G=R();break;case w:G=T();break;case m:G=C();break;case c:G=k();break;case g:G=j();break;case f:G=S()}if(t!==G)switch(W[t]){case"\n":z=0,++Y;break;default:++z}}return N+=G,W=W.slice(G),U}function x(e){return B.length&&t(B.join("")),F=_,t("(eof)"),U}function S(){return B=B.length?[]:B,"/"===D&&"*"===I?(X=N+G-1,F=s,D=I,G+1):"/"===D&&"/"===I?(X=N+G-1,F=l,D=I,G+1):"#"===I?(F=p,X=N+G,G):/\s/.test(I)?(F=g,X=N+G,G):(q=/\d/.test(I),H=/[^\w_]/.test(I),X=N+G,F=q?y:H?d:c,G)}function j(){return/[^\s]/g.test(I)?(t(B.join("")),F=f,G):(B.push(I),D=I,G+1)}function E(){return"\r"!==I&&"\n"!==I||"\\"===D?(B.push(I),D=I,G+1):(t(B.join("")),F=f,G)}function A(){return E()}function M(){return"/"===I&&"*"===D?(B.push(I),t(B.join("")),F=f,G+1):(B.push(I),D=I,G+1)}function L(){if("."===D&&/\d/.test(I))return F=m,G;if("/"===D&&"*"===I)return F=s,G;if("/"===D&&"/"===I)return F=l,G;if("."===I&&B.length){for(;P(B););return F=m,G}if(";"===I||")"===I||"("===I){if(B.length)for(;P(B););return t(I),F=f,G+1}var e=2===B.length&&"="!==I;if(/[\w_\d\s]/.test(I)||e){for(;P(B););return F=f,G}return B.push(I),D=I,G+1}function P(e){for(var n,r,i=0;;){if(n=o.indexOf(e.slice(0,e.length+i).join("")),r=o[n],-1===n){if(i--+e.length>0)continue;r=e.slice(0,1).join("")}return t(r),X+=r.length,(B=B.slice(r.length)).length}}function T(){return/[^a-fA-F0-9]/.test(I)?(t(B.join("")),F=f,G):(B.push(I),D=I,G+1)}function R(){return"."===I?(B.push(I),F=m,D=I,G+1):/[eE]/.test(I)?(B.push(I),F=m,D=I,G+1):"x"===I&&1===B.length&&"0"===B[0]?(F=w,B.push(I),D=I,G+1):/[^\d]/.test(I)?(t(B.join("")),F=f,G):(B.push(I),D=I,G+1)}function C(){return"f"===I&&(B.push(I),D=I,G+=1),/[eE]/.test(I)?(B.push(I),D=I,G+1):"-"===I&&/[eE]/.test(D)?(B.push(I),D=I,G+1):/[^\d]/.test(I)?(t(B.join("")),F=f,G):(B.push(I),D=I,G+1)}function k(){if(/[^\d\w_]/.test(I)){var e=B.join("");return F=$.indexOf(e)>-1?v:K.indexOf(e)>-1?b:h,t(B.join("")),F=f,G}return B.push(I),D=I,G+1}var I,D,V,G=0,N=0,F=f,B=[],U=[],Y=1,z=0,X=0,q=!1,H=!1,W="",K=i,$=r;return"300 es"===(e=e||{}).version&&(K=u,$=a),function(e){return U=[],null!==e?n(e.replace?e.replace(/\r\n/g,"\n"):e):x()}};var r=e("./lib/literals"),o=e("./lib/operators"),i=e("./lib/builtins"),a=e("./lib/literals-300es"),u=e("./lib/builtins-300es"),f=999,c=9999,s=0,l=1,p=2,d=3,y=4,m=5,h=6,b=7,v=8,g=9,_=10,w=11,O=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":283,"./lib/builtins-300es":282,"./lib/literals":285,"./lib/literals-300es":284,"./lib/operators":286}],282:[function(e,t,n){"use strict";var r=e("./builtins");r=r.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),t.exports=r.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":283}],283:[function(e,t,n){"use strict";t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],284:[function(e,t,n){"use strict";var r=e("./literals");t.exports=r.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":285}],285:[function(e,t,n){"use strict";t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],286:[function(e,t,n){"use strict";t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],287:[function(e,t,n){"use strict";var r=e("./index");t.exports=function(e,t){var n=r(t),o=[];return o=o.concat(n(e)),o=o.concat(n(null))}},{"./index":281}],288:[function(e,t,n){"use strict";t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")}},{}],289:[function(e,t,n){"use strict";n.read=function(e,t,n,r,o){var i,a,u=8*o-r-1,f=(1<<u)-1,c=f>>1,s=-7,l=n?o-1:0,p=n?-1:1,d=e[t+l];for(l+=p,i=d&(1<<-s)-1,d>>=-s,s+=u;s>0;i=256*i+e[t+l],l+=p,s-=8);for(a=i&(1<<-s)-1,i>>=-s,s+=r;s>0;a=256*a+e[t+l],l+=p,s-=8);if(0===i)i=1-c;else{if(i===f)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),i-=c}return(d?-1:1)*a*Math.pow(2,i-r)},n.write=function(e,t,n,r,o,i){var a,u,f,c=8*i-o-1,s=(1<<c)-1,l=s>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,y=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=s):(a=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-a))<1&&(a--,f*=2),(t+=a+l>=1?p/f:p*Math.pow(2,1-l))*f>=2&&(a++,f/=2),a+l>=s?(u=0,a=s):a+l>=1?(u=(t*f-1)*Math.pow(2,o),a+=l):(u=t*Math.pow(2,l-1)*Math.pow(2,o),a=0));o>=8;e[n+d]=255&u,d+=y,u/=256,o-=8);for(a=a<<o|u,c+=o;c>0;e[n+d]=255&a,d+=y,a/=256,c-=8);e[n+d-y]|=128*m}},{}],290:[function(e,t,n){"use strict";t.exports=function(e){for(var t=[],n=[],r=0,o=0;r<e.length;)n.push([o++,o++,o++]),t.push([e[r++],e[r++],e[r++]],[e[r++],e[r++],e[r++]],[e[r++],e[r++],e[r++]]);return{positions:t,cells:n}}},{}],291:[function(e,t,n){"use strict";function r(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*p;case"days":case"day":case"d":return n*l;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*c;case"seconds":case"second":case"secs":case"sec":case"s":return n*f;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function o(e){return e>=l?Math.round(e/l)+"d":e>=s?Math.round(e/s)+"h":e>=c?Math.round(e/c)+"m":e>=f?Math.round(e/f)+"s":e+"ms"}function i(e){return a(e,l,"day")||a(e,s,"hour")||a(e,c,"minute")||a(e,f,"second")||e+" ms"}function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=1e3,c=60*f,s=60*c,l=24*s,p=365.25*l;t.exports=function(e,t){t=t||{};var n=void 0===e?"undefined":u(e);if("string"===n&&e.length>0)return r(e);if("number"===n&&!1===isNaN(e))return t.long?i(e):o(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],292:[function(e,t,n){"use strict";n.vertexNormals=function(e,t,n){for(var r=t.length,o=new Array(r),i=void 0===n?1e-6:n,a=0;a<r;++a)o[a]=[0,0,0];for(a=0;a<e.length;++a)for(var u=e[a],f=0,c=u[u.length-1],s=u[0],l=0;l<u.length;++l){f=c,c=s,s=u[(l+1)%u.length];for(var p=t[f],d=t[c],y=t[s],m=new Array(3),h=0,b=new Array(3),v=0,g=0;g<3;++g)m[g]=p[g]-d[g],h+=m[g]*m[g],b[g]=y[g]-d[g],v+=b[g]*b[g];if(h*v>i)for(var _=o[c],w=1/Math.sqrt(h*v),g=0;g<3;++g){var O=(g+1)%3,x=(g+2)%3;_[g]+=w*(b[O]*m[x]-b[x]*m[O])}}for(a=0;a<r;++a){for(var _=o[a],S=0,g=0;g<3;++g)S+=_[g]*_[g];if(S>i)for(var w=1/Math.sqrt(S),g=0;g<3;++g)_[g]*=w;else for(g=0;g<3;++g)_[g]=0}return o},n.faceNormals=function(e,t,n){for(var r=e.length,o=new Array(r),i=void 0===n?1e-6:n,a=0;a<r;++a){for(var u=e[a],f=new Array(3),c=0;c<3;++c)f[c]=t[u[c]];for(var s=new Array(3),l=new Array(3),c=0;c<3;++c)s[c]=f[1][c]-f[0][c],l[c]=f[2][c]-f[0][c];for(var p=new Array(3),d=0,c=0;c<3;++c){var y=(c+1)%3,m=(c+2)%3;p[c]=s[y]*l[m]-s[m]*l[y],d+=p[c]*p[c]}d=d>i?1/Math.sqrt(d):0;for(c=0;c<3;++c)p[c]*=d;o[a]=p}return o}},{}],293:[function(e,t,n){"use strict";function r(e,t){function n(e,t,r){for(var o,i=[],a=0;o=u.exec(e);){if(a++>1e4)throw Error("Circular references in parenthesis");i.push(e.slice(0,o.index)),i.push(n(t[o[1]],t)),e=e.slice(o.index+o[0].length)}return i.push(e),i}if("string"!=typeof e)return[e];var r=[e],o=(t=t||{}).brackets?Array.isArray(t.brackets)?t.brackets:[t.brackets]:["{}","[]","()"],i=t.escape||"___",a=!!t.flat;o.forEach(function(e){function t(t,n,a){var u=r.push(t.slice(e[0].length,-e[1].length))-1;return o.push(u),i+u}var n=new RegExp(["\\",e[0],"[^\\",e[0],"\\",e[1],"]*\\",e[1]].join("")),o=[];r.forEach(function(e,o){for(var i,a=0;e!=i;)if(i=e,e=e.replace(n,t),a++>1e4)throw Error("References have circular dependency. Please, check them.");r[o]=e}),o=o.reverse(),r=r.map(function(t){return o.forEach(function(n){t=t.replace(new RegExp("(\\"+i+n+"(?![0-9]))","g"),e[0]+"$1"+e[1])}),t})});var u=new RegExp("\\"+i+"([0-9]+)");return a?r:n(r[0],r)}function o(e,t){if(t&&t.flat){var n,r=t&&t.escape||"___",o=e[0];if(!o)return"";for(var i=new RegExp("\\"+r+"([0-9]+)"),a=0;o!=n;){if(a++>1e4)throw Error("Circular references in "+e);n=o,o=o.replace(i,function(t,n){if(null==e[n])throw Error("Reference "+n+"is undefined");return e[n]})}return o}return e.reduce(function e(t,n){return Array.isArray(n)&&(n=n.reduce(e,"")),t+n},"")}function i(e,t){return Array.isArray(e)?o(e,t):r(e,t)}i.parse=r,i.stringify=o,t.exports=i},{}],294:[function(e,t,n){(function(e){"use strict";function t(e,t){for(var n=0,r=e.length-1;r>=0;r--){var o=e[r];"."===o?e.splice(r,1):".."===o?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return o.exec(e).slice(1)};n.resolve=function(){for(var n="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var a=i>=0?arguments[i]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,o="/"===a.charAt(0))}return n=t(r(n.split("/"),function(e){return!!e}),!o).join("/"),(o?"/":"")+n||"."},n.normalize=function(e){var o=n.isAbsolute(e),i="/"===a(e,-1);return(e=t(r(e.split("/"),function(e){return!!e}),!o).join("/"))||o||(e="."),e&&i&&(e+="/"),(o?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(r(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},n.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var o=r(e.split("/")),i=r(t.split("/")),a=Math.min(o.length,i.length),u=a,f=0;f<a;f++)if(o[f]!==i[f]){u=f;break}for(var c=[],f=u;f<o.length;f++)c.push("..");return(c=c.concat(i.slice(u))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){var t=i(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},n.basename=function(e,t){var n=i(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return i(e)[3]};var a=function(e,t,n){return e.substr(t,n)}}).call(this,e("_process"))},{_process:296}],295:[function(_dereq_,module,exports){"use strict";function preprocess(what,how){function process(e){if(!e)return"";var t=[],n=e,r=/#[A-Za-z0-9_$]+/gi.exec(e);r&&(n=n.slice(0,r.index),e=e.slice(r.index)),n=(n=escape(n,t)).replace(/\bdefined\s*([A-Za-z0-9_$]+)/g,"defined($1)");for(var o in macros)macros[o]instanceof Function&&(n=processFunction(n,o,macros[o]));n=escape(n,t);for(var o in macros)macros[o]instanceof Function||(n=processDefinition(n,o,macros[o]));if(n=unescape(n,t),r){if(/^#def/.test(r[0]))e=define(e);else if(/^#undef/.test(r[0]))e=undefine(e);else if(/^#if/.test(r[0]))e=processIf(e);else if(/^#line/.test(r[0])){i=/#[A-Za-z0-9_]+\s*([-0-9]+)?[^\n]*/.exec(e);macros.__LINE__=parseInt(i[1]),e=e.slice(i.index+i[0].length)}else if(/^#version/.test(r[0])){var i=/#[A-Za-z0-9_]+\s*([-0-9]+)?[^\n]*/.exec(e);macros.__VERSION__=parseInt(i[1]),e=e.slice(i.index+i[0].length)}else{var a=/\n/m.exec(e);n+=e.slice(0,a.index)+"\n",e=e.slice(a.index)}return n+process(e)}return n}function processFunction(e,t,n){var r=[];e=escape(e,r);var o=paren(e,{flat:!0,brackets:"()",escape:"___"}),i=new RegExp(t+"\\s*\\(___([0-9]+)\\)","g");return o=o.map(function(e){return e.replace(i,function(e,r){var i=o[r];if((i=i.trim().length?(i=i.split(/\s*,\s*/)).map(function(e){var t=o.slice();return t[0]=e,paren.stringify(t,{flat:!0,escape:"___"})}).map(function(e){return e}):[]).length!=n.length)throw Error('macro "'+t+'" requires '+n.length+" arguments, but "+i.length+" given");return n.apply(null,i)})}),e=paren.stringify(o,{flat:!0,escape:"___"}),e=unescape(e,r)}function processDefinition(e,t,n){var r=[];return e=escape(e,r),e=e.replace(new RegExp("([^#A-Za-z0-9_$]|^)"+t+"\\s*##\\s*([A-Za-z0-9_$]*)","g"),function(e,t,r){return t+n+r}),e=e.replace(new RegExp("([A-Za-z0-9_$]*)\\s*##\\s*"+t+"([^A-Za-z0-9_$]|$)","g"),function(e,t,r){return t+n+r}),e=e.replace(new RegExp("([^#A-Za-z0-9_$]|^)"+t+"([^A-Za-z0-9_$]|$)","g"),function(e,t,r){return null==macros[n]||macros[n]instanceof Function||(n=macros[n]),t+n+r}),e=e.replace(new RegExp("#"+t+"([^A-Za-z0-9_$]|$)","g"),function(e,t){return'"'+n+'"'+t}),e=unescape(e,r)}function escape(e,t){return e=e.replace(/\/\/[^\n]*$/gm,function(e){return" ___comment"+t.push(e)}),e=e.replace(/\/\*([^\*]|[\r\n]|(\*+([^\*\/]|[\r\n])))*\*+\//g,function(e){return" ___comment"+t.push(e)}),e=e.replace(/\'[^']*\'/g,function(e){return" ___string"+t.push(e)}),e=e.replace(/\"[^"]*\"/g,function(e){return" ___string"+t.push(e)}),e=e.replace(/\`[^`]*\`/g,function(e){return" ___string"+t.push(e)})}function unescape(e,t){return t.forEach(function(t,n){e=e.replace(" ___string"+(n+1),t)}),t.forEach(function(t,n){e=e.replace(" ___comment"+(n+1),t)}),e}function define(e){var t=/#[A-Za-z]+[ ]*([A-Za-z0-9_$]*)(?:\(([^\(\)]*)\))?[ \r]*([^\n]*)$/m.exec(e);e=e.slice(t.index+t[0].length);var n=t[1],r=t[2],o=t[3];if(!n||!o)throw Error('Macro definition "'+t[0]+'" is malformed');if(null!=r){var i=function(){for(var e=o,t=0;t<r.length;t++)e=processDefinition(e,r[t],arguments[t]);return e=process(e)};r=r.trim().length?r.split(/\s*,\s*/):[],Object.defineProperty(i,"length",{value:r.length}),macros[n]=i}else macros[n]=o;return e}function undefine(e){var t=/#[A-Za-z0-9_]+[ ]*([A-Za-z0-9_$]+)/.exec(e);return delete macros[t[1]],e.slice(t.index+t[0].length)}function processIf(str){var match=balanced("#if","#endif",str);if(!match)return str;var body=match.body,post=match.post,elseBody="",matchElse;if((matchElse=/^\s*#else[^\n\r]*$/m.exec(body))&&(elseBody=body.slice(matchElse.index+matchElse[0].length),body=body.slice(0,matchElse.index)),/^def/.test(body)){body=body.slice(3);var nameMatch=/[A-Za-z0-9_$]+/.exec(body),name=nameMatch[0];body=body.slice(name.length+nameMatch.index),str=process(null!=macros[name]?body:elseBody)}else if(/^ndef/.test(body)){body=body.slice(4);var nameMatch=/[A-Za-z0-9_$]+/.exec(body),name=nameMatch[0];body=body.slice(name.length+nameMatch.index),str=process(null==macros[name]?body:elseBody)}else{for(var clauses=body.split(/^\s*#elif\s+/m),result=!1,i=0;i<clauses.length;i++){var clause=clauses[i],exprMatch=/\s*(.*)/.exec(clause),expr=exprMatch[0];clause=clause.slice(expr.length+exprMatch.index),expr=process(expr);try{result=eval(expr)}catch(e){result=!1}if(result){str=process(clause);break}}result||(str=process(elseBody))}var match=/[\n\r]/.exec(post);return match&&(post=post.slice(match.index)),str+post}var source=what+"",macros=extend({__LINE__:0,__FILE__:"_",__VERSION__:100,defined:function(e){return[].slice.call(arguments).every(function(e){return null!=macros[e]})}},how);return process(source)}var paren=_dereq_("parenthesis"),balanced=_dereq_("balanced-match"),extend=_dereq_("xtend/mutable");module.exports=preprocess},{"balanced-match":118,parenthesis:293,"xtend/mutable":302}],296:[function(e,t,n){"use strict";function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function a(e){if(p===clearTimeout)return clearTimeout(e);if((p===o||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function u(){h&&y&&(h=!1,y.length?m=y.concat(m):b=-1,m.length&&f())}function f(){if(!h){var e=i(u);h=!0;for(var t=m.length;t;){for(y=m,m=[];++b<t;)y&&y[b].run();b=-1,t=m.length}y=null,h=!1,a(e)}}function c(e,t){this.fun=e,this.array=t}function s(){}var l,p,d=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{p="function"==typeof clearTimeout?clearTimeout:o}catch(e){p=o}}();var y,m=[],h=!1,b=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new c(e,t)),1!==m.length||h||i(f)},c.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=s,d.addListener=s,d.once=s,d.off=s,d.removeListener=s,d.removeAllListeners=s,d.emit=s,d.prependListener=s,d.prependOnceListener=s,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],297:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,o){"object"===(void 0===n?"undefined":r(n))&&void 0!==t?t.exports=o():"function"==typeof define&&define.amd?define(o):e.createREGL=o()}(void 0,function(){function e(e){return"undefined"!=typeof btoa?btoa(e):"base64:"+e}function t(e){var t=new Error("(regl) "+e);throw console.error(t),t}function n(e,n){e||t(n)}function o(e){return e?": "+e:""}function i(e,n,r){n.indexOf(e)<0&&t("invalid value"+o(r)+". must be one of: "+n)}function a(e,t){for(e+="";e.length<t;)e=" "+e;return e}function u(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function f(e,t){this.number=e,this.line=t,this.errors=[]}function c(e,t,n){this.file=e,this.line=t,this.message=n}function s(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return r?r[1]:"unknown"}function l(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return r?r[1]:"unknown"}function p(t,n){var r=t.split("\n"),o=1,i=0,a={unknown:new u,0:new u};a.unknown.name=a[0].name=n||s(),a.unknown.lines.push(new f(0,""));for(var c=0;c<r.length;++c){var l=r[c],p=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(l);if(p)switch(p[1]){case"line":var d=/(\d+)(\s+\d+)?/.exec(p[2]);d&&(o=0|d[1],d[2]&&((i=0|d[2])in a||(a[i]=new u)));break;case"define":var y=/SHADER_NAME(_B64)?\s+(.*)$/.exec(p[2]);y&&(a[i].name=y[1]?e(y[2]):y[2])}a[i].lines.push(new f(o++,l))}return Object.keys(a).forEach(function(e){var t=a[e];t.lines.forEach(function(e){t.index[e.number]=e})}),a}function d(e){var t=[];return e.split("\n").forEach(function(e){if(!(e.length<5)){var n=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(e);n?t.push(new c(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new c("unknown",0,e))}}),t}function y(e,t){t.forEach(function(t){var n=e[t.file];if(n){var r=n.index[t.line];if(r)return r.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)})}function m(e){e._commandRef=s()}function h(e,n){var r=l();t(e+" in command "+(n||s())+("unknown"===r?"":" called from "+r))}function b(e,t,n,i){(void 0===e?"undefined":r(e))!==t&&h("invalid parameter type"+o(n)+". expected "+t+", got "+(void 0===e?"undefined":r(e)),i||s())}function v(e,t){return e===Ye||e===Ue||e===ze?2:e===Xe?4:qe[e]*t}function g(e){return!(e&e-1||!e)}function _(e,t){this.id=We++,this.type=e,this.data=t}function w(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function O(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+w(e.substr(1,e.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(r)return O(e.substr(0,r.index)).concat(O(r[1])).concat(O(e.substr(r.index+r[0].length)));var o=e.split(".");if(1===o.length)return['"'+w(e)+'"'];for(var i=[],a=0;a<o.length;++a)i=i.concat(O(o[a]));return i}function x(e){return"["+O(e).join("][")+"]"}function S(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r||(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}function j(e,t,n){function r(){var t=window.innerWidth,r=window.innerHeight;if(e!==document.body){var i=e.getBoundingClientRect();t=i.right-i.left,r=i.bottom-i.top}o.width=n*t,o.height=n*r,Ce(o.style,{width:t+"px",height:r+"px"})}var o=document.createElement("canvas");return Ce(o.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(o),e===document.body&&(o.style.position="absolute",Ce(e.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:o,onDestroy:function(){window.removeEventListener("resize",r),e.removeChild(o)}}}function E(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function A(e){return"string"==typeof e.nodeName&&"function"==typeof e.appendChild&&"function"==typeof e.getBoundingClientRect}function M(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}function L(e){return"string"==typeof e?e.split():(He(Array.isArray(e),"invalid extension array"),e)}function P(e){return"string"==typeof e?(He("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function T(e){var t,n,o,i,a=e||{},u={},f=[],c=[],s="undefined"==typeof window?1:window.devicePixelRatio,l=!1,p=function(e){e&&He.raise(e)},d=function(){};if("string"==typeof a?(He("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),t=document.querySelector(a),He(t,"invalid query string for element")):"object"===(void 0===a?"undefined":r(a))?A(a)?t=a:M(a)?o=(i=a).canvas:(He.constructor(a),"gl"in a?i=a.gl:"canvas"in a?o=P(a.canvas):"container"in a&&(n=P(a.container)),"attributes"in a&&(u=a.attributes,He.type(u,"object","invalid context attributes")),"extensions"in a&&(f=L(a.extensions)),"optionalExtensions"in a&&(c=L(a.optionalExtensions)),"onDone"in a&&(He.type(a.onDone,"function","invalid or missing onDone callback"),p=a.onDone),"profile"in a&&(l=!!a.profile),"pixelRatio"in a&&He((s=+a.pixelRatio)>0,"invalid pixel ratio")):He.raise("invalid arguments to regl"),t&&("canvas"===t.nodeName.toLowerCase()?o=t:n=t),!i){if(!o){He("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var y=j(n||document.body,p,s);if(!y)return null;o=y.canvas,d=y.onDestroy}i=E(o,u)}return i?{gl:i,canvas:o,container:n,extensions:f,optionalExtensions:c,pixelRatio:s,profile:l,onDone:p,onDestroy:d}:(d(),p("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function R(e,t){function n(t){He.type(t,"string","extension name must be string");var n,o=t.toLowerCase();try{n=r[o]=e.getExtension(o)}catch(e){}return!!n}for(var r={},o=0;o<t.extensions.length;++o){var i=t.extensions[o];if(!n(i))return t.onDestroy(),t.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(!n(e))throw new Error("(regl): error restoring extension "+e)})}}}function C(e){return!!e&&"object"===(void 0===e?"undefined":r(e))&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||Re(e.data))}function k(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function I(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}function D(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,(t|=n)|e>>1}function V(e){var t=I(e),n=ft[D(t)>>2];return n.length>0?n.pop():new ArrayBuffer(t)}function G(e){ft[D(e.byteLength)>>2].push(e)}function N(e,t,n){for(var r=0;r<t;++r)n[r]=e[r]}function F(e,t,n,r){for(var o=0,i=0;i<t;++i)for(var a=e[i],u=0;u<n;++u)r[o++]=a[u]}function B(e,t,n,r,o,i){for(var a=i,u=0;u<t;++u)for(var f=e[u],c=0;c<n;++c)for(var s=f[c],l=0;l<r;++l)o[a++]=s[l]}function U(e,t,n,r,o){for(var i=1,a=n+1;a<t.length;++a)i*=t[a];var u=t[n];if(t.length-n==4){var f=t[n+1],c=t[n+2],s=t[n+3];for(a=0;a<u;++a)B(e[a],f,c,s,r,o),o+=i}else for(a=0;a<u;++a)U(e[a],t,n+1,r,o),o+=i}function Y(e){return 0|Te[Object.prototype.toString.call(e)]}function z(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function X(e,t,n,r,o,i,a){for(var u=0,f=0;f<n;++f)for(var c=0;c<r;++c)e[u++]=t[o*f+i*c+a]}function q(e,t,n){function r(t){this.id=u++,this.buffer=e.createBuffer(),this.type=t,this.usage=mt,this.byteLength=0,this.dimension=1,this.dtype=bt,this.persistentData=null,n.profile&&(this.stats={size:0})}function o(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function i(e,t,n,r,i,a){var u;if(e.usage=n,Array.isArray(t)){if(e.dtype=r||vt,t.length>0){var f;if(Array.isArray(t[0])){u=yt(t);for(var c=1,s=1;s<u.length;++s)c*=u[s];e.dimension=c,o(e,f=dt(t,u,e.dtype),n),a?e.persistentData=f:ct.freeType(f)}else if("number"==typeof t[0]){e.dimension=i;var l=ct.allocType(e.dtype,t.length);z(l,t),o(e,l,n),a?e.persistentData=l:ct.freeType(l)}else Re(t[0])?(e.dimension=t[0].length,e.dtype=r||Y(t[0])||vt,o(e,f=dt(t,[t.length,t[0].length],e.dtype),n),a?e.persistentData=f:ct.freeType(f)):He.raise("invalid buffer data")}}else if(Re(t))e.dtype=r||Y(t),e.dimension=i,o(e,t,n),a&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(C(t)){u=t.shape;var p=t.stride,d=t.offset,y=0,m=0,h=0,b=0;1===u.length?(y=u[0],m=1,h=p[0],b=0):2===u.length?(y=u[0],m=u[1],h=p[0],b=p[1]):He.raise("invalid shape"),e.dtype=r||Y(t.data)||vt,e.dimension=m;var v=ct.allocType(e.dtype,y*m);X(v,t.data,y,m,h,b,d),o(e,v,n),a?e.persistentData=v:ct.freeType(v)}else He.raise("invalid buffer data")}function a(n){t.bufferCount--;var r=n.buffer;He(r,"buffer must not be deleted already"),e.deleteBuffer(r),n.buffer=null,delete f[n.id]}var u=0,f={};r.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},r.prototype.destroy=function(){a(this)};var c=[];return n.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(f).forEach(function(t){e+=f[t].stats.size}),e}),{create:function(o,u,c,s){function l(t){var r=mt,o=null,a=0,u=0,f=1;return Array.isArray(t)||Re(t)||C(t)?o=t:"number"==typeof t?a=0|t:t&&(He.type(t,"object","buffer arguments must be an object, a number or an array"),"data"in t&&(He(null===o||Array.isArray(o)||Re(o)||C(o),"invalid data for buffer"),o=t.data),"usage"in t&&(He.parameter(t.usage,pt,"invalid buffer usage"),r=pt[t.usage]),"type"in t&&(He.parameter(t.type,lt,"invalid buffer type"),u=lt[t.type]),"dimension"in t&&(He.type(t.dimension,"number","invalid dimension"),f=0|t.dimension),"length"in t&&(He.nni(a,"buffer length must be a nonnegative integer"),a=0|t.length)),d.bind(),o?i(d,o,r,u,f,s):(e.bufferData(d.type,a,r),d.dtype=u||bt,d.usage=r,d.dimension=f,d.byteLength=a),n.profile&&(d.stats.size=d.byteLength*gt[d.dtype]),l}function p(t,n){He(n+t.byteLength<=d.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+d.byteLength),e.bufferSubData(d.type,n,t)}t.bufferCount++;var d=new r(u);return f[d.id]=d,c||l(o),l._reglType="buffer",l._buffer=d,l.subdata=function(e,t){var n,r=0|(t||0);if(d.bind(),Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var o=ct.allocType(d.dtype,e.length);z(o,e),p(o,r),ct.freeType(o)}else if(Array.isArray(e[0])||Re(e[0])){n=yt(e);var i=dt(e,n,d.dtype);p(i,r),ct.freeType(i)}else He.raise("invalid buffer data")}else if(Re(e))p(e,r);else if(C(e)){n=e.shape;var a=e.stride,u=0,f=0,c=0,s=0;1===n.length?(u=n[0],f=1,c=a[0],s=0):2===n.length?(u=n[0],f=n[1],c=a[0],s=a[1]):He.raise("invalid shape");var y=Array.isArray(e.data)?d.dtype:Y(e.data),m=ct.allocType(y,u*f);X(m,e.data,u,f,c,s,e.offset),p(m,r),ct.freeType(m)}else He.raise("invalid data for buffer subdata");return l},n.profile&&(l.stats=d.stats),l.destroy=function(){a(d)},l},createStream:function(e,t){var n=c.pop();return n||(n=new r(e)),n.bind(),i(n,t,ht,0,1,!1),n},destroyStream:function(e){c.push(e)},clear:function(){et(f).forEach(a),c.forEach(a)},getBuffer:function(e){return e&&e._buffer instanceof r?e._buffer:null},restore:function(){et(f).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:i}}function H(e,t,n,r){function o(e){this.id=f++,u[this.id]=this,this.buffer=e,this.primType=xt,this.vertCount=0,this.type=0}function i(r,o,i,a,u,f,c){if(r.buffer.bind(),o){var s=c;c||Re(o)&&(!C(o)||Re(o.data))||(s=t.oes_element_index_uint?Lt:At),n._initBuffer(r.buffer,o,i,s,3)}else e.bufferData(Pt,f,i),r.buffer.dtype=l||jt,r.buffer.usage=i,r.buffer.dimension=3,r.buffer.byteLength=f;var l=c;if(!c){switch(r.buffer.dtype){case jt:case St:l=jt;break;case At:case Et:l=At;break;case Lt:case Mt:l=Lt;break;default:He.raise("unsupported type for element array")}r.buffer.dtype=l}r.type=l,He(l!==Lt||!!t.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var p=u;p<0&&(p=r.buffer.byteLength,l===At?p>>=1:l===Lt&&(p>>=2)),r.vertCount=p;var d=a;if(a<0){d=xt;var y=r.buffer.dimension;1===y&&(d=wt),2===y&&(d=Ot),3===y&&(d=xt)}r.primType=d}function a(e){r.elementsCount--,He(null!==e.buffer,"must not double destroy elements"),delete u[e.id],e.buffer.destroy(),e.buffer=null}var u={},f=0,c={uint8:jt,uint16:At};t.oes_element_index_uint&&(c.uint32=Lt),o.prototype.bind=function(){this.buffer.bind()};var s=[];return{create:function(e,t){function u(e){if(e)if("number"==typeof e)f(e),s.primType=xt,s.vertCount=0|e,s.type=jt;else{var t=null,n=Rt,r=-1,o=-1,a=0,l=0;Array.isArray(e)||Re(e)||C(e)?t=e:(He.type(e,"object","invalid arguments for elements"),"data"in e&&(t=e.data,He(Array.isArray(t)||Re(t)||C(t),"invalid data for element buffer")),"usage"in e&&(He.parameter(e.usage,pt,"invalid element buffer usage"),n=pt[e.usage]),"primitive"in e&&(He.parameter(e.primitive,_t,"invalid element buffer primitive"),r=_t[e.primitive]),"count"in e&&(He("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),o=0|e.count),"type"in e&&(He.parameter(e.type,c,"invalid buffer type"),l=c[e.type]),"length"in e?a=0|e.length:(a=o,l===At||l===Et?a*=2:l!==Lt&&l!==Mt||(a*=4))),i(s,t,n,r,o,a,l)}else f(),s.primType=xt,s.vertCount=0,s.type=jt;return u}var f=n.create(null,Pt,!0),s=new o(f._buffer);return r.elementsCount++,u(e),u._reglType="elements",u._elements=s,u.subdata=function(e,t){return f.subdata(e,t),u},u.destroy=function(){a(s)},u},createStream:function(e){var t=s.pop();return t||(t=new o(n.create(null,Pt,!0,!1)._buffer)),i(t,e,Tt,-1,-1,0,0),t},destroyStream:function(e){s.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof o?e._elements:null},clear:function(){et(u).forEach(a)}}}function W(e){for(var t=ct.allocType(It,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-1/0)t[n]=64512;else{Ct[0]=e[n];var r=kt[0],o=r>>>31<<15,i=(r<<1>>>24)-127,a=r>>13&1023;if(i<-24)t[n]=o;else if(i<-14){var u=-14-i;t[n]=o+(a+1024>>u)}else t[n]=i>15?o+31744:o+(i+15<<10)+a}return t}function K(e){return Array.isArray(e)||Re(e)}function $(e){return"[object "+e+"]"}function Q(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function Z(e){return!!Array.isArray(e)&&!(0===e.length||!K(e[0]))}function J(e){return Object.prototype.toString.call(e)}function ee(e){return J(e)===Hn}function te(e){return J(e)===Wn}function ne(e){return J(e)===Kn}function re(e){return J(e)===$n}function oe(e){if(!e)return!1;var t=J(e);return Qn.indexOf(t)>=0||(Q(e)||Z(e)||C(e))}function ie(e){return 0|Te[Object.prototype.toString.call(e)]}function ae(e,t){var n=t.length;switch(e.type){case hn:case bn:case vn:case gn:var r=ct.allocType(e.type,n);r.set(t),e.data=r;break;case nn:e.data=W(t);break;default:He.raise("unsupported texture type, must specify a typed array")}}function ue(e,t){return ct.allocType(e.type===nn?gn:e.type,t)}function fe(e,t){e.type===nn?(e.data=W(t),ct.freeType(t)):e.data=t}function ce(e,t,n,r,o,i){for(var a=e.width,u=e.height,f=e.channels,c=ue(e,a*u*f),s=0,l=0;l<u;++l)for(var p=0;p<a;++p)for(var d=0;d<f;++d)c[s++]=t[n*p+r*l+o*d+i];fe(e,c)}function se(e,t,n,r,o,i){var a;if(a=void 0!==Jn[e]?Jn[e]:qn[e]*Zn[t],i&&(a*=6),o){for(var u=0,f=n;f>=1;)u+=a*f*f,f/=2;return u}return a*n*r}function le(e,t,n,o,i,a,u){function f(){this.internalformat=Ft,this.format=Ft,this.type=hn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=0,this.width=0,this.height=0,this.channels=0}function c(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function s(e,o){if("object"===(void 0===o?"undefined":r(o))&&o){if("premultiplyAlpha"in o&&(He.type(o.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=o.premultiplyAlpha),"flipY"in o&&(He.type(o.flipY,"boolean","invalid texture flip"),e.flipY=o.flipY),"alignment"in o&&(He.oneOf(o.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=o.alignment),"colorSpace"in o&&(He.parameter(o.colorSpace,D,"invalid colorSpace"),e.colorSpace=D[o.colorSpace]),"type"in o){var i=o.type;He(t.oes_texture_float||!("float"===i||"float32"===i),"you must enable the OES_texture_float extension in order to use floating point textures."),He(t.oes_texture_half_float||!("half float"===i||"float16"===i),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),He(t.webgl_depth_texture||!("uint16"===i||"uint32"===i||"depth stencil"===i),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),He.parameter(i,V,"invalid texture type"),e.type=V[i]}var a=e.width,u=e.height,f=e.channels,c=!1;"shape"in o?(He(Array.isArray(o.shape)&&o.shape.length>=2,"shape must be an array"),a=o.shape[0],u=o.shape[1],3===o.shape.length&&(f=o.shape[2],He(f>0&&f<=4,"invalid number of channels"),c=!0),He(a>=0&&a<=n.maxTextureSize,"invalid width"),He(u>=0&&u<=n.maxTextureSize,"invalid height")):("radius"in o&&(a=u=o.radius,He(a>=0&&a<=n.maxTextureSize,"invalid radius")),"width"in o&&(a=o.width,He(a>=0&&a<=n.maxTextureSize,"invalid width")),"height"in o&&(u=o.height,He(u>=0&&u<=n.maxTextureSize,"invalid height")),"channels"in o&&(f=o.channels,He(f>0&&f<=4,"invalid number of channels"),c=!0)),e.width=0|a,e.height=0|u,e.channels=0|f;var s=!1;if("format"in o){var l=o.format;He(t.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),He.parameter(l,G,"invalid texture format");var p=e.internalformat=G[l];e.format=H[p],l in V&&("type"in o||(e.type=V[l])),l in N&&(e.compressed=!0),s=!0}!c&&s?e.channels=qn[e.format]:c&&!s?e.channels!==Xn[e.format]&&(e.format=e.internalformat=Xn[e.channels]):s&&c&&He(e.channels===qn[e.format],"number of channels inconsistent with specified format")}}function l(t){e.pixelStorei(Nn,t.flipY),e.pixelStorei(Fn,t.premultiplyAlpha),e.pixelStorei(Bn,t.colorSpace),e.pixelStorei(Gn,t.unpackAlignment)}function p(){f.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function d(e,t){var r=null;if(oe(t)?r=t:t&&(He.type(t,"object","invalid pixel data type"),s(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),oe(t.data)&&(r=t.data)),He(!e.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),t.copy){He(!r,"can not specify copy and data field for the same texture");var o=i.viewportWidth,a=i.viewportHeight;e.width=e.width||o-e.xOffset,e.height=e.height||a-e.yOffset,e.needsCopy=!0,He(e.xOffset>=0&&e.xOffset<o&&e.yOffset>=0&&e.yOffset<a&&e.width>0&&e.width<=o&&e.height>0&&e.height<=a,"copy texture read out of bounds")}else if(r){if(Re(r))e.channels=e.channels||4,e.data=r,"type"in t||e.type!==hn||(e.type=ie(r));else if(Q(r))e.channels=e.channels||4,ae(e,r),e.alignment=1,e.needsFree=!0;else if(C(r)){var u=r.data;Array.isArray(u)||e.type!==hn||(e.type=ie(u));var f,c,l,p,d,y,m=r.shape,h=r.stride;3===m.length?(l=m[2],y=h[2]):(He(2===m.length,"invalid ndarray pixel data, must be 2 or 3D"),l=1,y=1),f=m[0],c=m[1],p=h[0],d=h[1],e.alignment=1,e.width=f,e.height=c,e.channels=l,e.format=e.internalformat=Xn[l],e.needsFree=!0,ce(e,u,p,d,y,r.offset)}else if(ee(r)||te(r))ee(r)?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(ne(r))e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(re(r))e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(Z(r)){var b=e.width||r[0].length,v=e.height||r.length,g=e.channels;g=K(r[0][0])?g||r[0][0].length:g||1;for(var _=st.shape(r),w=1,O=0;O<_.length;++O)w*=_[O];var x=ue(e,w);st.flatten(r,_,"",x),fe(e,x),e.alignment=1,e.width=b,e.height=v,e.channels=g,e.format=e.internalformat=Xn[g],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===gn?He(n.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===nn&&He(n.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function y(t,n,r){var i=t.element,a=t.data,u=t.internalformat,f=t.format,c=t.type,s=t.width,p=t.height;l(t),i?e.texImage2D(n,r,f,f,c,i):t.compressed?e.compressedTexImage2D(n,r,u,s,p,0,a):t.needsCopy?(o(),e.copyTexImage2D(n,r,f,t.xOffset,t.yOffset,s,p,0)):e.texImage2D(n,r,f,s,p,0,f,c,a)}function m(t,n,r,i,a){var u=t.element,f=t.data,c=t.internalformat,s=t.format,p=t.type,d=t.width,y=t.height;l(t),u?e.texSubImage2D(n,a,r,i,s,p,u):t.compressed?e.compressedTexSubImage2D(n,a,r,i,c,d,y,f):t.needsCopy?(o(),e.copyTexSubImage2D(n,a,r,i,t.xOffset,t.yOffset,d,y)):e.texSubImage2D(n,a,r,i,d,y,s,p,f)}function h(){return W.pop()||new p}function b(e){e.needsFree&&ct.freeType(e.data),p.call(e),W.push(e)}function v(){f.call(this),this.genMipmaps=!1,this.mipmapHint=kn,this.mipmask=0,this.images=Array(16)}function g(e,t,n){var r=e.images[0]=h();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function _(e,t){var n=null;if(oe(t))c(n=e.images[0]=h(),e),d(n,t),e.mipmask=1;else if(s(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,o=0;o<r.length;++o)c(n=e.images[o]=h(),e),n.width>>=o,n.height>>=o,d(n,r[o]),e.mipmask|=1<<o;else c(n=e.images[0]=h(),e),d(n,t),e.mipmask=1;c(e,e.images[0]),(e.compressed&&e.internalformat===rn||e.internalformat===on||e.internalformat===an||e.internalformat===un)&&He(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function w(e,t){for(var n=e.images,r=0;r<n.length;++r){if(!n[r])return;y(n[r],t,r)}}function O(){var e=$.pop()||new v;f.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function x(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&b(t[n]),t[n]=null;$.push(e)}function S(){this.minFilter=An,this.magFilter=An,this.wrapS=xn,this.wrapT=xn,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=kn}function j(e,t){if("min"in t){var o=t.min;He.parameter(o,I),e.minFilter=I[o],zn.indexOf(e.minFilter)>=0&&(e.genMipmaps=!0)}if("mag"in t){var i=t.mag;He.parameter(i,k),e.magFilter=k[i]}var a=e.wrapS,u=e.wrapT;if("wrap"in t){var f=t.wrap;"string"==typeof f?(He.parameter(f,R),a=u=R[f]):Array.isArray(f)&&(He.parameter(f[0],R),He.parameter(f[1],R),a=R[f[0]],u=R[f[1]])}else{if("wrapS"in t){var c=t.wrapS;He.parameter(c,R),a=R[c]}if("wrapT"in t){var s=t.wrapT;He.parameter(s,R),u=R[s]}}if(e.wrapS=a,e.wrapT=u,"anisotropic"in t){var l=t.anisotropic;He("number"==typeof l&&l>=1&&l<=n.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var p=!1;switch(r(t.mipmap)){case"string":He.parameter(t.mipmap,T,"invalid mipmap hint"),e.mipmapHint=T[t.mipmap],e.genMipmaps=!0,p=!0;break;case"boolean":p=e.genMipmaps=t.mipmap;break;case"object":He(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,p=!0;break;default:He.raise("invalid mipmap type")}!p||"min"in t||(e.minFilter=Ln)}}function E(n,r){e.texParameteri(r,En,n.minFilter),e.texParameteri(r,jn,n.magFilter),e.texParameteri(r,_n,n.wrapS),e.texParameteri(r,wn,n.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(r,Vn,n.anisotropic),n.genMipmaps&&(e.hint(Cn,n.mipmapHint),e.generateMipmap(r))}function A(t){f.call(this),this.mipmask=0,this.internalformat=Ft,this.id=J++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new S,u.profile&&(this.stats={size:0})}function M(t){e.activeTexture(Yn),e.bindTexture(t.target,t.texture)}function L(){var t=de[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(Vt,null)}function P(t){var n=t.texture;He(n,"must not double destroy texture");var r=t.unit,o=t.target;r>=0&&(e.activeTexture(Yn+r),e.bindTexture(o,null),de[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete le[t.id],a.textureCount--}var T={"don't care":kn,"dont care":kn,nice:Dn,fast:In},R={repeat:On,clamp:xn,mirror:Sn},k={nearest:An,linear:Mn},I=Ce({mipmap:Rn,"nearest mipmap nearest":Ln,"linear mipmap nearest":Pn,"nearest mipmap linear":Tn,"linear mipmap linear":Rn},k),D={none:0,browser:Un},V={uint8:hn,rgba4:Wt,rgb565:$t,"rgb5 a1":Kt},G={alpha:Bt,luminance:Yt,"luminance alpha":zt,rgb:Ut,rgba:Ft,rgba4:Xt,"rgb5 a1":qt,rgb565:Ht},N={};t.ext_srgb&&(G.srgb=en,G.srgba=tn),t.oes_texture_float&&(V.float32=V.float=gn),t.oes_texture_half_float&&(V.float16=V["half float"]=nn),t.webgl_depth_texture&&(Ce(G,{depth:Zt,"depth stencil":Jt}),Ce(V,{uint16:bn,uint32:vn,"depth stencil":Qt})),t.webgl_compressed_texture_s3tc&&Ce(N,{"rgb s3tc dxt1":rn,"rgba s3tc dxt1":on,"rgba s3tc dxt3":an,"rgba s3tc dxt5":un}),t.webgl_compressed_texture_atc&&Ce(N,{"rgb atc":fn,"rgba atc explicit alpha":cn,"rgba atc interpolated alpha":sn}),t.webgl_compressed_texture_pvrtc&&Ce(N,{"rgb pvrtc 4bppv1":ln,"rgb pvrtc 2bppv1":pn,"rgba pvrtc 4bppv1":dn,"rgba pvrtc 2bppv1":yn}),t.webgl_compressed_texture_etc1&&(N["rgb etc1"]=mn);var F=Array.prototype.slice.call(e.getParameter(Dt));Object.keys(N).forEach(function(e){var t=N[e];F.indexOf(t)>=0&&(G[e]=t)});var B=Object.keys(G);n.textureFormats=B;var U=[];Object.keys(G).forEach(function(e){var t=G[e];U[t]=e});var Y=[];Object.keys(V).forEach(function(e){var t=V[e];Y[t]=e});var z=[];Object.keys(k).forEach(function(e){var t=k[e];z[t]=e});var X=[];Object.keys(I).forEach(function(e){var t=I[e];X[t]=e});var q=[];Object.keys(R).forEach(function(e){var t=R[e];q[t]=e});var H=B.reduce(function(e,t){var n=G[t];return n===Yt||n===Bt||n===Yt||n===zt||n===Zt||n===Jt?e[n]=n:n===qt||t.indexOf("rgba")>=0?e[n]=Ft:e[n]=Ut,e},{}),W=[],$=[],J=0,le={},pe=n.maxTextureUnits,de=Array(pe).map(function(){return null});return Ce(A.prototype,{bind:function(){var t=this;t.bindCount+=1;var n=t.unit;if(n<0){for(var r=0;r<pe;++r){var o=de[r];if(o){if(o.bindCount>0)continue;o.unit=-1}de[r]=t,n=r;break}n>=pe&&He.raise("insufficient number of texture units"),u.profile&&a.maxTextureUnits<n+1&&(a.maxTextureUnits=n+1),t.unit=n,e.activeTexture(Yn+n),e.bindTexture(t.target,t.texture)}return n},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&P(this)}}),u.profile&&(a.getTotalTextureSize=function(){var e=0;return Object.keys(le).forEach(function(t){e+=le[t].stats.size}),e}),{create2D:function(t,r){function o(e,t){var r=i.texInfo;S.call(r);var a=O();return"number"==typeof e?"number"==typeof t?g(a,0|e,0|t):g(a,0|e,0|e):e?(He.type(e,"object","invalid arguments to regl.texture"),j(r,e),_(a,e)):g(a,1,1),r.genMipmaps&&(a.mipmask=(a.width<<1)-1),i.mipmask=a.mipmask,c(i,a),He.texture2D(r,a,n),i.internalformat=a.internalformat,o.width=a.width,o.height=a.height,M(i),w(a,Vt),E(r,Vt),L(),x(a),u.profile&&(i.stats.size=se(i.internalformat,i.type,a.width,a.height,r.genMipmaps,!1)),o.format=U[i.internalformat],o.type=Y[i.type],o.mag=z[r.magFilter],o.min=X[r.minFilter],o.wrapS=q[r.wrapS],o.wrapT=q[r.wrapT],o}var i=new A(Vt);return le[i.id]=i,a.textureCount++,o(t,r),o.subimage=function(e,t,n,r){He(!!e,"must specify image data");var a=0|t,u=0|n,f=0|r,s=h();return c(s,i),s.width=0,s.height=0,d(s,e),s.width=s.width||(i.width>>f)-a,s.height=s.height||(i.height>>f)-u,He(i.type===s.type&&i.format===s.format&&i.internalformat===s.internalformat,"incompatible format for texture.subimage"),He(a>=0&&u>=0&&a+s.width<=i.width&&u+s.height<=i.height,"texture.subimage write out of bounds"),He(i.mipmask&1<<f,"missing mipmap data"),He(s.data||s.element||s.needsCopy,"missing image data"),M(i),m(s,Vt,a,u,f),L(),b(s),o},o.resize=function(t,n){var r=0|t,a=0|n||r;if(r===i.width&&a===i.height)return o;o.width=i.width=r,o.height=i.height=a,M(i);for(var f=0;i.mipmask>>f;++f)e.texImage2D(Vt,f,i.format,r>>f,a>>f,0,i.format,i.type,null);return L(),u.profile&&(i.stats.size=se(i.internalformat,i.type,r,a,!1,!1)),o},o._reglType="texture2d",o._texture=i,u.profile&&(o.stats=i.stats),o.destroy=function(){i.decRef()},o},createCube:function(t,o,i,f,l,p){function y(e,t,o,i,a,f){var l,p=v.texInfo;for(S.call(p),l=0;l<6;++l)P[l]=O();if("number"!=typeof e&&e)if("object"===(void 0===e?"undefined":r(e)))if(t)_(P[0],e),_(P[1],t),_(P[2],o),_(P[3],i),_(P[4],a),_(P[5],f);else if(j(p,e),s(v,e),"faces"in e){var d=e.faces;for(He(Array.isArray(d)&&6===d.length,"cube faces must be a length 6 array"),l=0;l<6;++l)He("object"===r(d[l])&&!!d[l],"invalid input for cube map face"),c(P[l],v),_(P[l],d[l])}else for(l=0;l<6;++l)_(P[l],e);else He.raise("invalid arguments to cube map");else{var m=0|e||1;for(l=0;l<6;++l)g(P[l],m,m)}for(c(v,P[0]),p.genMipmaps?v.mipmask=(P[0].width<<1)-1:v.mipmask=P[0].mipmask,He.textureCube(v,p,P,n),v.internalformat=P[0].internalformat,y.width=P[0].width,y.height=P[0].height,M(v),l=0;l<6;++l)w(P[l],Nt+l);for(E(p,Gt),L(),u.profile&&(v.stats.size=se(v.internalformat,v.type,y.width,y.height,p.genMipmaps,!0)),y.format=U[v.internalformat],y.type=Y[v.type],y.mag=z[p.magFilter],y.min=X[p.minFilter],y.wrapS=q[p.wrapS],y.wrapT=q[p.wrapT],l=0;l<6;++l)x(P[l]);return y}var v=new A(Gt);le[v.id]=v,a.cubeCount++;var P=new Array(6);return y(t,o,i,f,l,p),y.subimage=function(e,t,n,r,o){He(!!t,"must specify image data"),He("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var i=0|n,a=0|r,u=0|o,f=h();return c(f,v),f.width=0,f.height=0,d(f,t),f.width=f.width||(v.width>>u)-i,f.height=f.height||(v.height>>u)-a,He(v.type===f.type&&v.format===f.format&&v.internalformat===f.internalformat,"incompatible format for texture.subimage"),He(i>=0&&a>=0&&i+f.width<=v.width&&a+f.height<=v.height,"texture.subimage write out of bounds"),He(v.mipmask&1<<u,"missing mipmap data"),He(f.data||f.element||f.needsCopy,"missing image data"),M(v),m(f,Nt+e,i,a,u),L(),b(f),y},y.resize=function(t){var n=0|t;if(n!==v.width){y.width=v.width=n,y.height=v.height=n,M(v);for(var r=0;r<6;++r)for(var o=0;v.mipmask>>o;++o)e.texImage2D(Nt+r,o,v.format,n>>o,n>>o,0,v.format,v.type,null);return L(),u.profile&&(v.stats.size=se(v.internalformat,v.type,y.width,y.height,!1,!0)),y}},y._reglType="textureCube",y._texture=v,u.profile&&(y.stats=v.stats),y.destroy=function(){v.decRef()},y},clear:function(){for(var t=0;t<pe;++t)e.activeTexture(Yn+t),e.bindTexture(Vt,null),de[t]=null;et(le).forEach(P),a.cubeCount=0,a.textureCount=0},getTexture:function(e){return null},restore:function(){et(le).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;n<32;++n)if(0!=(t.mipmask&1<<n))if(t.target===Vt)e.texImage2D(Vt,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;r<6;++r)e.texImage2D(Nt+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);E(t.texInfo,t.target)})}}}function pe(e,t,n){return nr[e]*t*n}function de(e,t,n,o,i,a){function u(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=0,o=0;t?(r=t.width,o=t.height):n&&(r=n.width,o=n.height),this.width=r,this.height=o}function f(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function c(e,t,n){if(e)if(e.texture){var r=e.texture._texture,o=Math.max(1,r.width),i=Math.max(1,r.height);He(o===t&&i===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=e.renderbuffer._renderbuffer;He(a.width===t&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function s(t,n){n&&(n.texture?e.framebufferTexture2D(or,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(or,t,ir,n.renderbuffer._renderbuffer.renderbuffer))}function l(e){var t=ar,n=null,o=null,i=e;"object"===(void 0===e?"undefined":r(e))&&(i=e.data,"target"in e&&(t=0|e.target)),He.type(i,"function","invalid attachment data");var a=i._reglType;return"texture2d"===a?(n=i,He(t===ar)):"textureCube"===a?(n=i,He(t>=ur&&t<ur+6,"invalid cube map target")):"renderbuffer"===a?(o=i,t=ir):He.raise("invalid regl object for attachment"),new u(t,n,o)}function p(e,t,n,r,a){if(n){var f=o.create2D({width:e,height:t,format:r,type:a});return f._texture.refCount=0,new u(ar,f,null)}var c=i.create({width:e,height:t,format:r});return c._renderbuffer.refCount=0,new u(ir,null,c)}function d(e){return e&&(e.texture||e.renderbuffer)}function y(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n))}function m(){this.id=S++,j[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function h(e){e.colorAttachments.forEach(f),f(e.depthAttachment),f(e.stencilAttachment),f(e.depthStencilAttachment)}function b(t){var n=t.framebuffer;He(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,a.framebufferCount--,delete j[t.id]}function v(t){var r;e.bindFramebuffer(or,t.framebuffer);var o=t.colorAttachments;for(r=0;r<o.length;++r)s(fr+r,o[r]);for(r=o.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(or,fr+r,ar,null,0);e.framebufferTexture2D(or,lr,ar,null,0),e.framebufferTexture2D(or,cr,ar,null,0),e.framebufferTexture2D(or,sr,ar,null,0),s(cr,t.depthAttachment),s(sr,t.stencilAttachment),s(lr,t.depthStencilAttachment);var i=e.checkFramebufferStatus(or);i!==pr&&He.raise("framebuffer configuration not supported, status = "+wr[i]),e.bindFramebuffer(or,_.next),_.cur=_.next,e.getError()}function g(e,r){function o(e,r){var a;He(_.next!==i,"can not update framebuffer which is currently in use");var u=t.webgl_draw_buffers,f=0,s=0,y=!0,m=!0,b=null,g=!0,S="rgba",j="uint8",E=1,A=null,M=null,L=null,P=!1;if("number"==typeof e)f=0|e,s=0|r||f;else if(e){He.type(e,"object","invalid arguments for framebuffer");var T=e;if("shape"in T){var R=T.shape;He(Array.isArray(R)&&R.length>=2,"invalid shape for framebuffer"),f=R[0],s=R[1]}else"radius"in T&&(f=s=T.radius),"width"in T&&(f=T.width),"height"in T&&(s=T.height);("color"in T||"colors"in T)&&(b=T.color||T.colors,Array.isArray(b)&&He(1===b.length||u,"multiple render targets not supported")),b||("colorCount"in T&&(E=0|T.colorCount,He(E>0,"invalid color buffer count")),"colorTexture"in T&&(g=!!T.colorTexture,S="rgba4"),"colorType"in T&&(j=T.colorType,g?(He(t.oes_texture_float||!("float"===j||"float32"===j),"you must enable OES_texture_float in order to use floating point framebuffer objects"),He(t.oes_texture_half_float||!("half float"===j||"float16"===j),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===j||"float16"===j?(He(t.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),S="rgba16f"):"float"!==j&&"float32"!==j||(He(t.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),S="rgba32f"),He.oneOf(j,x,"invalid color type")),"colorFormat"in T&&(S=T.colorFormat,w.indexOf(S)>=0?g=!0:O.indexOf(S)>=0?g=!1:g?He.oneOf(T.colorFormat,w,"invalid color format for texture"):He.oneOf(T.colorFormat,O,"invalid color format for renderbuffer"))),("depthTexture"in T||"depthStencilTexture"in T)&&(P=!(!T.depthTexture&&!T.depthStencilTexture),He(!P||t.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in T&&("boolean"==typeof T.depth?y=T.depth:(A=T.depth,m=!1)),"stencil"in T&&("boolean"==typeof T.stencil?m=T.stencil:(M=T.stencil,y=!1)),"depthStencil"in T&&("boolean"==typeof T.depthStencil?y=m=T.depthStencil:(L=T.depthStencil,y=!1,m=!1))}else f=s=1;var C=null,k=null,I=null,D=null;if(Array.isArray(b))C=b.map(l);else if(b)C=[l(b)];else for(C=new Array(E),a=0;a<E;++a)C[a]=p(f,s,g,S,j);He(t.webgl_draw_buffers||C.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),He(C.length<=n.maxColorAttachments,"too many color attachments, not supported"),f=f||C[0].width,s=s||C[0].height,A?k=l(A):y&&!m&&(k=p(f,s,P,"depth","uint32")),M?I=l(M):m&&!y&&(I=p(f,s,!1,"stencil","uint8")),L?D=l(L):!A&&!M&&m&&y&&(D=p(f,s,P,"depth stencil","depth stencil")),He(!!A+!!M+!!L<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var V=null;for(a=0;a<C.length;++a)if(c(C[a],f,s),He(!C[a]||C[a].texture&&yr.indexOf(C[a].texture._texture.format)>=0||C[a].renderbuffer&&_r.indexOf(C[a].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+a+" is invalid"),C[a]&&C[a].texture){var G=mr[C[a].texture._texture.format]*hr[C[a].texture._texture.type];null===V?V=G:He(V===G,"all color attachments much have the same number of bits per pixel.")}return c(k,f,s),He(!k||k.texture&&k.texture._texture.format===dr||k.renderbuffer&&k.renderbuffer._renderbuffer.format===br,"invalid depth attachment for framebuffer object"),c(I,f,s),He(!I||I.renderbuffer&&I.renderbuffer._renderbuffer.format===vr,"invalid stencil attachment for framebuffer object"),c(D,f,s),He(!D||D.texture&&D.texture._texture.format===gr||D.renderbuffer&&D.renderbuffer._renderbuffer.format===gr,"invalid depth-stencil attachment for framebuffer object"),h(i),i.width=f,i.height=s,i.colorAttachments=C,i.depthAttachment=k,i.stencilAttachment=I,i.depthStencilAttachment=D,o.color=C.map(d),o.depth=d(k),o.stencil=d(I),o.depthStencil=d(D),o.width=i.width,o.height=i.height,v(i),o}var i=new m;return a.framebufferCount++,o(e,r),Ce(o,{resize:function(e,t){He(_.next!==i,"can not resize a framebuffer which is currently in use");var n=0|e,r=0|t||n;if(n===i.width&&r===i.height)return o;for(var a=i.colorAttachments,u=0;u<a.length;++u)y(a[u],n,r);return y(i.depthAttachment,n,r),y(i.stencilAttachment,n,r),y(i.depthStencilAttachment,n,r),i.width=o.width=n,i.height=o.height=r,v(i),o},_reglType:"framebuffer",_framebuffer:i,destroy:function(){b(i),h(i)},use:function(e){_.setFBO({framebuffer:o},e)}})}var _={cur:null,next:null,dirty:!1,setFBO:null},w=["rgba"],O=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&O.push("srgba"),t.ext_color_buffer_half_float&&O.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&O.push("rgba32f");var x=["uint8"];t.oes_texture_half_float&&x.push("half float","float16"),t.oes_texture_float&&x.push("float","float32");var S=0,j={};return Ce(_,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof m)return t}return null},create:g,createCube:function(e){function r(e){var n;He(i.indexOf(_.next)<0,"can not update framebuffer which is currently in use");var a=t.webgl_draw_buffers,u={color:null},f=0,c=null,s="rgba",l="uint8",p=1;if("number"==typeof e)f=0|e;else if(e){He.type(e,"object","invalid arguments for framebuffer");var d=e;if("shape"in d){var y=d.shape;He(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),He(y[0]===y[1],"cube framebuffer must be square"),f=y[0]}else"radius"in d&&(f=0|d.radius),"width"in d?(f=0|d.width,"height"in d&&He(d.height===f,"must be square")):"height"in d&&(f=0|d.height);("color"in d||"colors"in d)&&(c=d.color||d.colors,Array.isArray(c)&&He(1===c.length||a,"multiple render targets not supported")),c||("colorCount"in d&&(p=0|d.colorCount,He(p>0,"invalid color buffer count")),"colorType"in d&&(He.oneOf(d.colorType,x,"invalid color type"),l=d.colorType),"colorFormat"in d&&(s=d.colorFormat,He.oneOf(d.colorFormat,w,"invalid color format for texture"))),"depth"in d&&(u.depth=d.depth),"stencil"in d&&(u.stencil=d.stencil),"depthStencil"in d&&(u.depthStencil=d.depthStencil)}else f=1;var m;if(c)if(Array.isArray(c))for(m=[],n=0;n<c.length;++n)m[n]=c[n];else m=[c];else{m=Array(p);var h={radius:f,format:s,type:l};for(n=0;n<p;++n)m[n]=o.createCube(h)}for(u.color=Array(m.length),n=0;n<m.length;++n){var b=m[n];He("function"==typeof b&&"textureCube"===b._reglType,"invalid cube map"),f=f||b.width,He(b.width===f&&b.height===f,"invalid cube map shape"),u.color[n]={target:ur,data:m[n]}}for(n=0;n<6;++n){for(var v=0;v<m.length;++v)u.color[v].target=ur+n;n>0&&(u.depth=i[0].depth,u.stencil=i[0].stencil,u.depthStencil=i[0].depthStencil),i[n]?i[n](u):i[n]=g(u)}return Ce(r,{width:f,height:f,color:m})}var i=Array(6);return r(e),Ce(r,{faces:i,resize:function(e){var t,o=0|e;if(He(o>0&&o<=n.maxCubeMapSize,"invalid radius for cube fbo"),o===r.width)return r;var a=r.color;for(t=0;t<a.length;++t)a[t].resize(o);for(t=0;t<6;++t)i[t].resize(o);return r.width=r.height=o,r},_reglType:"framebufferCube",destroy:function(){i.forEach(function(e){e.destroy()})}})},clear:function(){et(j).forEach(b)},restore:function(){et(j).forEach(function(t){t.framebuffer=e.createFramebuffer(),v(t)})}})}function ye(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Or,this.offset=0,this.stride=0,this.divisor=0}function me(e,t,n,r,o){for(var i=n.maxAttributes,a=new Array(i),u=0;u<i;++u)a[u]=new ye;return{Record:ye,scope:{},state:a}}function he(e,t,n,r){function o(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function i(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function a(n,r,o){var i=n===xr?c:s,a=i[r];if(!a){var u=t.str(r);a=e.createShader(n),e.shaderSource(a,u),e.compileShader(a),He.shaderError(e,a,u,n,o),i[r]=a}return a}function u(e,t){this.id=d++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function f(n,u){var f,c,s=a(xr,n.fragId),l=a(Sr,n.vertId),p=n.program=e.createProgram();e.attachShader(p,s),e.attachShader(p,l),e.linkProgram(p),He.linkError(e,p,t.str(n.fragId),t.str(n.vertId),u);var d=e.getProgramParameter(p,jr);r.profile&&(n.stats.uniformsCount=d);var y=n.uniforms;for(f=0;f<d;++f)if(c=e.getActiveUniform(p,f))if(c.size>1)for(var m=0;m<c.size;++m){var h=c.name.replace("[0]","["+m+"]");i(y,new o(h,t.id(h),e.getUniformLocation(p,h),c))}else i(y,new o(c.name,t.id(c.name),e.getUniformLocation(p,c.name),c));var b=e.getProgramParameter(p,Er);r.profile&&(n.stats.attributesCount=b);var v=n.attributes;for(f=0;f<b;++f)(c=e.getActiveAttrib(p,f))&&i(v,new o(c.name,t.id(c.name),e.getAttribLocation(p,c.name),c))}var c={},s={},l={},p=[],d=0;return r.profile&&(n.getMaxUniformsCount=function(){var e=0;return p.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},n.getMaxAttributesCount=function(){var e=0;return p.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);et(c).forEach(t),c={},et(s).forEach(t),s={},p.forEach(function(t){e.deleteProgram(t.program)}),p.length=0,l={},n.shaderCount=0},program:function(e,t,r){He.command(e>=0,"missing vertex shader",r),He.command(t>=0,"missing fragment shader",r);var o=l[t];o||(o=l[t]={});var i=o[e];return i||(i=new u(t,e),n.shaderCount++,f(i,r),o[e]=i,p.push(i)),i},restore:function(){c={},s={};for(var e=0;e<p.length;++e)f(p[e])},shader:a,frag:-1,vert:-1}}function be(e,t,n,r,o,i){function a(a){var u;null===t.next?(He(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),u=Mr):(He(null!==t.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),u=t.next.colorAttachments[0].texture._texture.type,i.oes_texture_float?He(u===Mr||u===Pr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):He(u===Mr,"Reading from a framebuffer is only allowed for the type 'uint8'"));var f=0,c=0,s=r.framebufferWidth,l=r.framebufferHeight,p=null;Re(a)?p=a:a&&(He.type(a,"object","invalid arguments to regl.read()"),f=0|a.x,c=0|a.y,He(f>=0&&f<r.framebufferWidth,"invalid x offset for regl.read"),He(c>=0&&c<r.framebufferHeight,"invalid y offset for regl.read"),s=0|(a.width||r.framebufferWidth-f),l=0|(a.height||r.framebufferHeight-c),p=a.data||null),p&&(u===Mr?He(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):u===Pr&&He(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),He(s>0&&s+f<=r.framebufferWidth,"invalid width for read pixels"),He(l>0&&l+c<=r.framebufferHeight,"invalid height for read pixels"),n();var d=s*l*4;return p||(u===Mr?p=new Uint8Array(d):u===Pr&&(p=p||new Float32Array(d))),He.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),He(p.byteLength>=d,"data buffer for regl.read() too small"),e.pixelStorei(Lr,4),e.readPixels(f,c,s,l,Ar,u,p),p}function u(e){var n;return t.setFBO({framebuffer:e.framebuffer},function(){n=a(e)}),n}return function(e){return e&&"framebuffer"in e?u(e):a(e)}}function ve(e,t,n,r){function o(e){this.id=-1,this.handle=null,i&&(this.handle=i.createVertexArrayOES(),this.handle&&(this.id=u++)),this.bind=function(){i&&this.handle&&a!==this&&(i.bindVertexArrayOES(this.handle),a=this)},this.unbind=function(){i&&a&&(i.bindVertexArrayOES(null),a=null)},this.destroy=function(){i&&this.handle&&(i.deleteVertexArrayOES(this.handle),u=Math.max(0,u-1),n.vaoCount=u,this.id=-1,this.handle=null)}}var i=t.oes_vertex_array_object,a=null,u=0,f={};return{hasSupport:Boolean(i),create:function(){var t=new o(e);return f[t.id]=t,n.vaoCount=u,t},clear:function(){et(f).forEach(function(e){e&&"function"==typeof e.destroy&&e.destroy()})}}}function ge(e){return Array.prototype.slice.call(e)}function _e(e){return ge(e).join("")}function we(){function e(){var e=[],t=[];return Ce(function(){e.push.apply(e,ge(arguments))},{def:function(){var r="v"+n++;return t.push(r),arguments.length>0&&(e.push(r,"="),e.push.apply(e,ge(arguments)),e.push(";")),r},toString:function(){return _e([t.length>0?"var "+t+";":"",_e(e)])}})}function t(){function t(e,t){r(e,t,"=",n.def(e,t),";")}var n=e(),r=e(),o=n.toString,i=r.toString;return Ce(function(){n.apply(n,ge(arguments))},{def:n.def,entry:n,exit:r,save:t,set:function(e,r,o){t(e,r),n(e,r,"=",o,";")},toString:function(){return o()+i()}})}var n=0,r=[],o=[],i=e(),a={};return{global:i,link:function(e){for(var t=0;t<o.length;++t)if(o[t]===e)return r[t];var i="g"+n++;return r.push(i),o.push(e),i},block:e,proc:function(e,n){function r(){var e="a"+o.length;return o.push(e),e}var o=[];n=n||0;for(var i=0;i<n;++i)r();var u=t(),f=u.toString;return a[e]=Ce(u,{arg:r,toString:function(){return _e(["function(",o.join(),"){",f(),"}"])}})},scope:t,cond:function(){var e=_e(arguments),n=t(),r=t(),o=n.toString,i=r.toString;return Ce(n,{then:function(){return n.apply(n,ge(arguments)),this},else:function(){return r.apply(r,ge(arguments)),this},toString:function(){var t=i();return t&&(t="else{"+t+"}"),_e(["if(",e,"){",o(),"}",t])}})},compile:function(){var e=['"use strict";',i,"return {"];Object.keys(a).forEach(function(t){e.push('"',t,'":',a[t].toString(),",")}),e.push("}");var t=_e(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(t)).apply(null,o)}}}function Oe(e){return Array.isArray(e)||Re(e)||C(e)}function xe(e){return e.sort(function(e,t){return e===po?-1:t===po?1:e<t?-1:1})}function Se(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function je(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function Ee(e){return new Se(!1,!1,!1,e)}function Ae(e,t){var n=e.type;if(n===Ir){var r=e.data.length;return new Se(!0,r>=1,r>=2,t)}if(n===Nr){var o=e.data;return new Se(o.thisDep,o.contextDep,o.propDep,t)}return new Se(n===Gr,n===Vr,n===Dr,t)}function Me(e,t,n,o,i,a,u,f,c,s,l,p,d,y,m,h){function b(e){return e.replace(".","_")}function v(e,t,n){var r=b(e);re.push(e),ne[r]=te[r]=!!n,oe[r]=t}function g(e,t,n){var r=b(e);re.push(e),Array.isArray(n)?(te[r]=n.slice(),ne[r]=n.slice()):te[r]=ne[r]=n,ie[r]=t}function _(){var e=we(),n=e.link,r=e.global;e.id=fe++,e.batchId="0";var o=n(ae),i=e.shared={props:"a0"};Object.keys(ae).forEach(function(e){i[e]=r.def(o,".",e)}),He.optional(function(){e.CHECK=n(He),e.commandStr=He.guessCommand(),e.command=n(e.commandStr),e.assert=function(e,t,r){e("if(!(",t,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},ue.invalidBlendCombinations=Oi});var a=e.next={},u=e.current={};Object.keys(ie).forEach(function(e){Array.isArray(te[e])&&(a[e]=r.def(i.next,".",e),u[e]=r.def(i.current,".",e))});var f=e.constants={};Object.keys(ue).forEach(function(e){f[e]=r.def(JSON.stringify(ue[e]))}),e.invoke=function(t,r){switch(r.type){case Ir:var o=["this",i.context,i.props,e.batchId];return t.def(n(r.data),".call(",o.slice(0,Math.max(r.data.length+1,4)),")");case Dr:return t.def(i.props,r.data);case Vr:return t.def(i.context,r.data);case Gr:return t.def("this",r.data);case Nr:return r.data.append(e,t),r.data.ref}},e.attribCache={};var c={};return e.scopeAttrib=function(e){var r=t.id(e);if(r in c)return c[r];var o=l.scope[r];return o||(o=l.scope[r]=new Q),c[r]=n(o)},e}function w(e){var t,n=e.static,r=e.dynamic;if(yo in n){var o=!!n[yo];(t=Ee(function(e,t){return o})).enable=o}else if(yo in r){var i=r[yo];t=Ae(i,function(e,t){return e.invoke(t,i)})}return t}function O(e,t){var n=e.static,r=e.dynamic;if(mo in n){var o=n[mo];return o?(o=c.getFramebuffer(o),He.command(o,"invalid framebuffer object"),Ee(function(e,t){var n=e.link(o),r=e.shared;t.set(r.framebuffer,".next",n);var i=r.context;return t.set(i,"."+xo,n+".width"),t.set(i,"."+So,n+".height"),n})):Ee(function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var r=n.context;return t.set(r,"."+xo,r+"."+Ao),t.set(r,"."+So,r+"."+Mo),"null"})}if(mo in r){var i=r[mo];return Ae(i,function(e,t){var n=e.invoke(t,i),r=e.shared,o=r.framebuffer,a=t.def(o,".getFramebuffer(",n,")");He.optional(function(){e.assert(t,"!"+n+"||"+a,"invalid framebuffer object")}),t.set(o,".next",a);var u=r.context;return t.set(u,"."+xo,a+"?"+a+".width:"+u+"."+Ao),t.set(u,"."+So,a+"?"+a+".height:"+u+"."+Mo),a})}return null}function x(e,t,n){function r(e){if(e in o){var r=o[e];He.commandType(r,"object","invalid "+e,n.commandStr);var a,u,f=!0,c=0|r.x,s=0|r.y;return"width"in r?(a=0|r.width,He.command(a>=0,"invalid "+e,n.commandStr)):f=!1,"height"in r?(u=0|r.height,He.command(u>=0,"invalid "+e,n.commandStr)):f=!1,new Se(!f&&t&&t.thisDep,!f&&t&&t.contextDep,!f&&t&&t.propDep,function(e,t){var n=e.shared.context,o=a;"width"in r||(o=t.def(n,".",xo,"-",c));var i=u;return"height"in r||(i=t.def(n,".",So,"-",s)),[c,s,o,i]})}if(e in i){var l=i[e],p=Ae(l,function(t,n){var r=t.invoke(n,l);He.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)});var o=t.shared.context,i=n.def(r,".x|0"),a=n.def(r,".y|0"),u=n.def('"width" in ',r,"?",r,".width|0:","(",o,".",xo,"-",i,")"),f=n.def('"height" in ',r,"?",r,".height|0:","(",o,".",So,"-",a,")");return He.optional(function(){t.assert(n,u+">=0&&"+f+">=0","invalid "+e)}),[i,a,u,f]});return t&&(p.thisDep=p.thisDep||t.thisDep,p.contextDep=p.contextDep||t.contextDep,p.propDep=p.propDep||t.propDep),p}return t?new Se(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",xo),t.def(n,".",So)]}):null}var o=e.static,i=e.dynamic,a=r(po);if(a){var u=a;a=new Se(a.thisDep,a.contextDep,a.propDep,function(e,t){var n=u.append(e,t),r=e.shared.context;return t.set(r,"."+jo,n[2]),t.set(r,"."+Eo,n[3]),n})}return{viewport:a,scissor_box:r(lo)}}function S(e){function n(e){if(e in o){var n=t.id(o[e]);He.optional(function(){p.shader(ji[e],n,He.guessCommand())});var r=Ee(function(){return n});return r.id=n,r}if(e in i){var a=i[e];return Ae(a,function(t,n){var r=t.invoke(n,a),o=n.def(t.shared.strings,".id(",r,")");return He.optional(function(){n(t.shared.shader,".shader(",ji[e],",",o,",",t.command,");")}),o})}return null}var r,o=e.static,i=e.dynamic,a=n(bo),u=n(ho),f=null;return je(a)&&je(u)?(f=p.program(u.id,a.id),r=Ee(function(e,t){return e.link(f)})):r=new Se(a&&a.thisDep||u&&u.thisDep,a&&a.contextDep||u&&u.contextDep,a&&a.propDep||u&&u.propDep,function(e,t){var n,r=e.shared.shader;n=a?a.append(e,t):t.def(r,".",bo);var o,i=r+".program("+(o=u?u.append(e,t):t.def(r,".",ho))+","+n;return He.optional(function(){i+=","+e.command}),t.def(i+")")}),{frag:a,vert:u,progVar:r,program:f}}function j(e,t){function n(e,n){if(e in r){var a=0|r[e];return He.command(!n||a>=0,"invalid "+e,t.commandStr),Ee(function(e,t){return n&&(e.OFFSET=a),a})}if(e in o){var u=o[e];return Ae(u,function(t,r){var o=t.invoke(r,u);return n&&(t.OFFSET=o,He.optional(function(){t.assert(r,o+">=0","invalid "+e)})),o})}return n&&i?Ee(function(e,t){return e.OFFSET="0",0}):null}var r=e.static,o=e.dynamic,i=function(){if(vo in r){var e=r[vo];Oe(e)?e=u.getElements(u.create(e,!0)):e&&(e=u.getElements(e),He.command(e,"invalid elements",t.commandStr));var n=Ee(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r,r}return t.ELEMENTS=null,null});return n.value=e,n}if(vo in o){var i=o[vo];return Ae(i,function(e,t){var n=e.shared,r=n.isBufferArgs,o=n.elements,a=e.invoke(t,i),u=t.def("null"),f=t.def(r,"(",a,")"),c=e.cond(f).then(u,"=",o,".createStream(",a,");").else(u,"=",o,".getElements(",a,");");return He.optional(function(){e.assert(c.else,"!"+a+"||"+u,"invalid elements")}),t.entry(c),t.exit(e.cond(f).then(o,".destroyStream(",u,");")),e.ELEMENTS=u,u})}return null}(),a=n(wo,!0);return{elements:i,primitive:function(){if(go in r){var e=r[go];return He.commandParameter(e,_t,"invalid primitve",t.commandStr),Ee(function(t,n){return _t[e]})}if(go in o){var n=o[go];return Ae(n,function(e,t){var r=e.constants.primTypes,o=e.invoke(t,n);return He.optional(function(){e.assert(t,o+" in "+r,"invalid primitive, must be one of "+Object.keys(_t))}),t.def(r,"[",o,"]")})}return i?je(i)?Ee(i.value?function(e,t){return t.def(e.ELEMENTS,".primType")}:function(){return ai}):new Se(i.thisDep,i.contextDep,i.propDep,function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",ai)}):null}(),count:function(){if(_o in r){var e=0|r[_o];return He.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),Ee(function(){return e})}if(_o in o){var n=o[_o];return Ae(n,function(e,t){var r=e.invoke(t,n);return He.optional(function(){e.assert(t,"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")}),r})}if(i){if(je(i)){if(i)return a?new Se(a.thisDep,a.contextDep,a.propDep,function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return He.optional(function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")}),n}):Ee(function(e,t){return t.def(e.ELEMENTS,".vertCount")});var u=Ee(function(){return-1});return He.optional(function(){u.MISSING=!0}),u}var f=new Se(i.thisDep||a.thisDep,i.contextDep||a.contextDep,i.propDep||a.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")});return He.optional(function(){f.DYNAMIC=!0}),f}return null}(),instances:n(Oo,!1),offset:a}}function E(e,t){var n=e.static,i=e.dynamic,a={};return re.forEach(function(e){function u(t,r){if(e in n){var o=t(n[e]);a[f]=Ee(function(){return o})}else if(e in i){var u=i[e];a[f]=Ae(u,function(e,t){return r(e,t,e.invoke(t,u))})}}var f=b(e);switch(e){case $r:case Br:case Fr:case io:case Xr:case so:case eo:case no:case ro:case Wr:return u(function(n){return He.commandType(n,"boolean",e,t.commandStr),n},function(t,n,r){return He.optional(function(){t.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+e,t.commandStr)}),r});case qr:return u(function(n){return He.commandParameter(n,xi,"invalid "+e,t.commandStr),xi[n]},function(t,n,r){var o=t.constants.compareFuncs;return He.optional(function(){t.assert(n,r+" in "+o,"invalid "+e+", must be one of "+Object.keys(xi))}),n.def(o,"[",r,"]")});case Hr:return u(function(e){return He.command(K(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e},function(e,t,n){return He.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")}),[t.def("+",n,"[0]"),t.def("+",n,"[1]")]});case zr:return u(function(e){He.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,o="dstRGB"in e?e.dstRGB:e.dst,i="dstAlpha"in e?e.dstAlpha:e.dst;return He.commandParameter(n,wi,f+".srcRGB",t.commandStr),He.commandParameter(r,wi,f+".srcAlpha",t.commandStr),He.commandParameter(o,wi,f+".dstRGB",t.commandStr),He.commandParameter(i,wi,f+".dstAlpha",t.commandStr),He.command(-1===Oi.indexOf(n+", "+o),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+o+")",t.commandStr),[wi[n],wi[o],wi[r],wi[i]]},function(t,n,r){function o(o,a){var u=n.def('"',o,a,'" in ',r,"?",r,".",o,a,":",r,".",o);return He.optional(function(){t.assert(n,u+" in "+i,"invalid "+e+"."+o+a+", must be one of "+Object.keys(wi))}),u}var i=t.constants.blendFuncs;He.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")});var a=o("src","RGB"),u=o("dst","RGB");He.optional(function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+a+'+", "+'+u+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var f=n.def(i,"[",a,"]"),c=n.def(i,"[",o("src","Alpha"),"]");return[f,n.def(i,"[",u,"]"),c,n.def(i,"[",o("dst","Alpha"),"]")]});case Yr:return u(function(n){return"string"==typeof n?(He.commandParameter(n,Z,"invalid "+e,t.commandStr),[Z[n],Z[n]]):"object"===(void 0===n?"undefined":r(n))?(He.commandParameter(n.rgb,Z,e+".rgb",t.commandStr),He.commandParameter(n.alpha,Z,e+".alpha",t.commandStr),[Z[n.rgb],Z[n.alpha]]):void He.commandRaise("invalid blend.equation",t.commandStr)},function(t,n,r){var o=t.constants.blendEquations,i=n.def(),a=n.def(),u=t.cond("typeof ",r,'==="string"');return He.optional(function(){function n(e,n,r){t.assert(e,r+" in "+o,"invalid "+n+", must be one of "+Object.keys(Z))}n(u.then,e,r),t.assert(u.else,r+"&&typeof "+r+'==="object"',"invalid "+e),n(u.else,e+".rgb",r+".rgb"),n(u.else,e+".alpha",r+".alpha")}),u.then(i,"=",a,"=",o,"[",r,"];"),u.else(i,"=",o,"[",r,".rgb];",a,"=",o,"[",r,".alpha];"),n(u),[i,a]});case Ur:return u(function(e){return He.command(K(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),k(4,function(t){return+e[t]})},function(e,t,n){return He.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")}),k(4,function(e){return t.def("+",n,"[",e,"]")})});case ao:return u(function(e){return He.commandType(e,"number",f,t.commandStr),0|e},function(e,t,n){return He.optional(function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")}),t.def(n,"|0")});case uo:return u(function(n){He.commandType(n,"object",f,t.commandStr);var r=n.cmp||"keep",o=n.ref||0,i="mask"in n?n.mask:-1;return He.commandParameter(r,xi,e+".cmp",t.commandStr),He.commandType(o,"number",e+".ref",t.commandStr),He.commandType(i,"number",e+".mask",t.commandStr),[xi[r],o,i]},function(e,t,n){var r=e.constants.compareFuncs;return He.optional(function(){function o(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}o(n+"&&typeof ",n,'==="object"'),o('!("cmp" in ',n,")||(",n,".cmp in ",r,")")}),[t.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",yi),t.def(n,".ref|0"),t.def('"mask" in ',n,"?",n,".mask|0:-1")]});case fo:case co:return u(function(n){He.commandType(n,"object",f,t.commandStr);var r=n.fail||"keep",o=n.zfail||"keep",i=n.zpass||"keep";return He.commandParameter(r,Si,e+".fail",t.commandStr),He.commandParameter(o,Si,e+".zfail",t.commandStr),He.commandParameter(i,Si,e+".zpass",t.commandStr),[e===co?fi:ui,Si[r],Si[o],Si[i]]},function(t,n,r){function o(o){return He.optional(function(){t.assert(n,'!("'+o+'" in '+r+")||("+r+"."+o+" in "+i+")","invalid "+e+"."+o+", must be one of "+Object.keys(Si))}),n.def('"',o,'" in ',r,"?",i,"[",r,".",o,"]:",yi)}var i=t.constants.stencilOps;return He.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}),[e===co?fi:ui,o("fail"),o("zfail"),o("zpass")]});case to:return u(function(e){He.commandType(e,"object",f,t.commandStr);var n=0|e.factor,r=0|e.units;return He.commandType(n,"number",f+".factor",t.commandStr),He.commandType(r,"number",f+".units",t.commandStr),[n,r]},function(t,n,r){return He.optional(function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}),[n.def(r,".factor|0"),n.def(r,".units|0")]});case Qr:return u(function(e){var n=0;return"front"===e?n=ui:"back"===e&&(n=fi),He.command(!!n,f,t.commandStr),n},function(e,t,n){return He.optional(function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")}),t.def(n,'==="front"?',ui,":",fi)});case Jr:return u(function(e){return He.command("number"==typeof e&&e>=o.lineWidthDims[0]&&e<=o.lineWidthDims[1],"invalid line width, must positive number between "+o.lineWidthDims[0]+" and "+o.lineWidthDims[1],t.commandStr),e},function(e,t,n){return He.optional(function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+o.lineWidthDims[0]+"&&"+n+"<="+o.lineWidthDims[1],"invalid line width")}),n});case Zr:return u(function(e){return He.commandParameter(e,Ei,f,t.commandStr),Ei[e]},function(e,t,n){return He.optional(function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),t.def(n+'==="cw"?'+ci+":"+si)});case Kr:return u(function(e){return He.command(K(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map(function(e){return!!e})},function(e,t,n){return He.optional(function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")}),k(4,function(e){return"!!"+n+"["+e+"]"})});case oo:return u(function(e){He.command("object"===(void 0===e?"undefined":r(e))&&e,f,t.commandStr);var n="value"in e?e.value:1,o=!!e.invert;return He.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,o]},function(e,t,n){return He.optional(function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")}),[t.def('"value" in ',n,"?+",n,".value:1"),t.def("!!",n,".invert")]})}}),a}function A(e,t){var n=e.static,r=e.dynamic,o={};return Object.keys(n).forEach(function(e){var r,i=n[e];if("number"==typeof i||"boolean"==typeof i)r=Ee(function(){return i});else if("function"==typeof i){var a=i._reglType;"texture2d"===a||"textureCube"===a?r=Ee(function(e){return e.link(i)}):"framebuffer"===a||"framebufferCube"===a?(He.command(i.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),r=Ee(function(e){return e.link(i.color[0])})):He.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else K(i)?r=Ee(function(t){return t.global.def("[",k(i.length,function(n){return He.command("number"==typeof i[n]||"boolean"==typeof i[n],"invalid uniform "+e,t.commandStr),i[n]}),"]")}):He.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);r.value=i,o[e]=r}),Object.keys(r).forEach(function(e){var t=r[e];o[e]=Ae(t,function(e,n){return e.invoke(n,t)})}),o}function M(e,n){var o=e.static,i=e.dynamic,u={};return Object.keys(o).forEach(function(e){var i=o[e],f=t.id(e),c=new Q;if(Oe(i))c.state=Cr,c.buffer=a.getBuffer(a.create(i,Po,!1,!0)),c.type=0;else{var s=a.getBuffer(i);if(s)c.state=Cr,c.buffer=s,c.type=0;else if(He.command("object"===(void 0===i?"undefined":r(i))&&i,"invalid data for attribute "+e,n.commandStr),i.constant){var l=i.constant;c.buffer="null",c.state=kr,"number"==typeof l?c.x=l:(He.command(K(l)&&l.length>0&&l.length<=4,"invalid constant for attribute "+e,n.commandStr),Tr.forEach(function(e,t){t<l.length&&(c[e]=l[t])}))}else{s=Oe(i.buffer)?a.getBuffer(a.create(i.buffer,Po,!1,!0)):a.getBuffer(i.buffer),He.command(!!s,'missing buffer for attribute "'+e+'"',n.commandStr);var p=0|i.offset;He.command(p>=0,'invalid offset for attribute "'+e+'"',n.commandStr);var d=0|i.stride;He.command(d>=0&&d<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',n.commandStr);var y=0|i.size;He.command(!("size"in i)||y>0&&y<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',n.commandStr);var m=!!i.normalized,h=0;"type"in i&&(He.commandParameter(i.type,lt,"invalid type for attribute "+e,n.commandStr),h=lt[i.type]);var b=0|i.divisor;"divisor"in i&&(He.command(0===b||J,'cannot specify divisor for attribute "'+e+'", instancing not supported',n.commandStr),He.command(b>=0,'invalid divisor for attribute "'+e+'"',n.commandStr)),He.optional(function(){var t=n.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach(function(n){He.command(r.indexOf(n)>=0,'unknown parameter "'+n+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",t)})}),c.buffer=s,c.state=Cr,c.size=y,c.normalized=m,c.type=h||s.dtype,c.offset=p,c.stride=d,c.divisor=b}}u[e]=Ee(function(e,t){var n=e.attribCache;if(f in n)return n[f];var r={isStream:!1};return Object.keys(c).forEach(function(e){r[e]=c[e]}),c.buffer&&(r.buffer=e.link(c.buffer),r.type=r.type||r.buffer+".dtype"),n[f]=r,r})}),Object.keys(i).forEach(function(e){var t=i[e];u[e]=Ae(t,function(n,r){function o(e){r(c[e],"=",i,".",e,"|0;")}var i=n.invoke(r,t),a=n.shared,u=a.isBufferArgs,f=a.buffer;He.optional(function(){n.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+u+"("+i+")||"+f+".getBuffer("+i+")||"+f+".getBuffer("+i+".buffer)||"+u+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+a.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+e+'"')});var c={isStream:r.def(!1)},s=new Q;s.state=Cr,Object.keys(s).forEach(function(e){c[e]=r.def(""+s[e])});var l=c.buffer,p=c.type;return r("if(",u,"(",i,")){",c.isStream,"=true;",l,"=",f,".createStream(",Po,",",i,");",p,"=",l,".dtype;","}else{",l,"=",f,".getBuffer(",i,");","if(",l,"){",p,"=",l,".dtype;",'}else if("constant" in ',i,"){",c.state,"=",kr,";","if(typeof "+i+'.constant === "number"){',c[Tr[0]],"=",i,".constant;",Tr.slice(1).map(function(e){return c[e]}).join("="),"=0;","}else{",Tr.map(function(e,t){return c[e]+"="+i+".constant.length>="+t+"?"+i+".constant["+t+"]:0;"}).join(""),"}}else{","if(",u,"(",i,".buffer)){",l,"=",f,".createStream(",Po,",",i,".buffer);","}else{",l,"=",f,".getBuffer(",i,".buffer);","}",p,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",l,".dtype;",c.normalized,"=!!",i,".normalized;"),o("size"),o("offset"),o("stride"),o("divisor"),r("}}"),r.exit("if(",c.isStream,"){",f,".destroyStream(",l,");","}"),c})}),u}function L(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=Ee(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=Ae(t,function(e,n){return e.invoke(n,t)})}),r}function P(e,t,n,r,o){function a(e){var t=s[e];t&&(p[e]=t)}var u=e.static,f=e.dynamic;He.optional(function(){function e(e){Object.keys(e).forEach(function(e){He.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',o.commandStr)})}var t=[mo,ho,bo,vo,go,wo,_o,Oo,yo].concat(re);e(u),e(f)});var c=O(e,o),s=x(e,c,o),l=j(e,o),p=E(e,o),d=S(e,o);a(po),a(b(lo));var y=Object.keys(p).length>0,m={framebuffer:c,draw:l,shader:d,state:p,dirty:y};return m.profile=w(e,o),m.uniforms=A(n,o),m.attributes=M(t,o),m.context=L(r,o),Object.keys(m.attributes).length&&i.hasSupport&&(m.vao=i.create()),m}function T(e,t,n){var r=e.shared.context,o=e.scope();Object.keys(n).forEach(function(i){t.save(r,"."+i);var a=n[i];o(r,".",i,"=",a.append(e,t),";")}),t(o)}function R(e,t,n,r){var o,i=e.shared,a=i.gl,u=i.framebuffer;ee&&(o=t.def(i.extensions,".webgl_draw_buffers"));var f,c=e.constants,s=c.drawBuffer,l=c.backBuffer;f=n?n.append(e,t):t.def(u,".next"),r||t("if(",f,"!==",u,".cur){"),t("if(",f,"){",a,".bindFramebuffer(",gi,",",f,".framebuffer);"),ee&&t(o,".drawBuffersWEBGL(",s,"[",f,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",gi,",null);"),ee&&t(o,".drawBuffersWEBGL(",l,");"),t("}",u,".cur=",f,";"),r||t("}")}function C(e,t,n){var r=e.shared,o=r.gl,i=e.current,a=e.next,u=r.current,f=r.next,c=e.cond(u,".dirty");re.forEach(function(t){var r=b(t);if(!(r in n.state)){var s,l;if(r in a){s=a[r],l=i[r];var p=k(te[r].length,function(e){return c.def(s,"[",e,"]")});c(e.cond(p.map(function(e,t){return e+"!=="+l+"["+t+"]"}).join("||")).then(o,".",ie[r],"(",p,");",p.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";"))}else{s=c.def(f,".",r);var d=e.cond(s,"!==",u,".",r);c(d),r in oe?d(e.cond(s).then(o,".enable(",oe[r],");").else(o,".disable(",oe[r],");"),u,".",r,"=",s,";"):d(o,".",ie[r],"(",s,");",u,".",r,"=",s,";")}}}),0===Object.keys(n.state).length&&c(u,".dirty=false;"),t(c)}function I(e,t,n,r){var o=e.shared,i=e.current,a=o.current,u=o.gl;xe(Object.keys(n)).forEach(function(o){var f=n[o];if(!r||r(f)){var c=f.append(e,t);if(oe[o]){var s=oe[o];je(f)?c?t(u,".enable(",s,");"):t(u,".disable(",s,");"):t(e.cond(c).then(u,".enable(",s,");").else(u,".disable(",s,");")),t(a,".",o,"=",c,";")}else if(K(c)){var l=i[o];t(u,".",ie[o],"(",c,");",c.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";")}else t(u,".",ie[o],"(",c,");",a,".",o,"=",c,";")}})}function D(e,t){J&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function V(e,t,n,r,o){function i(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function a(e){e(c=t.def(),"=",i(),";"),"string"==typeof o?e(d,".count+=",o,";"):e(d,".count++;"),m&&(r?e(s=t.def(),"=",h,".getNumPendingQueries();"):e(h,".beginQuery(",d,");"))}function u(e){e(d,".cpuTime+=",i(),"-",c,";"),m&&(r?e(h,".pushScopeStats(",s,",",h,".getNumPendingQueries(),",d,");"):e(h,".endQuery();"))}function f(e){var n=t.def(y,".profile");t(y,".profile=",e,";"),t.exit(y,".profile=",n,";")}var c,s,l,p=e.shared,d=e.stats,y=p.current,h=p.timer,b=n.profile;if(b){if(je(b))return void(b.enable?(a(t),u(t.exit),f("true")):f("false"));f(l=b.append(e,t))}else l=t.def(y,".profile");var v=e.block();a(v),t("if(",l,"){",v,"}");var g=e.block();u(g),t.exit("if(",l,"){",g,"}")}function G(e,t,n,r,o){function a(e){switch(e){case zo:case Wo:case Zo:return 2;case Xo:case Ko:case Jo:return 3;case qo:case $o:case ei:return 4;default:return 1}}function u(n,r,o){function i(){t("if(!",s,".buffer){",u,".enableVertexAttribArray(",c,");}");var n,i=o.type;if(n=o.size?t.def(o.size,"||",r):r,t("if(",s,".type!==",i,"||",s,".size!==",n,"||",y.map(function(e){return s+"."+e+"!=="+o[e]}).join("||"),"){",u,".bindBuffer(",Po,",",p,".buffer);",u,".vertexAttribPointer(",[c,n,i,o.normalized,o.stride,o.offset],");",s,".type=",i,";",s,".size=",n,";",y.map(function(e){return s+"."+e+"="+o[e]+";"}).join(""),"}"),J){var a=o.divisor;t("if(",s,".divisor!==",a,"){",e.instancing,".vertexAttribDivisorANGLE(",[c,a],");",s,".divisor=",a,";}")}}function a(){t("if(",s,".buffer){",u,".disableVertexAttribArray(",c,");","}if(",Tr.map(function(e,t){return s+"."+e+"!=="+d[t]}).join("||"),"){",u,".vertexAttrib4f(",c,",",d,");",Tr.map(function(e,t){return s+"."+e+"="+d[t]+";"}).join(""),"}")}var u=f.gl,c=t.def(n,".location"),s=t.def(f.attributes,"[",c,"]"),l=o.state,p=o.buffer,d=[o.x,o.y,o.z,o.w],y=["buffer","normalized","offset","stride"];l===Cr?i():l===kr?a():(t("if(",l,"===",Cr,"){"),i(),t("}else{"),a(),t("}"))}var f=e.shared,c=r.length&&i.hasSupport?e.link(n.vao):null;c&&t("if(",c,"){",c,".bind(); }"),r.forEach(function(r){var i,f=r.name,c=n.attributes[f];if(c){if(!o(c))return;i=c.append(e,t)}else{if(!o(Ai))return;var s=e.scopeAttrib(f);He.optional(function(){e.assert(t,s+".state","missing attribute "+f)}),i={},Object.keys(new Q).forEach(function(e){i[e]=t.def(s,".",e)})}u(e.link(r),a(r.info.type),i)})}function N(e,n,r,o,i){for(var a,u=e.shared,f=u.gl,c=0;c<o.length;++c){var s,l=o[c],p=l.name,d=l.info.type,y=r.uniforms[p],m=e.link(l)+".location";if(y){if(!i(y))continue;if(je(y)){var h=y.value;if(He.command(null!==h&&void 0!==h,'missing uniform "'+p+'"',e.commandStr),d===oi||d===ii){He.command("function"==typeof h&&(d===oi&&("texture2d"===h._reglType||"framebuffer"===h._reglType)||d===ii&&("textureCube"===h._reglType||"framebufferCube"===h._reglType)),"invalid texture for uniform "+p,e.commandStr);var b=e.link(h._texture||h.color[0]._texture);n(f,".uniform1i(",m,",",b+".bind());"),n.exit(b,".unbind();")}else if(d===ti||d===ni||d===ri){He.optional(function(){He.command(K(h),"invalid matrix for uniform "+p,e.commandStr),He.command(d===ti&&4===h.length||d===ni&&9===h.length||d===ri&&16===h.length,"invalid length for matrix uniform "+p,e.commandStr)});var v=e.global.def("new Float32Array(["+Array.prototype.slice.call(h)+"])"),g=2;d===ni?g=3:d===ri&&(g=4),n(f,".uniformMatrix",g,"fv(",m,",false,",v,");")}else{switch(d){case Yo:He.commandType(h,"number","uniform "+p,e.commandStr),a="1f";break;case zo:He.command(K(h)&&2===h.length,"uniform "+p,e.commandStr),a="2f";break;case Xo:He.command(K(h)&&3===h.length,"uniform "+p,e.commandStr),a="3f";break;case qo:He.command(K(h)&&4===h.length,"uniform "+p,e.commandStr),a="4f";break;case Qo:He.commandType(h,"boolean","uniform "+p,e.commandStr),a="1i";break;case Ho:He.commandType(h,"number","uniform "+p,e.commandStr),a="1i";break;case Zo:case Wo:He.command(K(h)&&2===h.length,"uniform "+p,e.commandStr),a="2i";break;case Jo:case Ko:He.command(K(h)&&3===h.length,"uniform "+p,e.commandStr),a="3i";break;case ei:case $o:He.command(K(h)&&4===h.length,"uniform "+p,e.commandStr),a="4i"}n(f,".uniform",a,"(",m,",",K(h)?Array.prototype.slice.call(h):h,");")}continue}s=y.append(e,n)}else{if(!i(Ai))continue;s=n.def(u.uniforms,"[",t.id(p),"]")}d===oi?n("if(",s,"&&",s,'._reglType==="framebuffer"){',s,"=",s,".color[0];","}"):d===ii&&n("if(",s,"&&",s,'._reglType==="framebufferCube"){',s,"=",s,".color[0];","}"),He.optional(function(){function t(t,r){e.assert(n,t,'bad data or missing for uniform "'+p+'".  '+r)}function r(e){t("typeof "+s+'==="'+e+'"',"invalid type, expected "+e)}function o(n,r){t(u.isArrayLike+"("+s+")&&"+s+".length==="+n,"invalid vector, should have length "+n,e.commandStr)}function i(n){t("typeof "+s+'==="function"&&'+s+'._reglType==="texture'+(n===Ro?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(d){case Ho:r("number");break;case Wo:o(2);break;case Ko:o(3);break;case $o:o(4);break;case Yo:r("number");break;case zo:o(2);break;case Xo:o(3);break;case qo:o(4);break;case Qo:r("boolean");break;case Zo:o(2);break;case Jo:o(3);break;case ei:case ti:o(4);break;case ni:o(9);break;case ri:o(16);break;case oi:i(Ro);break;case ii:i(Co)}});var _=1;switch(d){case oi:case ii:var w=n.def(s,"._texture");n(f,".uniform1i(",m,",",w,".bind());"),n.exit(w,".unbind();");continue;case Ho:case Qo:a="1i";break;case Wo:case Zo:a="2i",_=2;break;case Ko:case Jo:a="3i",_=3;break;case $o:case ei:a="4i",_=4;break;case Yo:a="1f";break;case zo:a="2f",_=2;break;case Xo:a="3f",_=3;break;case qo:a="4f",_=4;break;case ti:a="Matrix2fv";break;case ni:a="Matrix3fv";break;case ri:a="Matrix4fv"}if(n(f,".uniform",a,"(",m,","),"M"===a.charAt(0)){var O=Math.pow(d-ti+2,2),x=e.global.def("new Float32Array(",O,")");n("false,(Array.isArray(",s,")||",s," instanceof Float32Array)?",s,":(",k(O,function(e){return x+"["+e+"]="+s+"["+e+"]"}),",",x,")")}else n(_>1?k(_,function(e){return s+"["+e+"]"}):s);n(");")}}function F(e,t,n,r){function o(o){var i=s[o];return i?i.contextDep&&r.contextDynamic||i.propDep?i.append(e,n):i.append(e,t):t.def(c,".",o)}function i(){function e(){n(h,".drawElementsInstancedANGLE(",[p,y,b,d+"<<(("+b+"-"+Rr+")>>1)",m],");")}function t(){n(h,".drawArraysInstancedANGLE(",[p,d,y,m],");")}l?v?e():(n("if(",l,"){"),e(),n("}else{"),t(),n("}")):t()}function a(){function e(){n(f+".drawElements("+[p,y,b,d+"<<(("+b+"-"+Rr+")>>1)"]+");")}function t(){n(f+".drawArrays("+[p,d,y]+");")}l?v?e():(n("if(",l,"){"),e(),n("}else{"),t(),n("}")):t()}var u=e.shared,f=u.gl,c=u.draw,s=r.draw,l=function(){var o,i=s.elements,a=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(a=n),o=i.append(e,a)):o=a.def(c,".",vo),o&&a("if("+o+")"+f+".bindBuffer("+To+","+o+".buffer.buffer);"),o}(),p=o(go),d=o(wo),y=function(){var o,i=s.count,a=t;return i?((i.contextDep&&r.contextDynamic||i.propDep)&&(a=n),o=i.append(e,a),He.optional(function(){i.MISSING&&e.assert(t,"false","missing vertex count"),i.DYNAMIC&&e.assert(a,o+">=0","missing vertex count")})):(o=a.def(c,".",_o),He.optional(function(){e.assert(a,o+">=0","missing vertex count")})),o}();if("number"==typeof y){if(0===y)return}else n("if(",y,"){"),n.exit("}");var m,h;J&&(m=o(Oo),h=e.instancing);var b=l+".type",v=s.elements&&je(s.elements);J&&("number"!=typeof m||m>=0)?"string"==typeof m?(n("if(",m,">0){"),i(),n("}else if(",m,"<0){"),a(),n("}")):i():a()}function B(e,t,n,r,o){var i=_(),a=i.proc("body",o);return He.optional(function(){i.commandStr=t.commandStr,i.command=i.link(t.commandStr)}),J&&(i.instancing=a.def(i.shared.extensions,".angle_instanced_arrays")),e(i,a,n,r),i.compile().body}function U(e,t,n,r){D(e,t),G(e,t,n,r.attributes,function(){return!0}),N(e,t,n,r.uniforms,function(){return!0}),F(e,t,t,n)}function Y(e,t){var n=e.proc("draw",1);D(e,n),T(e,n,t.context),R(e,n,t.framebuffer),C(e,n,t),I(e,n,t.state),V(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)U(e,n,t,t.shader.program);else{var o=e.global.def("{}"),i=n.def(r,".id"),a=n.def(o,"[",i,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",o,"[",i,"]=",e.link(function(n){return B(U,e,t,n,1)}),"(",r,");",a,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}function z(e,t,n,r){function o(){return!0}e.batchId="a1",D(e,t),G(e,t,n,r.attributes,o),N(e,t,n,r.uniforms,o),F(e,t,t,n)}function X(e,t,n,r){function o(e){return e.contextDep&&a||e.propDep}function i(e){return!o(e)}D(e,t);var a=n.contextDep,u=t.def(),f=t.def();e.shared.props=f,e.batchId=u;var c=e.scope(),s=e.scope();if(t(c.entry,"for(",u,"=0;",u,"<","a1",";++",u,"){",f,"=","a0","[",u,"];",s,"}",c.exit),n.needsContext&&T(e,s,n.context),n.needsFramebuffer&&R(e,s,n.framebuffer),I(e,s,n.state,o),n.profile&&o(n.profile)&&V(e,s,n,!1,!0),r)G(e,c,n,r.attributes,i),G(e,s,n,r.attributes,o),N(e,c,n,r.uniforms,i),N(e,s,n,r.uniforms,o),F(e,c,s,n);else{var l=e.global.def("{}"),p=n.shader.progVar.append(e,s),d=s.def(p,".id"),y=s.def(l,"[",d,"]");s(e.shared.gl,".useProgram(",p,".program);","if(!",y,"){",y,"=",l,"[",d,"]=",e.link(function(t){return B(z,e,n,t,2)}),"(",p,");}",y,".call(this,a0[",u,"],",u,");")}}function q(e,t){function n(e){return e.contextDep&&o||e.propDep}var r=e.proc("batch",2);e.batchId="0",D(e,r);var o=!1,i=!0;Object.keys(t.context).forEach(function(e){o=o||t.context[e].propDep}),o||(T(e,r,t.context),i=!1);var a=t.framebuffer,u=!1;a?(a.propDep?o=u=!0:a.contextDep&&o&&(u=!0),u||R(e,r,a)):R(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(o=!0),C(e,r,t),I(e,r,t.state,function(e){return!n(e)}),t.profile&&n(t.profile)||V(e,r,t,!1,"a1"),t.contextDep=o,t.needsContext=i,t.needsFramebuffer=u;var f=t.shader.progVar;if(f.contextDep&&o||f.propDep)X(e,r,t,null);else{var c=f.append(e,r);if(r(e.shared.gl,".useProgram(",c,".program);"),t.shader.program)X(e,r,t,t.shader.program);else{var s=e.global.def("{}"),l=r.def(c,".id"),p=r.def(s,"[",l,"]");r(e.cond(p).then(p,".call(this,a0,a1);").else(p,"=",s,"[",l,"]=",e.link(function(n){return B(X,e,t,n,2)}),"(",c,");",p,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&r(e.shared.current,".dirty=true;")}function H(e,n){function r(t){var r=n.shader[t];r&&o.set(i.shader,"."+t,r.append(e,o))}var o=e.proc("scope",3);e.batchId="a2";var i=e.shared,a=i.current;T(e,o,n.context),n.framebuffer&&n.framebuffer.append(e,o),xe(Object.keys(n.state)).forEach(function(t){var r=n.state[t].append(e,o);K(r)?r.forEach(function(n,r){o.set(e.next[t],"["+r+"]",n)}):o.set(i.next,"."+t,r)}),V(e,o,n,!0,!0),[vo,wo,_o,Oo,go].forEach(function(t){var r=n.draw[t];r&&o.set(i.draw,"."+t,""+r.append(e,o))}),Object.keys(n.uniforms).forEach(function(r){o.set(i.uniforms,"["+t.id(r)+"]",n.uniforms[r].append(e,o))}),Object.keys(n.attributes).forEach(function(t){var r=n.attributes[t].append(e,o),i=e.scopeAttrib(t);Object.keys(new Q).forEach(function(e){o.set(i,"."+e,r[e])})}),r(ho),r(bo),Object.keys(n.state).length>0&&(o(a,".dirty=true;"),o.exit(a,".dirty=true;")),o("a1(",e.shared.context,",a0,",e.batchId,");")}function W(e){if("object"===(void 0===e?"undefined":r(e))&&!K(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if($e.isDynamic(e[t[n]]))return!0;return!1}}function $(e,t,n){var o=t.static[n];if(o&&W(o)){var i=e.global,a=Object.keys(o),u=!1,f=!1,c=!1,s=e.global.def("{}");a.forEach(function(t){var n=o[t];if($e.isDynamic(n)){"function"==typeof n&&(n=o[t]=$e.unbox(n));var a=Ae(n,null);u=u||a.thisDep,c=c||a.propDep,f=f||a.contextDep}else{switch(i(s,".",t,"="),void 0===n?"undefined":r(n)){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(e.link(n))}i(";")}}),t.dynamic[n]=new $e.DynamicVariable(Nr,{thisDep:u,contextDep:f,propDep:c,ref:s,append:function(e,t){a.forEach(function(n){var r=o[n];if($e.isDynamic(r)){var i=e.invoke(t,r);t(s,".",n,"=",i,";")}})}}),delete t.static[n]}}var Q=l.Record,Z={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(Z.min=li,Z.max=pi);var J=n.angle_instanced_arrays,ee=n.webgl_draw_buffers,te={dirty:!0,profile:h.profile},ne={},re=[],oe={},ie={};v(Fr,Do),v(Br,Io),g(Ur,"blendColor",[0,0,0,0]),g(Yr,"blendEquationSeparate",[bi,bi]),g(zr,"blendFuncSeparate",[hi,mi,hi,mi]),v(Xr,Go,!0),g(qr,"depthFunc",vi),g(Hr,"depthRange",[0,1]),g(Wr,"depthMask",!0),g(Kr,Kr,[!0,!0,!0,!0]),v($r,ko),g(Qr,"cullFace",fi),g(Zr,Zr,si),g(Jr,Jr,1),v(eo,Fo),g(to,"polygonOffset",[0,0]),v(no,Bo),v(ro,Uo),g(oo,"sampleCoverage",[1,!1]),v(io,Vo),g(ao,"stencilMask",-1),g(uo,"stencilFunc",[di,0,-1]),g(fo,"stencilOpSeparate",[ui,yi,yi,yi]),g(co,"stencilOpSeparate",[fi,yi,yi,yi]),v(so,No),g(lo,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),g(po,po,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var ae={gl:e,context:y,strings:t,next:ne,current:te,draw:d,elements:u,vao:i,buffer:a,shader:p,attributes:l.state,uniforms:s,framebuffer:c,extensions:n,timer:m,isBufferArgs:Oe},ue={primTypes:_t,compareFuncs:xi,blendFuncs:wi,blendEquations:Z,stencilOps:Si,glTypes:lt,orientationType:Ei};He.optional(function(){ae.isArrayLike=K}),ee&&(ue.backBuffer=[fi],ue.drawBuffer=k(o.maxDrawbuffers,function(e){return 0===e?[0]:k(e,function(e){return _i+e})}));var fe=0;return{next:ne,current:te,compile:function(e,t,n,r,o){var i=_();i.stats=i.link(o),Object.keys(t.static).forEach(function(e){$(i,t,e)}),Lo.forEach(function(t){$(i,e,t)});var a=P(e,t,n,r,i);return Y(i,a),H(i,a),q(i,a),i.compile()},procs:function(){var t=_(),n=t.proc("poll"),r=t.proc("refresh"),i=t.block();n(i),r(i);var a=t.shared,u=a.gl,f=a.next,c=a.current;i(c,".dirty=false;"),R(t,n),R(t,r,null,!0);var s,l=e.getExtension("angle_instanced_arrays");l&&(s=t.link(l));for(var p=0;p<o.maxAttributes;++p){var d=r.def(a.attributes,"[",p,"]"),y=t.cond(d,".buffer");y.then(u,".enableVertexAttribArray(",p,");",u,".bindBuffer(",Po,",",d,".buffer.buffer);",u,".vertexAttribPointer(",p,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(u,".disableVertexAttribArray(",p,");",u,".vertexAttrib4f(",p,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),r(y),l&&r(s,".vertexAttribDivisorANGLE(",p,",",d,".divisor);")}return Object.keys(oe).forEach(function(e){var o=oe[e],a=i.def(f,".",e),s=t.block();s("if(",a,"){",u,".enable(",o,")}else{",u,".disable(",o,")}",c,".",e,"=",a,";"),r(s),n("if(",a,"!==",c,".",e,"){",s,"}")}),Object.keys(ie).forEach(function(e){var o,a,s=ie[e],l=te[e],p=t.block();if(p(u,".",s,"("),K(l)){var d=l.length;o=t.global.def(f,".",e),a=t.global.def(c,".",e),p(k(d,function(e){return o+"["+e+"]"}),");",k(d,function(e){return a+"["+e+"]="+o+"["+e+"];"}).join("")),n("if(",k(d,function(e){return o+"["+e+"]!=="+a+"["+e+"]"}).join("||"),"){",p,"}")}else o=i.def(f,".",e),a=i.def(c,".",e),p(o,");",c,".",e,"=",o,";"),n("if(",o,"!==",a,"){",p,"}");r(p)}),t.compile()}()}}function Le(){return{bufferCount:0,vaoCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}function Pe(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var Te={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Re=function(e){return Object.prototype.toString.call(e)in Te},Ce=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},ke=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"],Ie=33071,De=9728,Ve=9984,Ge=9985,Ne=9986,Fe=9987,Be=5126,Ue=32819,Ye=32820,ze=33635,Xe=34042,qe={};qe[5120]=qe[5121]=1,qe[5122]=qe[5123]=qe[36193]=qe[ze]=qe[Ue]=qe[Ye]=2,qe[5124]=qe[5125]=qe[Be]=qe[Xe]=4;var He=Ce(n,{optional:function(e){e()},raise:t,commandRaise:h,command:function(e,t,n){e||h(t,n||s())},parameter:function(e,n,r){e in n||t("unknown parameter ("+e+")"+o(r)+". possible values: "+Object.keys(n).join())},commandParameter:function(e,t,n,r){e in t||h("unknown parameter ("+e+")"+o(n)+". possible values: "+Object.keys(t).join(),r||s())},constructor:function(e){Object.keys(e).forEach(function(e){ke.indexOf(e)<0&&t('invalid regl constructor argument "'+e+'". must be one of '+ke)})},type:function(e,n,i){(void 0===e?"undefined":r(e))!==n&&t("invalid parameter type"+o(i)+". expected "+n+", got "+(void 0===e?"undefined":r(e)))},commandType:b,isTypedArray:function(e,n){Re(e)||t("invalid parameter type"+o(n)+". must be a typed array")},nni:function(e,n){e>=0&&(0|e)===e||t("invalid parameter type, ("+e+")"+o(n)+". must be a nonnegative integer")},oneOf:i,shaderError:function(e,t,r,o,i){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var u=e.getShaderInfoLog(t),f=o===e.FRAGMENT_SHADER?"fragment":"vertex";b(r,"string",f+" shader source must be a string",i);var c=p(r,i),s=d(u);y(c,s),Object.keys(c).forEach(function(e){function t(e,t){r.push(e),o.push(t||"")}var n=c[e];if(n.hasErrors){var r=[""],o=[""];t("file number "+e+": "+n.name+"\n","color:red;text-decoration:underline;font-weight:bold"),n.lines.forEach(function(e){if(e.errors.length>0){t(a(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),t(e.line+"\n","color:red; background-color:yellow; font-weight:bold");var n=0;e.errors.forEach(function(r){var o=r.message,i=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(o);if(i){var u=i[1];switch(o=i[2],u){case"assign":u="="}n=Math.max(e.line.indexOf(u,n),0)}else n=0;t(a("| ",6)),t(a("^^^",n+3)+"\n","font-weight:bold"),t(a("| ",6)),t(o+"\n","font-weight:bold")}),t(a("| ",6)+"\n")}else t(a(e.number,4)+"|  "),t(e.line+"\n","color:red")}),"undefined"!=typeof document?(o[0]=r.join("%c"),console.log.apply(console,o)):console.log(r.join(""))}}),n.raise("Error compiling "+f+" shader, "+c[0].name)}},linkError:function(e,t,r,o,i){if(!e.getProgramParameter(t,e.LINK_STATUS)){var a=e.getProgramInfoLog(t),u=p(r,i),f='Error linking program with vertex shader, "'+p(o,i)[0].name+'", and fragment shader "'+u[0].name+'"';"undefined"!=typeof document?console.log("%c"+f+"\n%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(f+"\n"+a),n.raise(f)}},callSite:l,saveCommandRef:m,saveDrawInfo:function(e,t,n,r){function o(e){return e?r.id(e):0}function i(e,t){Object.keys(t).forEach(function(t){e[r.id(t)]=!0})}m(e),e._fragId=o(e.static.frag),e._vertId=o(e.static.vert);var a=e._uniformSet={};i(a,t.static),i(a,t.dynamic);var u=e._attributeSet={};i(u,n.static),i(u,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic},framebufferFormat:function(e,t,n){e.texture?i(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):i(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")},guessCommand:s,texture2D:function(e,t,r){var o,i=t.width,a=t.height,u=t.channels;n(i>0&&i<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),e.wrapS===Ie&&e.wrapT===Ie||n(g(i)&&g(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==i&&1!==a&&n(e.minFilter!==Ve&&e.minFilter!==Ne&&e.minFilter!==Ge&&e.minFilter!==Fe,"min filter requires mipmap"):(n(g(i)&&g(a),"texture must be a square power of 2 to support mipmapping"),n(t.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),t.type===Be&&(r.extensions.indexOf("oes_texture_float_linear")<0&&n(e.minFilter===De&&e.magFilter===De,"filter not supported, must enable oes_texture_float_linear"),n(!e.genMipmaps,"mipmap generation not supported with float textures"));var f=t.images;for(o=0;o<16;++o)if(f[o]){var c=i>>o,s=a>>o;n(t.mipmask&1<<o,"missing mipmap data");var l=f[o];if(n(l.width===c&&l.height===s,"invalid shape for mip images"),n(l.format===t.format&&l.internalformat===t.internalformat&&l.type===t.type,"incompatible type for mip image"),l.compressed);else if(l.data){var p=Math.ceil(v(l.type,u)*c/l.unpackAlignment)*l.unpackAlignment;n(l.data.byteLength===p*s,"invalid data for image, buffer size is inconsistent with image format")}else l.element||l.copy}else e.genMipmaps||n(0==(t.mipmask&1<<o),"extra mipmap data");t.compressed&&n(!e.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(e,t,r,o){var i=e.width,a=e.height,u=e.channels;n(i>0&&i<=o.maxTextureSize&&a>0&&a<=o.maxTextureSize,"invalid texture shape"),n(i===a,"cube map must be square"),n(t.wrapS===Ie&&t.wrapT===Ie,"wrap mode not supported by cube map");for(var f=0;f<r.length;++f){var c=r[f];n(c.width===i&&c.height===a,"inconsistent cube map face shape"),t.genMipmaps&&(n(!c.compressed,"can not generate mipmap for compressed textures"),n(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var s=c.images,l=0;l<16;++l){var p=s[l];if(p){var d=i>>l,y=a>>l;n(c.mipmask&1<<l,"missing mipmap data"),n(p.width===d&&p.height===y,"invalid shape for mip images"),n(p.format===e.format&&p.internalformat===e.internalformat&&p.type===e.type,"incompatible type for mip image"),p.compressed||(p.data?n(p.data.byteLength===d*y*Math.max(v(p.type,u),p.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):p.element||p.copy)}}}}}),We=0,Ke=0,$e={DynamicVariable:_,define:function(e,t){return new _(e,x(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof _},unbox:function(e,t){return"function"==typeof e?new _(Ke,e):e},accessor:x},Qe={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},Ze="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},Je=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,o=1;return t.webgl_draw_buffers&&(r=e.getParameter(34852),o=e.getParameter(36063)),{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:o,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938)}},et=function(e){return Object.keys(e).map(function(t){return e[t]})},tt=5120,nt=5121,rt=5122,ot=5123,it=5124,at=5125,ut=5126,ft=k(8,function(){return[]}),ct={alloc:V,free:G,allocType:function(e,t){var n=null;switch(e){case tt:n=new Int8Array(V(t),0,t);break;case nt:n=new Uint8Array(V(t),0,t);break;case rt:n=new Int16Array(V(2*t),0,t);break;case ot:n=new Uint16Array(V(2*t),0,t);break;case it:n=new Int32Array(V(4*t),0,t);break;case at:n=new Uint32Array(V(4*t),0,t);break;case ut:n=new Float32Array(V(4*t),0,t);break;default:return null}return n.length!==t?n.subarray(0,t):n},freeType:function(e){G(e.buffer)}},st={shape:function(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t},flatten:function(e,t,n,r){var o=1;if(t.length)for(var i=0;i<t.length;++i)o*=t[i];else o=0;var a=r||ct.allocType(n,o);switch(t.length){case 0:break;case 1:N(e,t[0],a);break;case 2:F(e,t[0],t[1],a);break;case 3:B(e,t[0],t[1],t[2],a,0);break;default:U(e,t,0,a,0)}return a}},lt={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},pt={dynamic:35048,stream:35040,static:35044},dt=st.flatten,yt=st.shape,mt=35044,ht=35040,bt=5121,vt=5126,gt=[];gt[5120]=1,gt[5122]=2,gt[5124]=4,gt[5121]=1,gt[5123]=2,gt[5125]=4,gt[5126]=4;var _t={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},wt=0,Ot=1,xt=4,St=5120,jt=5121,Et=5122,At=5123,Mt=5124,Lt=5125,Pt=34963,Tt=35040,Rt=35044,Ct=new Float32Array(1),kt=new Uint32Array(Ct.buffer),It=5123,Dt=34467,Vt=3553,Gt=34067,Nt=34069,Ft=6408,Bt=6406,Ut=6407,Yt=6409,zt=6410,Xt=32854,qt=32855,Ht=36194,Wt=32819,Kt=32820,$t=33635,Qt=34042,Zt=6402,Jt=34041,en=35904,tn=35906,nn=36193,rn=33776,on=33777,an=33778,un=33779,fn=35986,cn=35987,sn=34798,ln=35840,pn=35841,dn=35842,yn=35843,mn=36196,hn=5121,bn=5123,vn=5125,gn=5126,_n=10242,wn=10243,On=10497,xn=33071,Sn=33648,jn=10240,En=10241,An=9728,Mn=9729,Ln=9984,Pn=9985,Tn=9986,Rn=9987,Cn=33170,kn=4352,In=4353,Dn=4354,Vn=34046,Gn=3317,Nn=37440,Fn=37441,Bn=37443,Un=37444,Yn=33984,zn=[Ln,Tn,Pn,Rn],Xn=[0,Yt,zt,Ut,Ft],qn={};qn[Yt]=qn[Bt]=qn[Zt]=1,qn[Jt]=qn[zt]=2,qn[Ut]=qn[en]=3,qn[Ft]=qn[tn]=4;var Hn=$("HTMLCanvasElement"),Wn=$("CanvasRenderingContext2D"),Kn=$("HTMLImageElement"),$n=$("HTMLVideoElement"),Qn=Object.keys(Te).concat([Hn,Wn,Kn,$n]),Zn=[];Zn[hn]=1,Zn[gn]=4,Zn[nn]=2,Zn[bn]=2,Zn[vn]=4;var Jn=[];Jn[Xt]=2,Jn[qt]=2,Jn[Ht]=2,Jn[Jt]=4,Jn[rn]=.5,Jn[on]=.5,Jn[an]=1,Jn[un]=1,Jn[fn]=.5,Jn[cn]=1,Jn[sn]=1,Jn[ln]=.5,Jn[pn]=.25,Jn[dn]=.5,Jn[yn]=.25,Jn[mn]=.5;var er=36161,tr=32854,nr=[];nr[tr]=2,nr[32855]=2,nr[36194]=2,nr[33189]=2,nr[36168]=1,nr[34041]=4,nr[35907]=4,nr[34836]=16,nr[34842]=8,nr[34843]=6;var rr=function(e,t,n,o,i){function a(e){this.id=s++,this.refCount=1,this.renderbuffer=e,this.format=tr,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function u(t){var n=t.renderbuffer;He(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(er,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete l[t.id],o.renderbufferCount--}var f={rgba4:tr,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(f.srgba=35907),t.ext_color_buffer_half_float&&(f.rgba16f=34842,f.rgb16f=34843),t.webgl_color_buffer_float&&(f.rgba32f=34836);var c=[];Object.keys(f).forEach(function(e){var t=f[e];c[t]=e});var s=0,l={};return a.prototype.decRef=function(){--this.refCount<=0&&u(this)},i.profile&&(o.getTotalRenderbufferSize=function(){var e=0;return Object.keys(l).forEach(function(t){e+=l[t].stats.size}),e}),{create:function(t,u){function s(t,o){var a=0,u=0,l=tr;if("object"===(void 0===t?"undefined":r(t))&&t){var d=t;if("shape"in d){var y=d.shape;He(Array.isArray(y)&&y.length>=2,"invalid renderbuffer shape"),a=0|y[0],u=0|y[1]}else"radius"in d&&(a=u=0|d.radius),"width"in d&&(a=0|d.width),"height"in d&&(u=0|d.height);"format"in d&&(He.parameter(d.format,f,"invalid renderbuffer format"),l=f[d.format])}else"number"==typeof t?(a=0|t,u="number"==typeof o?0|o:a):t?He.raise("invalid arguments to renderbuffer constructor"):a=u=1;if(He(a>0&&u>0&&a<=n.maxRenderbufferSize&&u<=n.maxRenderbufferSize,"invalid renderbuffer size"),a!==p.width||u!==p.height||l!==p.format)return s.width=p.width=a,s.height=p.height=u,p.format=l,e.bindRenderbuffer(er,p.renderbuffer),e.renderbufferStorage(er,l,a,u),i.profile&&(p.stats.size=pe(p.format,p.width,p.height)),s.format=c[p.format],s}var p=new a(e.createRenderbuffer());return l[p.id]=p,o.renderbufferCount++,s(t,u),s.resize=function(t,r){var o=0|t,a=0|r||o;return o===p.width&&a===p.height?s:(He(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),s.width=p.width=o,s.height=p.height=a,e.bindRenderbuffer(er,p.renderbuffer),e.renderbufferStorage(er,p.format,o,a),i.profile&&(p.stats.size=pe(p.format,p.width,p.height)),s)},s._reglType="renderbuffer",s._renderbuffer=p,i.profile&&(s.stats=p.stats),s.destroy=function(){p.decRef()},s},clear:function(){et(l).forEach(u)},restore:function(){et(l).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(er,t.renderbuffer),e.renderbufferStorage(er,t.format,t.width,t.height)}),e.bindRenderbuffer(er,null)}}},or=36160,ir=36161,ar=3553,ur=34069,fr=36064,cr=36096,sr=36128,lr=33306,pr=36053,dr=6402,yr=[6408],mr=[];mr[6408]=4;var hr=[];hr[5121]=1,hr[5126]=4,hr[36193]=2;var br=33189,vr=36168,gr=34041,_r=[32854,32855,36194,35907,34842,34843,34836],wr={};wr[pr]="complete",wr[36054]="incomplete attachment",wr[36057]="incomplete dimensions",wr[36055]="incomplete, missing attachment",wr[36061]="unsupported";var Or=5126,xr=35632,Sr=35633,jr=35718,Er=35721,Ar=6408,Mr=5121,Lr=3333,Pr=5126,Tr="xyzw".split(""),Rr=5121,Cr=1,kr=2,Ir=0,Dr=1,Vr=2,Gr=3,Nr=4,Fr="dither",Br="blend.enable",Ur="blend.color",Yr="blend.equation",zr="blend.func",Xr="depth.enable",qr="depth.func",Hr="depth.range",Wr="depth.mask",Kr="colorMask",$r="cull.enable",Qr="cull.face",Zr="frontFace",Jr="lineWidth",eo="polygonOffset.enable",to="polygonOffset.offset",no="sample.alpha",ro="sample.enable",oo="sample.coverage",io="stencil.enable",ao="stencil.mask",uo="stencil.func",fo="stencil.opFront",co="stencil.opBack",so="scissor.enable",lo="scissor.box",po="viewport",yo="profile",mo="framebuffer",ho="vert",bo="frag",vo="elements",go="primitive",_o="count",wo="offset",Oo="instances",xo=mo+"Width",So=mo+"Height",jo=po+"Width",Eo=po+"Height",Ao="drawingBufferWidth",Mo="drawingBufferHeight",Lo=[zr,Yr,uo,fo,co,oo,po,lo,to],Po=34962,To=34963,Ro=3553,Co=34067,ko=2884,Io=3042,Do=3024,Vo=2960,Go=2929,No=3089,Fo=32823,Bo=32926,Uo=32928,Yo=5126,zo=35664,Xo=35665,qo=35666,Ho=5124,Wo=35667,Ko=35668,$o=35669,Qo=35670,Zo=35671,Jo=35672,ei=35673,ti=35674,ni=35675,ri=35676,oi=35678,ii=35680,ai=4,ui=1028,fi=1029,ci=2304,si=2305,li=32775,pi=32776,di=519,yi=7680,mi=0,hi=1,bi=32774,vi=513,gi=36160,_i=36064,wi={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Oi=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],xi={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Si={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ji={frag:35632,vert:35633},Ei={cw:ci,ccw:si},Ai=new Se(!1,!1,!1,function(){}),Mi=34918,Li=34919,Pi=35007,Ti=function(e,t){function n(){return c.pop()||f.createQueryEXT()}function r(e){c.push(e)}function o(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}function i(){return l.pop()||new o}function a(e){l.push(e)}function u(e,t,n){var r=i();r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,p.push(r)}var f=t.ext_disjoint_timer_query;if(!f)return null;var c=[],s=[],l=[],p=[],d=[],y=[];return{beginQuery:function(e){var t=n();f.beginQueryEXT(Pi,t),s.push(t),u(s.length-1,s.length,e)},endQuery:function(){f.endQueryEXT(Pi)},pushScopeStats:u,update:function(){var e,t,n=s.length;if(0!==n){y.length=Math.max(y.length,n+1),d.length=Math.max(d.length,n+1),d[0]=0,y[0]=0;var o=0;for(e=0,t=0;t<s.length;++t){var i=s[t];f.getQueryObjectEXT(i,Li)?(o+=f.getQueryObjectEXT(i,Mi),r(i)):s[e++]=i,d[t+1]=o,y[t+1]=e}for(s.length=e,e=0,t=0;t<p.length;++t){var u=p[t],c=u.startQueryIndex,l=u.endQueryIndex;u.sum+=d[l]-d[c];var m=y[c],h=y[l];h===m?(u.stats.gpuTime+=u.sum/1e6,a(u)):(u.startQueryIndex=m,u.endQueryIndex=h,p[e++]=u)}p.length=e}},getNumPendingQueries:function(){return s.length},clear:function(){c.push.apply(c,s);for(var e=0;e<c.length;e++)f.deleteQueryEXT(c[e]);s.length=0,c.length=0},restore:function(){s.length=0,c.length=0}}},Ri=16384,Ci=256,ki=1024,Ii=34962,Di="webglcontextlost",Vi="webglcontextrestored",Gi=1,Ni=2,Fi=3;return function(e){function t(){if(0===X.length)return O&&O.update(),void(Q=null);Q=Qe.next(t),l();for(var e=X.length-1;e>=0;--e){var n=X[e];n&&n(A,null,0)}m.flush(),O&&O.update()}function n(){!Q&&X.length>0&&(Q=Qe.next(t))}function o(){Q&&(Qe.cancel(t),Q=null)}function i(e){e.preventDefault(),b=!0,o(),W.forEach(function(e){e()})}function a(e){m.getError(),b=!1,v.restore(),V.restore(),k.restore(),G.restore(),N.restore(),F.restore(),O&&O.restore(),B.procs.refresh(),n(),K.forEach(function(e){e()})}function u(e){function t(e){var t={},n={};return Object.keys(e).forEach(function(r){var o=e[r];$e.isDynamic(o)?n[r]=$e.unbox(o,r):t[r]=o}),{dynamic:n,static:t}}function n(e){for(;p.length<e;)p.push(null);return p}He(!!e,"invalid args to regl({...})"),He.type(e,"object","invalid args to regl({...})");var r=t(e.context||{}),o=t(e.uniforms||{}),i=t(e.attributes||{}),a=t(function(e){function t(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}var n=Ce({},e);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),n}(e)),u={gpuTime:0,cpuTime:0,count:0},f=B.compile(a,i,o,r,u),c=f.draw,s=f.batch,l=f.scope,p=[];return Ce(function(e,t){var r;if(b&&He.raise("context lost"),"function"==typeof e)return l.call(this,null,e,0);if("function"==typeof t){if("number"==typeof e){for(r=0;r<e;++r)l.call(this,null,t,r);return}if(Array.isArray(e)){for(r=0;r<e.length;++r)l.call(this,e[r],t,r);return}return l.call(this,e,t,0)}if("number"==typeof e){if(e>0)return s.call(this,n(0|e),0|e)}else{if(!Array.isArray(e))return c.call(this,e);if(e.length)return s.call(this,e,e.length)}},{stats:u})}function f(e,t){var n=0;B.procs.poll();var r=t.color;r&&(m.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=Ri),"depth"in t&&(m.clearDepth(+t.depth),n|=Ci),"stencil"in t&&(m.clearStencil(0|t.stencil),n|=ki),He(!!n,"called regl.clear with no buffer specified"),m.clear(n)}function c(e){return He.type(e,"function","regl.frame() callback must be a function"),X.push(e),n(),{cancel:function(){function t(){var e=Pe(X,t);X[e]=X[X.length-1],X.length-=1,X.length<=0&&o()}var n=Pe(X,e);He(n>=0,"cannot cancel a frame twice"),X[n]=t}}}function s(){var e=Y.viewport,t=Y.scissor_box;e[0]=e[1]=t[0]=t[1]=0,A.viewportWidth=A.framebufferWidth=A.drawingBufferWidth=e[2]=t[2]=m.drawingBufferWidth,A.viewportHeight=A.framebufferHeight=A.drawingBufferHeight=e[3]=t[3]=m.drawingBufferHeight}function l(){A.tick+=1,A.time=d(),s(),B.procs.poll()}function p(){s(),B.procs.refresh(),O&&O.update()}function d(){return(Ze()-x)/1e3}var y=T(e);if(!y)return null;var m=y.gl,h=m.getContextAttributes(),b=m.isContextLost(),v=R(m,y);if(!v)return null;var g=S(),_=Le(),w=v.extensions,O=Ti(m,w),x=Ze(),j=m.drawingBufferWidth,E=m.drawingBufferHeight,A={tick:0,time:0,viewportWidth:j,viewportHeight:E,framebufferWidth:j,framebufferHeight:E,drawingBufferWidth:j,drawingBufferHeight:E,pixelRatio:y.pixelRatio},M={},L={elements:null,primitive:4,count:-1,offset:0,instances:-1},P=Je(m,w),C=ve(m,w,_,y),k=q(m,_,y),I=H(m,w,k,_),D=me(m,w,P,k,g),V=he(m,g,_,y),G=le(m,w,P,function(){B.procs.poll()},A,_,y),N=rr(m,w,P,_,y),F=de(m,w,P,G,N,_),B=Me(m,g,w,P,C,k,I,G,F,M,D,V,L,A,O,y),U=be(m,F,B.procs.poll,A,h,w),Y=B.next,z=m.canvas,X=[],W=[],K=[],$=[y.onDestroy],Q=null;z&&(z.addEventListener(Di,i,!1),z.addEventListener(Vi,a,!1));var Z=F.setFBO=u({framebuffer:$e.define.call(null,Gi,"framebuffer")});p();var J=Ce(u,{clear:function(e){if(He("object"===(void 0===e?"undefined":r(e))&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;t<6;++t)Z(Ce({framebuffer:e.framebuffer.faces[t]},e),f);else Z(e,f);else f(null,e)},prop:$e.define.bind(null,Gi),context:$e.define.bind(null,Ni),this:$e.define.bind(null,Fi),draw:u({}),buffer:function(e){return k.create(e,Ii,!1,!1)},elements:function(e){return I.create(e,!1)},texture:G.create2D,cube:G.createCube,renderbuffer:N.create,framebuffer:F.create,framebufferCube:F.createCube,attributes:h,frame:c,on:function(e,t){He.type(t,"function","listener callback must be a function");var n;switch(e){case"frame":return c(t);case"lost":n=W;break;case"restore":n=K;break;case"destroy":n=$;break;default:He.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}},limits:P,hasExtension:function(e){return P.extensions.indexOf(e.toLowerCase())>=0},read:U,destroy:function(){X.length=0,o(),z&&(z.removeEventListener(Di,i),z.removeEventListener(Vi,a)),V.clear(),F.clear(),N.clear(),G.clear(),I.clear(),k.clear(),C.clear(),O&&O.clear(),$.forEach(function(e){e()})},_gl:m,_refresh:p,poll:function(){l(),O&&O.update()},now:d,stats:_});return y.onDone(null,J),J}})},{}],298:[function(e,t,n){"use strict";function r(e,t){return e.ctrlKey==(t.ctrlKey||!1)&&e.altKey==(t.altKey||!1)&&e.shiftKey==(t.shiftKey||!1)&&e.metaKey==(t.metaKey||!1)&&e.keyCode==(t.keyCode||0)&&e.charCode==(t.charCode||0)||((e=document.createEvent("Event")).initEvent(t.type,t.bubbles,t.cancelable),e.ctrlKey=t.ctrlKey||!1,e.altKey=t.altKey||!1,e.shiftKey=t.shiftKey||!1,e.metaKey=t.metaKey||!1,e.keyCode=t.keyCode||0,e.charCode=t.charCode||0),e}var o=document||{},i=!0;try{o.createEvent("KeyEvents")}catch(e){i=!1}t.exports=o.createEvent?function(e,t){t=t||{};var n=f(e),u=n;"KeyboardEvent"===n&&i&&(n="KeyEvents",u="KeyEvent");var c=o.createEvent(n),s="init"+u,l="function"==typeof c[s]?s:"initEvent",p=a[l],d=[],y={};t.type=e;for(var m=0;m<p.length;++m){var h=t[b=p[m]];void 0===h&&(h=c[b]),y[b]=!0,d.push(h)}c[l].apply(c,d),"KeyboardEvent"===n&&(c=r(c,t));for(var b in t)y[b]||(c[b]=t[b]);return c}:function(e,t){t=t||{};var n=o.createEventObject();n.type=e;for(var r in t)void 0!==t[r]&&(n[r]=t[r]);return n};var a=e("./init.json"),u=e("./types.json"),f=function(){var e={};for(var t in u)for(var n=u[t],r=0;r<n.length;r++)e[n[r]]=t;return function(t){return e[t]||"Event"}}()},{"./init.json":299,"./types.json":300}],299:[function(e,t,n){t.exports={initEvent:["type","bubbles","cancelable"],initUIEvent:["type","bubbles","cancelable","view","detail"],initMouseEvent:["type","bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget"],initMutationEvent:["type","bubbles","cancelable","relatedNode","prevValue","newValue","attrName","attrChange"],initKeyboardEvent:["type","bubbles","cancelable","view","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode"],initKeyEvent:["type","bubbles","cancelable","view","ctrlKey","altKey","shiftKey","metaKey","keyCode","charCode"]}},{}],300:[function(e,t,n){t.exports={MouseEvent:["click","mousedown","mouseup","mouseover","mousemove","mouseout"],KeyboardEvent:["keydown","keyup","keypress"],MutationEvent:["DOMSubtreeModified","DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMAttrModified","DOMCharacterDataModified"],HTMLEvents:["load","unload","abort","error","select","change","submit","reset","focus","blur","resize","scroll"],UIEvent:["DOMFocusIn","DOMFocusOut","DOMActivate"]}},{}],301:[function(e,t,n){"use strict";t.exports=function(e,t,n){e.positions&&e.cells&&(n=t,t=e.cells,e=e.positions);var r=e.length?e[0].length:0,o=t.length?t[0].length:0;if(n=n||new Float32Array(t.length*o*r),3===o&&2===r)for(var i=0,a=0,u=t.length;i<u;i+=1)f=t[i],n[a++]=e[f[0]][0],n[a++]=e[f[0]][1],n[a++]=e[f[1]][0],n[a++]=e[f[1]][1],n[a++]=e[f[2]][0],n[a++]=e[f[2]][1];else if(3===o&&3===r)for(var i=0,a=0,u=t.length;i<u;i+=1)f=t[i],n[a++]=e[f[0]][0],n[a++]=e[f[0]][1],n[a++]=e[f[0]][2],n[a++]=e[f[1]][0],n[a++]=e[f[1]][1],n[a++]=e[f[1]][2],n[a++]=e[f[2]][0],n[a++]=e[f[2]][1],n[a++]=e[f[2]][2];else for(var i=0,a=0,u=t.length;i<u;i+=1)for(var f=t[i],c=0;c<f.length;c++)for(var s=f[c],l=0;l<r;l++)n[a++]=e[s][l];return n}},{}],302:[function(e,t,n){"use strict";t.exports=function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)r.call(n,o)&&(e[o]=n[o])}return e};var r=Object.prototype.hasOwnProperty},{}]},{},[58])(58)});
